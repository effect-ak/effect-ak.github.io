import{a as Qm}from"./client.BJwxA_Ca.js";var Bi={exports:{}},Mr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rl;function Zm(){if(rl)return Mr;rl=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,o){var i=null;if(o!==void 0&&(i=""+o),s.key!==void 0&&(i=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:e,type:r,key:i,ref:s!==void 0?s:null,props:o}}return Mr.Fragment=t,Mr.jsx=n,Mr.jsxs=n,Mr}var sl;function Xm(){return sl||(sl=1,Bi.exports=Zm()),Bi.exports}var GR=Xm();const ey=e=>typeof e=="function",l=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):n=>t(n,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(n,r){return arguments.length>=2?t(n,r):function(s){return t(s,n)}};case 3:return function(n,r,s){return arguments.length>=3?t(n,r,s):function(o){return t(o,n,r)}};case 4:return function(n,r,s,o){return arguments.length>=4?t(n,r,s,o):function(i){return t(i,n,r,s)}};case 5:return function(n,r,s,o,i){return arguments.length>=5?t(n,r,s,o,i):function(c){return t(c,n,r,s,o)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(r){return t(r,...n)}}}},z=e=>e,zo=e=>()=>e,ol=zo(!0),ao=zo(!1),eh=zo(void 0),ty=eh;function p(e,t,n,r,s,o,i,c,a){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return s(r(n(t(e))));case 6:return o(s(r(n(t(e)))));case 7:return i(o(s(r(n(t(e))))));case 8:return c(i(o(s(r(n(t(e)))))));case 9:return a(c(i(o(s(r(n(t(e))))))));default:{let u=arguments[0];for(let h=1;h<arguments.length;h++)u=arguments[h](u);return u}}}const ya=e=>(t,n)=>t===n||e(t,n),ny=l(2,(e,t)=>ya((n,r)=>e(t(n),t(r)))),ry=e=>ya((t,n)=>{if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0});let sy="3.16.8";const Wo=()=>sy,il=`effect/GlobalValue/globalStoreId/${Wo()}`;let Ar;const U=(e,t)=>(Ar||(globalThis[il]??=new Map,Ar=globalThis[il]),Ar.has(e)||Ar.set(e,t()),Ar.get(e)),Ke=e=>typeof e=="string",vt=e=>typeof e=="number",Jn=e=>typeof e=="boolean",Ho=e=>typeof e=="bigint",fc=e=>typeof e=="symbol",gr=ey,oy=e=>e===void 0,iy=e=>!1,_a=e=>typeof e=="object"&&e!==null,It=e=>_a(e)||gr(e),P=l(2,(e,t)=>It(e)&&t in e),th=l(2,(e,t)=>P(e,"_tag")&&e._tag===t),Tn=e=>e==null,cy=e=>e!=null,ay=e=>e instanceof Date,ba=e=>P(e,Symbol.iterator),uy=e=>_a(e)&&!Array.isArray(e),nh=e=>P(e,"then")&&gr(e.then),Go=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;let rh=class sh{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new sh(this.self)}};const ly=335903614,fy=4150755663,hy=1481765933,dy=1284865837,py=9007199254740992,gy=134217728;class my{_state;constructor(t,n,r,s){return Tn(n)&&Tn(t)?(n=Math.random()*4294967295>>>0,t=0):Tn(n)&&(n=t,t=0),Tn(s)&&Tn(r)?(s=this._state?this._state[3]:fy,r=this._state?this._state[2]:ly):Tn(s)&&(s=r,r=0),this._state=new Int32Array([0,0,r>>>0,((s||0)|1)>>>0]),this._next(),cl(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*gy+n)/py}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;yy(this._state,t,n,hy,dy),cl(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let r=t>>>18,s=(n>>>18|t<<14)>>>0;r=(r^t)>>>0,s=(s^n)>>>0;const o=(s>>>27|r<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(o>>>i|o<<c)>>>0}}function yy(e,t,n,r,s){let o=(n>>>16)*(s&65535)>>>0,i=(n&65535)*(s>>>16)>>>0,c=(n&65535)*(s&65535)>>>0,a=(n>>>16)*(s>>>16)+((i>>>16)+(o>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(a=a+1>>>0),o=o<<16>>>0,c=c+o>>>0,c>>>0<o>>>0&&(a=a+1>>>0),a=a+Math.imul(n,r)>>>0,a=a+Math.imul(t,s)>>>0,e[0]=a,e[1]=c}function cl(e,t,n,r,s){let o=t+r>>>0;const i=n+s>>>0;i>>>0<n>>>0&&(o=o+1|0),e[0]=o,e[1]=i}const hc=Symbol.for("effect/Utils/YieldWrap");class gs{#e;constructor(t){this.#e=t}[hc](){return this.#e}}function oh(e){if(typeof e=="object"&&e!==null&&hc in e)return e[hc]();throw new Error(Go("yieldWrapGet"))}const Ve=U("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),ih={effect_internal_function:e=>e()},_y={effect_internal_function:e=>{try{return e()}finally{}}},by=ih.effect_internal_function(()=>new Error().stack)?.includes("effect_internal_function")===!0,ve=by?ih.effect_internal_function:_y.effect_internal_function,Sy=function*(){}.constructor,wy=e=>It(e)&&e.constructor===Sy,Ki=U(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),B=Symbol.for("effect/Hash"),$=e=>{if(Ve.enabled===!0)return 0;switch(typeof e){case"number":return wa(e);case"bigint":return fe(e.toString(10));case"boolean":return fe(String(e));case"symbol":return fe(String(e));case"string":return fe(e);case"undefined":return fe("undefined");case"function":case"object":return e===null?fe("null"):e instanceof Date?$(e.toISOString()):e instanceof URL?$(e.href):ky(e)?e[B]():Sa(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},Sa=e=>(Ki.has(e)||Ki.set(e,wa(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),Ki.get(e)),q=e=>t=>t*53^e,Yo=e=>e&3221225471|e>>>1&1073741824,ky=e=>P(e,B),wa=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Yo(t)},fe=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return Yo(t)},Ty=(e,t)=>{let n=12289;for(let r=0;r<t.length;r++)n^=p(fe(t[r]),q($(e[t[r]])));return Yo(n)},ch=e=>Ty(e,Object.keys(e)),ms=e=>{let t=6151;for(let n=0;n<e.length;n++)t=p(t,q($(e[n])));return Yo(t)},oe=function(){if(arguments.length===1){const n=arguments[0];return function(r){return Object.defineProperty(n,B,{value(){return r},enumerable:!1}),r}}const e=arguments[0],t=arguments[1];return Object.defineProperty(e,B,{value(){return t},enumerable:!1}),t},C=Symbol.for("effect/Equal");function j(){return arguments.length===1?e=>uo(e,arguments[0]):uo(arguments[0],arguments[1])}function uo(e,t){if(e===t)return!0;const n=typeof e;if(n!==typeof t)return!1;if(n==="object"||n==="function"){if(e!==null&&t!==null){if(lo(e)&&lo(t))return $(e)===$(t)&&e[C](t)?!0:Ve.enabled&&Ve.tester?Ve.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(Ve.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((r,s)=>uo(r,t[s]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const r=Object.keys(e),s=Object.keys(t);if(r.length===s.length){for(const o of r)if(!(o in t&&uo(e[o],t[o])))return Ve.tester?Ve.tester(e,t):!1;return!0}}return Ve.tester?Ve.tester(e,t):!1}}return Ve.enabled&&Ve.tester?Ve.tester(e,t):!1}const lo=e=>P(e,C),ka=()=>j,re=Symbol.for("nodejs.util.inspect.custom"),he=e=>{try{if(P(e,"toJSON")&&gr(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(he)}catch{return{}}return es(e)},we=e=>JSON.stringify(e,null,2),Vn=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?ah(e,t):String(e)}catch{return String(e)}},ah=(e,t)=>{let n=[];const r=JSON.stringify(e,(s,o)=>typeof o=="object"&&o!==null?n.includes(o)?void 0:n.push(o)&&(Qt.fiberRefs!==void 0&&uh(o)?o[Ta](Qt.fiberRefs):o):o,t);return n=void 0,r},Ta=Symbol.for("effect/Inspectable/Redactable"),uh=e=>typeof e=="object"&&e!==null&&Ta in e,Qt=U("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),Oy=(e,t)=>{const n=Qt.fiberRefs;Qt.fiberRefs=e;try{return t()}finally{Qt.fiberRefs=n}},es=e=>uh(e)&&Qt.fiberRefs!==void 0?e[Ta](Qt.fiberRefs):e,M=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let n=e;for(let r=0,s=t.length;r<s;r++)n=t[r](n);return n}}},Vr="Async",Qo="Commit",Re="Failure",qi="OnFailure",fo="OnSuccess",ho="OnSuccessAndFailure",Fe="Success",lh="Sync",Ey="Tag",mr="UpdateRuntimeFlags",po="While",zr="Iterator",fh="WithRuntime",Gs="Yield",Oa="RevertFlags",vy=Symbol.for("effect/Effect"),$y=Symbol.for("effect/Stream"),Iy=Symbol.for("effect/Sink"),Ry=Symbol.for("effect/Channel"),zn={_R:e=>e,_E:e=>e,_A:e=>e,_V:Wo()},Fy={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},My={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},ys={[vy]:zn,[$y]:zn,[Iy]:Fy,[Ry]:My,[C](e){return this===e},[B](){return oe(this,Sa(this))},[Symbol.iterator](){return new rh(new gs(this))},pipe(){return M(this,arguments)}},Ea={[B](){return oe(this,ch(this))},[C](e){const t=Object.keys(this),n=Object.keys(e);if(t.length!==n.length)return!1;for(const r of t)if(!(r in e&&j(this[r],e[r])))return!1;return!0}},yr={...ys,_op:Qo},Ay={...yr,...Ea},Ny=function(){function e(){}return e.prototype=yr,e}(),hh=Symbol.for("effect/Option"),dh={...ys,[hh]:{_A:e=>e},[re](){return this.toJSON()},toString(){return we(this.toJSON())}},Py=Object.assign(Object.create(dh),{_tag:"Some",_op:"Some",[C](e){return ph(e)&&mh(e)&&j(this.value,e.value)},[B](){return oe(this,q($(this._tag))($(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:he(this.value)}}}),Ly=$("None"),xy=Object.assign(Object.create(dh),{_tag:"None",_op:"None",[C](e){return ph(e)&&gh(e)},[B](){return Ly},toJSON(){return{_id:"Option",_tag:this._tag}}}),ph=e=>P(e,hh),gh=e=>e._tag==="None",mh=e=>e._tag==="Some",yh=Object.create(xy),dc=e=>{const t=Object.create(Py);return t.value=e,t},_h=Symbol.for("effect/Either"),bh={...ys,[_h]:{_R:e=>e},[re](){return this.toJSON()},toString(){return we(this.toJSON())}},jy=Object.assign(Object.create(bh),{_tag:"Right",_op:"Right",[C](e){return va(e)&&wh(e)&&j(this.right,e.right)},[B](){return q($(this._tag))($(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:he(this.right)}}}),Uy=Object.assign(Object.create(bh),{_tag:"Left",_op:"Left",[C](e){return va(e)&&Sh(e)&&j(this.left,e.left)},[B](){return q($(this._tag))($(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:he(this.left)}}}),va=e=>P(e,_h),Sh=e=>e._tag==="Left",wh=e=>e._tag==="Right",Dy=e=>{const t=Object.create(Uy);return t.left=e,t},Cy=e=>{const t=Object.create(jy);return t.right=e,t},K=Cy,L=Dy,By=e=>{if(gr(e))try{return K(e())}catch(t){return L(t)}else try{return K(e.try())}catch(t){return L(e.catch(t))}},Ky=va,Ee=Sh,ut=wh,kh=l(2,(e,t)=>Ee(e)?L(t(e.left)):K(e.right)),qy=l(2,(e,t)=>ut(e)?K(t(e.right)):L(e.left)),$a=l(2,(e,{onLeft:t,onRight:n})=>Ee(e)?t(e.left):n(e.right)),Jy=$a({onLeft:z,onRight:z}),Th=l(2,(e,t)=>{if(ut(e))return e.right;throw t(e.left)}),Vy=Th(()=>new Error("getOrThrow called on a Left")),Oh=e=>e.length>0,Eh=e=>(t,n)=>t===n?0:e(t,n),zy=Eh((e,t)=>e<t?-1:1),vh=l(2,(e,t)=>Eh((n,r)=>e(t(n),t(r)))),Wy=e=>l(2,(t,n)=>e(t,n)===1),I=()=>yh,A=dc,Se=gh,$e=mh,qe=l(2,(e,{onNone:t,onSome:n})=>Se(e)?t():n(e.value)),ae=l(2,(e,t)=>Se(e)?t():e.value),Lt=l(2,(e,t)=>Se(e)?t():e),Hy=l(2,(e,t)=>Se(e)?A(t()):e),_s=e=>e==null?I():A(e),it=ae(eh),Gy=e=>(...t)=>{try{return A(e(...t))}catch{return I()}},Wr=l(2,(e,t)=>Se(e)?I():A(t(e.value))),bs=l(2,(e,t)=>Se(e)?I():t(e.value)),Yy=l(2,(e,t)=>Se(e)?I():_s(t(e.value))),Qy=e=>l(2,(t,n)=>Se(t)?!1:e(t.value,n)),Zy=ka(),Xy=Qy(Zy),e_=l(2,(e,t)=>Se(e)?!1:t(e.value)),t_=(...e)=>e,Zo=e=>new Array(e),n_=l(2,(e,t)=>{const n=Math.max(1,Math.floor(e)),r=new Array(n);for(let s=0;s<n;s++)r[s]=t(s);return r}),se=e=>Array.isArray(e)?e:Array.from(e),Ia=e=>Array.isArray(e)?e:[e],r_=l(2,(e,{onEmpty:t,onNonEmpty:n})=>ne(e)?n(e):t()),s_=l(2,(e,{onEmpty:t,onNonEmpty:n})=>ne(e)?n(Ne(e),en(e)):t()),go=l(2,(e,t)=>[t,...e]),o_=l(2,(e,t)=>[...e,t]),$h=l(2,(e,t)=>se(e).concat(se(t))),i_=Array.isArray,c_=e=>e.length===0,a_=c_,Ys=Oh,ne=Oh,Ih=(e,t)=>e<0||e>=t.length,u_=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),l_=l(2,(e,t)=>{const n=Math.floor(t);return Ih(n,e)?I():A(e[n])}),Rh=l(2,(e,t)=>{const n=Math.floor(t);if(Ih(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),Hr=l_(0),Ne=Rh(0),f_=e=>ne(e)?A(Fh(e)):I(),Fh=e=>e[e.length-1],en=e=>e.slice(1),h_=(e,t)=>{let n=0;for(const r of e){if(!t(r,n))break;n++}return n},d_=l(2,(e,t)=>y_(e,h_(e,t))),p_=l(2,(e,t)=>{const n=se(e);return n.slice(u_(t,n),n.length)}),al=e=>Array.from(e).reverse(),ts=l(2,(e,t)=>{const n=Array.from(e);return n.sort(t),n}),YR=l(3,(e,t,n)=>Array.from(e).map(r=>[r,t(r)]).sort(([,r],[,s])=>n(r,s)).map(([r])=>r)),ul=l(2,(e,t)=>g_(e,t,t_)),g_=l(3,(e,t,n)=>{const r=se(e),s=se(t);if(ne(r)&&ne(s)){const o=[n(Ne(r),Ne(s))],i=Math.min(r.length,s.length);for(let c=1;c<i;c++)o[c]=n(r[c],s[c]);return o}return[]}),m_=ka(),y_=l(2,(e,t)=>{const n=Array.from(e),r=Math.floor(t);return ne(n)?r>=1?__(n,r):[[],n]:[n,[]]}),__=l(2,(e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[Br(e),[]]:[go(e.slice(1,n),Ne(e)),e.slice(n)]}),Br=e=>e.slice(),QR=l(2,(e,t)=>{const n={};for(const r of e){const s=t(r);Object.prototype.hasOwnProperty.call(n,s)?n[s].push(r):n[s]=[r]}return n}),b_=l(3,(e,t,n)=>{const r=se(e),s=se(t);return ne(r)?ne(s)?Ah(n)($h(r,s)):r:s}),Qs=l(2,(e,t)=>b_(e,t,m_)),tn=()=>[],Ze=e=>[e],xn=l(2,(e,t)=>e.map(t)),mo=l(2,(e,t)=>{if(a_(e))return[];const n=[];for(let r=0;r<e.length;r++){const s=t(e[r],r);for(let o=0;o<s.length;o++)n.push(s[o])}return n}),S_=mo(z),w_=l(2,(e,t)=>{const n=se(e),r=[];for(let s=0;s<n.length;s++){const o=t(n[s],s);$e(o)&&r.push(o.value)}return r}),k_=l(2,(e,t)=>{const n=se(e),r=[];for(let s=0;s<n.length;s++)t(n[s],s)&&r.push(n[s]);return r}),Mh=l(3,(e,t,n)=>se(e).reduce((r,s,o)=>n(r,s,o),t)),ll=(e,t)=>{const n=[];let r=e,s;for(;$e(s=t(r));){const[o,i]=s.value;n.push(o),r=i}return n},Ra=ry,Ah=l(2,(e,t)=>{const n=se(e);if(ne(n)){const r=[Ne(n)],s=en(n);for(const o of s)r.every(i=>!t(o,i))&&r.push(o);return r}return[]}),T_=e=>Ah(e,ka()),_r=l(2,(e,t)=>se(e).join(t)),Nh=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return Nh(e,t.from)}},wt=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Ph=e=>{let t=!1,n;return()=>(t||(n=e(),t=!0),n)},O_=e=>{try{return e.toISOString()}catch{return String(e)}},tt=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(n=>tt(n,t)).join(",")}]`;if(ay(e))return O_(e);if(P(e,"toString")&&gr(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();if(Ke(e))return JSON.stringify(e);if(vt(e)||e==null||Jn(e)||fc(e))return String(e);if(Ho(e))return String(e)+"n";if(ba(e))return`${e.constructor.name}(${tt(Array.from(e),t)})`;try{t&&JSON.stringify(e);const n=`{${wt(e).map(s=>`${Ke(s)?JSON.stringify(s):String(s)}:${tt(e[s],!1)}`).join(",")}}`,r=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${r}(${n})`:n}catch{return"<circular structure>"}},Lh=e=>typeof e=="string"?JSON.stringify(e):String(e),xh=e=>Array.isArray(e),E_=e=>!Array.isArray(e),fl=e=>`[${Lh(e)}]`,jh=e=>xh(e)?e.map(fl).join(""):fl(e),Rt=(e,t,n,r)=>{let s=e;return n&&ne(n)&&(s+=`
at path: ${jh(n)}`),t!==void 0&&(s+=`
details: ${t}`),r&&(s+=`
schema (${r._tag}): ${r}`),s},v_=(e,t,n)=>Rt("Unsupported schema",e,t,n),Uh=(e,t,n)=>Rt("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,n),hl=e=>v_(void 0,void 0,e),$_=e=>Rt("Unsupported key schema",void 0,void 0,e),I_=e=>Rt("Unsupported literal",`literal value: ${tt(e)}`),dl=e=>Rt("Duplicate index signature",`${e} index signature`),R_=Rt("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),F_=Rt("Invalid element","A required element cannot follow an optional element. ts(1257)"),pl=e=>Rt("Duplicate property signature transformation",`Duplicate key ${tt(e)}`),Dh=e=>Rt("Duplicate property signature",`Duplicate key ${tt(e)}`),M_=Symbol.for("effect/SchemaId/MinLength"),Wn=zy,yo=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),A_=Symbol.for("effect/annotation/Brand"),N_=Symbol.for("effect/annotation/SchemaId"),Ch=Symbol.for("effect/annotation/Message"),Fa=Symbol.for("effect/annotation/MissingMessage"),Ma=Symbol.for("effect/annotation/Identifier"),Ft=Symbol.for("effect/annotation/Title"),jn=Symbol.for("effect/annotation/AutoTitle"),Ss=Symbol.for("effect/annotation/Description"),Bh=Symbol.for("effect/annotation/Examples"),Kh=Symbol.for("effect/annotation/Default"),qh=Symbol.for("effect/annotation/JSONSchema"),Jh=Symbol.for("effect/annotation/Arbitrary"),Vh=Symbol.for("effect/annotation/Pretty"),zh=Symbol.for("effect/annotation/Equivalence"),P_=Symbol.for("effect/annotation/Documentation"),Wh=Symbol.for("effect/annotation/Concurrency"),Hh=Symbol.for("effect/annotation/Batching"),Gh=Symbol.for("effect/annotation/ParseIssueTitle"),Yh=Symbol.for("effect/annotation/ParseOptions"),Qh=Symbol.for("effect/annotation/DecodingFallback"),_o=Symbol.for("effect/annotation/Surrogate"),L_=Symbol.for("effect/annotation/StableFilter"),Pe=l(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?A(e.annotations[t]):I()),x_=Pe(A_),j_=Pe(Ch),U_=Pe(Fa),Zh=Pe(Ft),Xh=Pe(jn),Xo=Pe(Ma),ed=Pe(Ss),D_=Pe(Wh),C_=Pe(Hh),B_=Pe(Gh),K_=Pe(Yh),q_=Pe(Qh),td=Pe(_o),J_=Pe(L_),V_=e=>e_(J_(e),t=>t===!0),Aa=Symbol.for("effect/annotation/JSONIdentifier"),z_=Pe(Aa),W_=e=>Lt(z_(e),()=>Xo(e)),H_=Symbol.for("effect/schema/ParseJson");class ei{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(t,n,r,s={}){this.typeParameters=t,this.decodeUnknown=n,this.encodeUnknown=r,this.annotations=s}toString(){return ae(lt(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:me(this.annotations)}}}const Mt=e=>t=>t._tag===e;let pc=class{literal;annotations;_tag="Literal";constructor(t,n={}){this.literal=t,this.annotations=n}toString(){return ae(lt(this),()=>tt(this.literal))}toJSON(){return{_tag:this._tag,literal:Ho(this.literal)?String(this.literal):this.literal,annotations:me(this.annotations)}}};const Gr=Mt("Literal");class G_{symbol;annotations;_tag="UniqueSymbol";constructor(t,n={}){this.symbol=t,this.annotations=n}toString(){return ae(lt(this),()=>tt(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:me(this.annotations)}}}class Y_{annotations;_tag="UndefinedKeyword";constructor(t={}){this.annotations=t}toString(){return pn(this)}toJSON(){return{_tag:this._tag,annotations:me(this.annotations)}}}const ns=new Y_({[Ft]:"undefined"});class Q_{annotations;_tag="NeverKeyword";constructor(t={}){this.annotations=t}toString(){return pn(this)}toJSON(){return{_tag:this._tag,annotations:me(this.annotations)}}}const Na=new Q_({[Ft]:"never"});class Z_{annotations;_tag="UnknownKeyword";constructor(t={}){this.annotations=t}toString(){return pn(this)}toJSON(){return{_tag:this._tag,annotations:me(this.annotations)}}}const nd=new Z_({[Ft]:"unknown"});class X_{annotations;_tag="AnyKeyword";constructor(t={}){this.annotations=t}toString(){return pn(this)}toJSON(){return{_tag:this._tag,annotations:me(this.annotations)}}}const eb=new X_({[Ft]:"any"});class tb{annotations;_tag="StringKeyword";constructor(t={}){this.annotations=t}toString(){return pn(this)}toJSON(){return{_tag:this._tag,annotations:me(this.annotations)}}}const gc=new tb({[Ft]:"string",[Ss]:"a string"}),mc=Mt("StringKeyword");class nb{annotations;_tag="NumberKeyword";constructor(t={}){this.annotations=t}toString(){return pn(this)}toJSON(){return{_tag:this._tag,annotations:me(this.annotations)}}}const yc=new nb({[Ft]:"number",[Ss]:"a number"}),gl=Mt("NumberKeyword");class rb{annotations;_tag="BooleanKeyword";constructor(t={}){this.annotations=t}toString(){return pn(this)}toJSON(){return{_tag:this._tag,annotations:me(this.annotations)}}}const ml=new rb({[Ft]:"boolean",[Ss]:"a boolean"}),yl=Mt("BooleanKeyword"),sb=Mt("SymbolKeyword");let ws=class{type;annotations;constructor(t,n={}){this.type=t,this.annotations=n}toJSON(){return{type:this.type.toJSON(),annotations:me(this.annotations)}}toString(){return String(this.type)}};class dn extends ws{isOptional;constructor(t,n,r={}){super(t,r),this.isOptional=n}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:me(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const Pa=e=>e.map(t=>t.type);class ti{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(t,n,r,s={}){this.elements=t,this.rest=n,this.isReadonly=r,this.annotations=s;let o=!1,i=!1;for(const c of t)if(c.isOptional)o=!0;else if(o){i=!0;break}if(i||o&&n.length>1)throw new Error(F_)}toString(){return ae(lt(this),()=>ob(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:me(this.annotations)}}}const ob=e=>{const t=e.elements.map(String).join(", ");return s_(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const s=String(n),o=s.includes(" | ")?`(${s})`:s;if(r.length>0){const i=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${o}[], ${i}]`:`readonly [...${o}[], ${i}]`}else return e.elements.length>0?`readonly [${t}, ...${o}[]]`:`ReadonlyArray<${s}>`}})};class be extends dn{name;isReadonly;constructor(t,n,r,s,o){super(n,r,o),this.name=t,this.isReadonly=s}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:me(this.annotations)}}}const rd=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return rd(e.from)}return!1};class ks{type;isReadonly;parameter;constructor(t,n,r){if(this.type=n,this.isReadonly=r,rd(t))this.parameter=t;else throw new Error(R_)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class kt{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(t,n,r={}){this.annotations=r;const s={};for(let i=0;i<t.length;i++){const c=t[i].name;if(Object.prototype.hasOwnProperty.call(s,c))throw new Error(Dh(c));s[c]=null}const o={string:!1,symbol:!1};for(let i=0;i<n.length;i++){const c=ld(n[i].parameter);if(mc(c)){if(o.string)throw new Error(dl("string"));o.string=!0}else if(sb(c)){if(o.symbol)throw new Error(dl("symbol"));o.symbol=!0}}this.propertySignatures=t,this.indexSignatures=n}toString(){return ae(lt(this),()=>ib(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:me(this.annotations)}}}const _l=e=>e.map(String).join("; "),ib=e=>{if(e.propertySignatures.length>0){const t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${_l(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${_l(e.indexSignatures)} }`:"{}"},bl=Mt("TypeLiteral"),cb=ts(vh(Wn,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),ab={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},sd=e=>mo(e,t=>xa(t)?sd(t.types):[t]),ub=e=>{const t=cb(e),n=[],r={},s=[];for(const o of t)switch(o._tag){case"NeverKeyword":break;case"AnyKeyword":return[eb];case"UnknownKeyword":return[nd];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{r[o._tag]||(r[o._tag]=o,n.push(o));break}case"Literal":{const i=typeof o.literal;switch(i){case"string":case"number":case"bigint":case"boolean":{const c=ab[i];!r[c]&&!s.includes(o.literal)&&(s.push(o.literal),n.push(o));break}case"object":{s.includes(o.literal)||(s.push(o.literal),n.push(o));break}}break}case"UniqueSymbol":{!r.SymbolKeyword&&!s.includes(o.symbol)&&(s.push(o.symbol),n.push(o));break}case"TupleType":{r.ObjectKeyword||n.push(o);break}case"TypeLiteral":{o.propertySignatures.length===0&&o.indexSignatures.length===0?r["{}"]||(r["{}"]=o,n.push(o)):r.ObjectKeyword||n.push(o);break}default:n.push(o)}return n};let xe=class _c{types;annotations;static make=(t,n)=>La(t)?new _c(t,n):t.length===1?t[0]:Na;static unify=(t,n)=>_c.make(ub(sd(t)),n);_tag="Union";constructor(t,n={}){this.types=t,this.annotations=n}toString(){return ae(lt(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:me(this.annotations)}}};const lb=(e,t)=>e.map(t),La=e=>e.length>1,xa=Mt("Union"),Ji=U(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class rs{f;annotations;_tag="Suspend";constructor(t,n={}){this.f=t,this.annotations=n,this.f=Ph(t)}toString(){return lt(this).pipe(Lt(()=>bs(Gy(this.f)(),t=>lt(t))),ae(()=>"<suspended schema>"))}toJSON(){const t=this.f();let n=Ji.get(t);return n||(Ji.set(t,{_tag:this._tag}),n={_tag:this._tag,ast:t.toJSON(),annotations:me(this.annotations)},Ji.set(t,n),n)}}let ja=class{from;filter;annotations;_tag="Refinement";constructor(t,n,r={}){this.from=t,this.filter=n,this.annotations=r}toString(){return Xo(this).pipe(ae(()=>qe(fd(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>Un(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:me(this.annotations)}}};const Un=Mt("Refinement"),Vi={};let Nt=class{from;to;transformation;annotations;_tag="Transformation";constructor(t,n,r,s={}){this.from=t,this.to=n,this.transformation=r,this.annotations=s}toString(){return ae(lt(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:me(this.annotations)}}};const fb=Mt("Transformation");class od{decode;encode;_tag="FinalTransformation";constructor(t,n){this.decode=t,this.encode=n}}const hb=e=>t=>t._tag===e;class db{_tag="ComposeTransformation"}const id=new db;let pb=class{from;to;decode;encode;constructor(t,n,r,s){this.from=t,this.to=n,this.decode=r,this.encode=s}};const gb=e=>e.decode===z&&e.encode===z;class bc{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(t){this.propertySignatureTransformations=t;const n={},r={};for(const s of t){const o=s.from;if(n[o])throw new Error(pl(o));n[o]=!0;const i=s.to;if(r[i])throw new Error(pl(i));r[i]=!0}}}const Sc=hb("TypeLiteralTransformation"),Hn=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={...e.annotations,...t},s=td(e);return $e(s)&&(r[_o]=Hn(s.value,t)),n.annotations.value=r,Object.create(Object.getPrototypeOf(e),n)},mb="[\\s\\S]*",yb="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",cd=(e,t)=>{switch(e._tag){case"Literal":return yo(String(e.literal));case"StringKeyword":return mb;case"NumberKeyword":return yb;case"TemplateLiteral":return ad(e);case"Union":return e.types.map(n=>cd(n)).join("|")}},_b=(e,t,n,r)=>xa(e)?`(${t})`:t,ad=(e,t,n)=>{let r="";if(e.head!==""){const s=yo(e.head);r+=s}for(const s of e.spans){const o=cd(s.type);if(r+=_b(s.type,o),s.literal!==""){const i=yo(s.literal);r+=i}}return r},bb=e=>new RegExp(`^${ad(e)}$`),Sl=(e,t)=>{const n=[],r=[],s=o=>{switch(o._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new ks(o,t,!0));break;case"Literal":if(Ke(o.literal)||vt(o.literal))n.push(new be(o.literal,t,!1,!0));else throw new Error(I_(o.literal));break;case"Enums":{for(const[i,c]of o.enums)n.push(new be(c,t,!1,!0));break}case"UniqueSymbol":n.push(new be(o.symbol,t,!1,!0));break;case"Union":o.types.forEach(s);break;default:throw new Error($_(o))}};return s(e),{propertySignatures:n,indexSignatures:r}},zi=e=>xe.make([e,ns]),Kr=(e,t)=>{switch(e._tag){case"TupleType":return new ti(e.elements.map(n=>new dn(zi(n.type),!0)),r_(e.rest,{onEmpty:()=>e.rest,onNonEmpty:n=>[new ws(xe.make([...Pa(n),ns]))]}),e.isReadonly);case"TypeLiteral":return new kt(e.propertySignatures.map(n=>new be(n.name,zi(n.type),!0,n.isReadonly,n.annotations)),e.indexSignatures.map(n=>new ks(n.parameter,zi(n.type),n.isReadonly)));case"Union":return xe.make(e.types.map(n=>Kr(n)));case"Suspend":return new rs(()=>Kr(e.f()));case"Declaration":case"Refinement":throw new Error(hl(e));case"Transformation":{if(Sc(e.transformation)&&e.transformation.propertySignatureTransformations.every(gb))return new Nt(Kr(e.from),Kr(e.to),e.transformation);throw new Error(hl(e))}}return e},ud=e=>t=>{let n;for(const r of e)Object.prototype.hasOwnProperty.call(t.annotations,r)&&(n===void 0&&(n={}),n[r]=t.annotations[r]);return n},Sb=e=>t=>{const n={...t.annotations};for(const r of e)delete n[r];return n},wb=ud([Bh,Kh,qh,Jh,Vh,zh]),ce=e=>{switch(e._tag){case"Declaration":{const t=He(e.typeParameters,ce);return t===e.typeParameters?e:new ei(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=He(e.elements,s=>{const o=ce(s.type);return o===s.type?s:new dn(o,s.isOptional)}),n=Pa(e.rest),r=He(n,ce);return t===e.elements&&r===n?e:new ti(t,r.map(s=>new ws(s)),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=He(e.propertySignatures,r=>{const s=ce(r.type);return s===r.type?r:new be(r.name,s,r.isOptional,r.isReadonly)}),n=He(e.indexSignatures,r=>{const s=ce(r.type);return s===r.type?r:new ks(r.parameter,s,r.isReadonly)});return t===e.propertySignatures&&n===e.indexSignatures?e:new kt(t,n,e.annotations)}case"Union":{const t=He(e.types,ce);return t===e.types?e:xe.make(t,e.annotations)}case"Suspend":return new rs(()=>ce(e.f()),e.annotations);case"Refinement":{const t=ce(e.from);return t===e.from?e:new ja(t,e.filter,e.annotations)}case"Transformation":{const t=wb(e);return ce(t!==void 0?Hn(e.to,t):e.to)}}return e},On=e=>qe(W_(e),{onNone:()=>{},onSome:t=>({[Aa]:t})});function He(e,t){let n=!1;const r=Zo(e.length);for(let s=0;s<e.length;s++){const o=e[s],i=t(o);i!==o&&(n=!0),r[s]=i}return n?r:e}const st=(e,t)=>{switch(e._tag){case"Declaration":{const n=He(e.typeParameters,r=>st(r));return n===e.typeParameters?e:new ei(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=He(e.elements,o=>{const i=st(o.type);return i===o.type?o:new dn(i,o.isOptional)}),r=Pa(e.rest),s=He(r,o=>st(o));return n===e.elements&&s===r?e:new ti(n,s.map(o=>new ws(o)),e.isReadonly,On(e))}case"TypeLiteral":{const n=He(e.propertySignatures,s=>{const o=st(s.type);return o===s.type?s:new be(s.name,o,s.isOptional,s.isReadonly)}),r=He(e.indexSignatures,s=>{const o=st(s.type);return o===s.type?s:new ks(s.parameter,o,s.isReadonly)});return n===e.propertySignatures&&r===e.indexSignatures?e:new kt(n,r,On(e))}case"Union":{const n=He(e.types,r=>st(r));return n===e.types?e:xe.make(n,On(e))}case"Suspend":return new rs(()=>st(e.f()),On(e));case"Refinement":{const n=st(e.from),r=On(e);return r?Hn(n,r):n}case"Transformation":{const n=On(e);return st(n?Hn(e.from,n):e.from)}}return e},wc=e=>st(e),me=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},ld=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return ld(e.from)}},kb=(e,t)=>new Nt(e,t,id),pn=e=>ae(lt(e),()=>e._tag);function Tb(e){return qe(x_(e),{onNone:()=>"",onSome:t=>t.map(n=>` & Brand<${tt(n)}>`).join("")})}const fd=e=>Zh(e).pipe(Lt(()=>ed(e)),Lt(()=>Xh(e)),Wr(t=>t+Tb(e))),lt=e=>Lt(Xo(e),()=>fd(e)),hd=Symbol.for("effect/Context/Tag"),bo=Symbol.for("effect/Context/Reference"),Ob="effect/STM",Eb=Symbol.for(Ob),ni={...ys,_op:"Tag",[Eb]:zn,[hd]:{_Service:e=>e,_Identifier:e=>e},toString(){return we(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[re](){return this.toJSON()},of(e){return e},context(e){return pd(this,e)}},vb={...ni,[bo]:bo},$b=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const r=Object.create(ni);return Object.defineProperty(r,"stack",{get(){return n.stack}}),r.key=e,r},Ib=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;function r(){}return Object.setPrototypeOf(r,ni),r.key=e,Object.defineProperty(r,"stack",{get(){return n.stack}}),r},Rb=()=>(e,t)=>{const n=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=new Error;Error.stackTraceLimit=n;function s(){}return Object.setPrototypeOf(s,vb),s.key=e,s.defaultValue=t.defaultValue,Object.defineProperty(s,"stack",{get(){return r.stack}}),s},dd=Symbol.for("effect/Context"),Fb={[dd]:{_Services:e=>e},[C](e){if(Ab(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!j(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[B](){return oe(this,wa(this.unsafeMap.size))},pipe(){return M(this,arguments)},toString(){return we(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(he)}},[re](){return this.toJSON()}},Gn=e=>{const t=Object.create(Fb);return t.unsafeMap=e,t},Mb=e=>{const t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){const n=e.stack.split(`
`);if(n.length>2){const r=n[2].match(/at (.*)/);r&&(t.message=t.message+` (defined at ${r[1]})`)}}if(t.stack){const n=t.stack.split(`
`);n.splice(1,3),t.stack=n.join(`
`)}return t},Ab=e=>P(e,dd),Nb=e=>P(e,hd),Pb=e=>P(e,bo),Lb=Gn(new Map),xb=()=>Lb,pd=(e,t)=>Gn(new Map([[e.key,t]])),jb=l(3,(e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t.key,n),Gn(r)}),Wi=U("effect/Context/defaultValueCache",()=>new Map),Ua=e=>{if(Wi.has(e.key))return Wi.get(e.key);const t=e.defaultValue();return Wi.set(e.key,t),t},Ub=(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):Ua(t),gd=l(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(bo in t)return Ua(t);throw Mb(t)}return e.unsafeMap.get(t.key)}),Db=gd,Cb=l(2,(e,t)=>e.unsafeMap.has(t.key)?dc(e.unsafeMap.get(t.key)):Pb(t)?dc(Ua(t)):yh),Bb=l(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[r,s]of t.unsafeMap)n.set(r,s);return Gn(n)}),gn=$b,ri=Nb,Yn=xb,Ts=pd,Wt=jb,Tt=Db,Da=gd,mn=Cb,Os=Bb,md=Ib,Es=Rb,yd=Symbol.for("effect/Chunk");function Kb(e,t,n,r,s){for(let o=t;o<Math.min(e.length,t+s);o++)n[r+o-t]=e[o];return n}const _d=[],qb=e=>ya((t,n)=>t.length===n.length&&Ot(t).every((r,s)=>e(r,Dn(n,s)))),Jb=qb(j),Vb={[yd]:{_A:e=>e},toString(){return we(this.toJSON())},toJSON(){return{_id:"Chunk",values:Ot(this).map(he)}},[re](){return this.toJSON()},[C](e){return bd(e)&&Jb(this,e)},[B](){return oe(this,ms(Ot(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return _d[Symbol.iterator]();default:return Ot(this)[Symbol.iterator]()}},pipe(){return M(this,arguments)}},ge=e=>{const t=Object.create(Vb);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=ct,t.right=ct;break}case"ISingleton":{t.length=1,t.depth=0,t.left=ct,t.right=ct;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=ct,t.right=ct;break}}return t},bd=e=>P(e,yd),ct=ge({_tag:"IEmpty"}),ft=()=>ct,Hi=(...e)=>Hb(e),Je=e=>ge({_tag:"ISingleton",a:e}),Sd=e=>bd(e)?e:vs(se(e)),kc=(e,t,n)=>{switch(e.backing._tag){case"IArray":{Kb(e.backing.array,0,t,n,e.length);break}case"IConcat":{kc(e.left,t,n),kc(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}case"ISlice":{let r=0,s=n;for(;r<e.length;)t[s]=Dn(e,r),r+=1,s+=1;break}}},zb=e=>{switch(e.backing._tag){case"IEmpty":return _d;case"IArray":return e.backing.array;default:{const t=new Array(e.length);return kc(e,t,0),e.backing={_tag:"IArray",array:t},e.left=ct,e.right=ct,e.depth=0,t}}},Ot=zb,Wb=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return ge({_tag:"IArray",array:al(e.backing.array)});case"IConcat":return ge({_tag:"IConcat",left:Qn(e.backing.right),right:Qn(e.backing.left)});case"ISlice":return vs(al(Ot(e)))}},Qn=Wb,vs=e=>e.length===0?ft():e.length===1?Je(e[0]):ge({_tag:"IArray",array:e}),Hb=e=>vs(e),Dn=l(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Dn(e.left,t):Dn(e.right,t-e.left.length);case"ISlice":return Dn(e.backing.chunk,t+e.backing.offset)}}),Gb=l(2,(e,t)=>Xe(e,Je(t))),nt=l(2,(e,t)=>Xe(Je(t),e)),Tc=l(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return ct;switch(e.backing._tag){case"ISlice":return ge({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?Tc(e.right,t-e.left.length):ge({_tag:"IConcat",left:Tc(e.left,t),right:e.right});default:return ge({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),Xe=l(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;const n=t.depth-e.depth;if(Math.abs(n)<=1)return ge({_tag:"IConcat",left:e,right:t});if(n<-1)if(e.left.depth>=e.right.depth){const r=Xe(e.right,t);return ge({_tag:"IConcat",left:e.left,right:r})}else{const r=Xe(e.right.right,t);if(r.depth===e.depth-3){const s=ge({_tag:"IConcat",left:e.right.left,right:r});return ge({_tag:"IConcat",left:e.left,right:s})}else{const s=ge({_tag:"IConcat",left:e.left,right:e.right.left});return ge({_tag:"IConcat",left:s,right:r})}}else if(t.right.depth>=t.left.depth){const r=Xe(e,t.left);return ge({_tag:"IConcat",left:r,right:t.right})}else{const r=Xe(e,t.left.left);if(r.depth===t.depth-3){const s=ge({_tag:"IConcat",left:r,right:t.left.right});return ge({_tag:"IConcat",left:s,right:t.right})}else{const s=ge({_tag:"IConcat",left:t.left.right,right:t.right});return ge({_tag:"IConcat",left:r,right:s})}}}),rF=l(2,(e,t)=>vs(k_(e,t))),Yb=e=>e.length===0,Zn=e=>e.length>0,wd=e=>Dn(e,0),Xn=wd,Ht=e=>Tc(e,1),Oc=Symbol.for("effect/Duration"),kd=BigInt(0),wl=BigInt(24),Ks=BigInt(60),Ec=BigInt(1e3),kl=BigInt(1e6),Tl=BigInt(1e9),Qb=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,ht=e=>{if(Td(e))return e;if(vt(e))return vc(e);if(Ho(e))return Gi(e);if(Array.isArray(e)&&e.length===2&&e.every(vt))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?Od:e[0]===1/0||e[1]===1/0?tS:Gi(BigInt(Math.round(e[0]*1e9))+BigInt(Math.round(e[1])));if(Ke(e)){const t=Qb.exec(e);if(t){const[n,r,s]=t,o=Number(r);switch(s){case"nano":case"nanos":return Gi(BigInt(r));case"micro":case"micros":return nS(BigInt(r));case"milli":case"millis":return vc(o);case"second":case"seconds":return rS(o);case"minute":case"minutes":return sS(o);case"hour":case"hours":return oS(o);case"day":case"days":return iS(o);case"week":case"weeks":return cS(o)}}}throw new Error("Invalid DurationInput")},Ol={_tag:"Millis",millis:0},Zb={_tag:"Infinity"},Xb={[Oc]:Oc,[B](){return oe(this,ch(this.value))},[C](e){return Td(e)&&dS(this,e)},toString(){return`Duration(${gS(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:uS(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[re](){return this.toJSON()},pipe(){return M(this,arguments)}},Ye=e=>{const t=Object.create(Xb);return vt(e)?isNaN(e)||e<=0?t.value=Ol:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=Zb:e<=kd?t.value=Ol:t.value={_tag:"Nanos",nanos:e},t},Td=e=>P(e,Oc),eS=e=>{switch(e.value._tag){case"Millis":return e.value.millis===0;case"Nanos":return e.value.nanos===kd;case"Infinity":return!1}},Od=Ye(0),tS=Ye(1/0),Gi=e=>Ye(e),nS=e=>Ye(e*Ec),vc=e=>Ye(e),rS=e=>Ye(e*1e3),sS=e=>Ye(e*6e4),oS=e=>Ye(e*36e5),iS=e=>Ye(e*864e5),cS=e=>Ye(e*6048e5),$c=e=>Ed(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6}),sF=e=>Ed(e,{onMillis:t=>t/864e5,onNanos:t=>Number(t)/864e11}),aS=e=>{const t=ht(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},uS=e=>{const t=ht(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/Tl),Number(t.value.nanos%Tl)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},Ed=l(2,(e,t)=>{const n=ht(e);switch(n.value._tag){case"Nanos":return t.onNanos(n.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(n.value.millis)}}),si=l(3,(e,t,n)=>{const r=ht(e),s=ht(t);if(r.value._tag==="Infinity"||s.value._tag==="Infinity")return n.onMillis($c(r),$c(s));if(r.value._tag==="Nanos"||s.value._tag==="Nanos"){const o=r.value._tag==="Nanos"?r.value.nanos:BigInt(Math.round(r.value.millis*1e6)),i=s.value._tag==="Nanos"?s.value.nanos:BigInt(Math.round(s.value.millis*1e6));return n.onNanos(o,i)}return n.onMillis(r.value.millis,s.value.millis)}),lS=(e,t)=>si(e,t,{onMillis:(n,r)=>n===r,onNanos:(n,r)=>n===r}),oF=l(2,(e,t)=>si(e,t,{onMillis:(n,r)=>Ye(n-r),onNanos:(n,r)=>Ye(n-r)})),fS=l(2,(e,t)=>si(e,t,{onMillis:(n,r)=>n<=r,onNanos:(n,r)=>n<=r})),hS=l(2,(e,t)=>si(e,t,{onMillis:(n,r)=>n>=r,onNanos:(n,r)=>n>=r})),dS=l(2,(e,t)=>lS(ht(e),ht(t))),pS=e=>{const t=ht(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};const n=aS(t),r=n/kl,s=r/Ec,o=s/Ks,i=o/Ks,c=i/wl;return{days:Number(c),hours:Number(i%wl),minutes:Number(o%Ks),seconds:Number(s%Ks),millis:Number(r%Ec),nanos:Number(n%kl)}},gS=e=>{const t=ht(e);if(t.value._tag==="Infinity")return"Infinity";if(eS(t))return"0";const n=pS(t),r=[];return n.days!==0&&r.push(`${n.days}d`),n.hours!==0&&r.push(`${n.hours}h`),n.minutes!==0&&r.push(`${n.minutes}m`),n.seconds!==0&&r.push(`${n.seconds}s`),n.millis!==0&&r.push(`${n.millis}ms`),n.nanos!==0&&r.push(`${n.nanos}ns`),r.join(" ")},nn=5,Ca=Math.pow(2,nn),mS=Ca-1,yS=Ca/2,_S=Ca/4;function bS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function er(e,t){return t>>>e&mS}function An(e){return 1<<e}function vd(e,t){return bS(e&t-1)}const SS=(e,t)=>({value:e,previous:t});function Cn(e,t,n,r){let s=r;if(!e){const o=r.length;s=new Array(o);for(let i=0;i<o;++i)s[i]=r[i]}return s[t]=n,s}function $d(e,t,n){const r=n.length-1;let s=0,o=0,i=n;if(e)s=o=t;else for(i=new Array(r);s<t;)i[o++]=n[s++];for(++s;s<=r;)i[o++]=n[s++];return e&&(i.length=r),i}function wS(e,t,n,r){const s=r.length;if(e){let a=s;for(;a>=t;)r[a--]=r[a];return r[t]=n,r}let o=0,i=0;const c=new Array(s+1);for(;o<t;)c[i++]=r[o++];for(c[t]=n;o<s;)c[++i]=r[o++];return c}class xt{_tag="EmptyNode";modify(t,n,r,s,o,i){const c=r(I());return Se(c)?new xt:(++i.value,new Zt(t,s,o,c))}}function et(e){return th(e,"EmptyNode")}function kS(e){return et(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function oi(e,t){return et(e)?!1:t===e.edit}class Zt{edit;hash;key;value;_tag="LeafNode";constructor(t,n,r,s){this.edit=t,this.hash=n,this.key=r,this.value=s}modify(t,n,r,s,o,i){if(j(o,this.key)){const a=r(this.value);return a===this.value?this:Se(a)?(--i.value,new xt):oi(this,t)?(this.value=a,this):new Zt(t,s,o,a)}const c=r(I());return Se(c)?this:(++i.value,Id(t,n,this.hash,this,s,new Zt(t,s,o,c)))}}class Ba{edit;hash;children;_tag="CollisionNode";constructor(t,n,r){this.edit=t,this.hash=n,this.children=r}modify(t,n,r,s,o,i){if(s===this.hash){const a=oi(this,t),u=this.updateCollisionList(a,t,this.hash,this.children,r,o,i);return u===this.children?this:u.length>1?new Ba(t,this.hash,u):u[0]}const c=r(I());return Se(c)?this:(++i.value,Id(t,n,this.hash,this,s,new Zt(t,s,o,c)))}updateCollisionList(t,n,r,s,o,i,c){const a=s.length;for(let h=0;h<a;++h){const f=s[h];if("key"in f&&j(i,f.key)){const d=f.value,g=o(d);return g===d?s:Se(g)?(--c.value,$d(t,h,s)):Cn(t,h,new Zt(n,r,i,g),s)}}const u=o(I());return Se(u)?s:(++c.value,Cn(t,a,new Zt(n,r,i,u),s))}}class tr{edit;mask;children;_tag="IndexedNode";constructor(t,n,r){this.edit=t,this.mask=n,this.children=r}modify(t,n,r,s,o,i){const c=this.mask,a=this.children,u=er(n,s),h=An(u),f=vd(c,h),d=c&h,g=oi(this,t);if(!d){const R=new xt().modify(t,n+nn,r,s,o,i);return R?a.length>=yS?OS(t,u,R,c,a):new tr(t,c|h,wS(g,f,R,a)):this}const y=a[f],E=y.modify(t,n+nn,r,s,o,i);if(y===E)return this;let b=c,w;if(et(E)){if(b&=~h,!b)return new xt;if(a.length<=2&&kS(a[f^1]))return a[f^1];w=$d(g,f,a)}else w=Cn(g,f,E,a);return g?(this.mask=b,this.children=w,this):new tr(t,b,w)}}class Ka{edit;size;children;_tag="ArrayNode";constructor(t,n,r){this.edit=t,this.size=n,this.children=r}modify(t,n,r,s,o,i){let c=this.size;const a=this.children,u=er(n,s),h=a[u],f=(h||new xt).modify(t,n+nn,r,s,o,i);if(h===f)return this;const d=oi(this,t);let g;if(et(h)&&!et(f))++c,g=Cn(d,u,f,a);else if(!et(h)&&et(f)){if(--c,c<=_S)return TS(t,c,u,a);g=Cn(d,u,new xt,a)}else g=Cn(d,u,f,a);return d?(this.size=c,this.children=g,this):new Ka(t,c,g)}}function TS(e,t,n,r){const s=new Array(t-1);let o=0,i=0;for(let c=0,a=r.length;c<a;++c)if(c!==n){const u=r[c];u&&!et(u)&&(s[o++]=u,i|=1<<c)}return new tr(e,i,s)}function OS(e,t,n,r,s){const o=[];let i=r,c=0;for(let a=0;i;++a)i&1&&(o[a]=s[c++]),i>>>=1;return o[t]=n,new Ka(e,c+1,o)}function ES(e,t,n,r,s,o){if(n===s)return new Ba(e,n,[o,r]);const i=er(t,n),c=er(t,s);if(i===c)return a=>new tr(e,An(i)|An(c),[a]);{const a=i<c?[r,o]:[o,r];return new tr(e,An(i)|An(c),a)}}function Id(e,t,n,r,s,o){let i,c=t;for(;;){const a=ES(e,c,n,r,s,o);if(typeof a=="function")i=SS(a,i),c=c+nn;else{let u=a;for(;i!=null;)u=i.value(u),i=i.previous;return u}}}const Rd="effect/HashMap",Ic=Symbol.for(Rd),vS={[Ic]:Ic,[Symbol.iterator](){return new ii(this,(e,t)=>[e,t])},[B](){let e=$(Rd);for(const t of this)e^=p($(t[0]),q($(t[1])));return oe(this,e)},[C](e){if(RS(e)){if(e._size!==this._size)return!1;for(const t of this){const n=p(e,Ja(t[0],$(t[0])));if(Se(n))return!1;if(!j(t[1],n.value))return!1}return!0}return!1},toString(){return we(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(he)}},[re](){return this.toJSON()},pipe(){return M(this,arguments)}},qa=(e,t,n,r)=>{const s=Object.create(vS);return s._editable=e,s._edit=t,s._root=n,s._size=r,s};class ii{map;f;v;constructor(t,n){this.map=t,this.f=n,this.v=Fd(this.map._root,this.f,void 0)}next(){if(Se(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=So(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new ii(this.map,this.f)}}const So=e=>e?Md(e[0],e[1],e[2],e[3],e[4]):I(),Fd=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return $e(e.value)?A({value:t(e.key,e.value.value),cont:n}):So(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const r=e.children;return Md(r.length,r,0,t,n)}default:return So(n)}},Md=(e,t,n,r,s)=>{for(;n<e;){const o=t[n++];if(o&&!et(o))return Fd(o,r,[e,t,n,r,s])}return So(s)},$S=qa(!1,0,new xt,0),ci=()=>$S,IS=e=>{const t=Nd(ci());for(const n of e)ss(t,n[0],n[1]);return PS(t)},RS=e=>P(e,Ic),FS=e=>e&&et(e._root),MS=l(2,(e,t)=>Ja(e,t,$(t))),Ja=l(3,(e,t,n)=>{let r=e._root,s=0;for(;;)switch(r._tag){case"LeafNode":return j(t,r.key)?r.value:I();case"CollisionNode":{if(n===r.hash){const o=r.children;for(let i=0,c=o.length;i<c;++i){const a=o[i];if("key"in a&&j(t,a.key))return a.value}}return I()}case"IndexedNode":{const o=er(s,n),i=An(o);if(r.mask&i){r=r.children[vd(r.mask,i)],s+=nn;break}return I()}case"ArrayNode":{if(r=r.children[er(s,n)],r){s+=nn;break}return I()}default:return I()}}),AS=l(2,(e,t)=>$e(Ja(e,t,$(t)))),ss=l(3,(e,t,n)=>Va(e,t,()=>A(n))),NS=l(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:qa(e._editable,e._edit,t,n)),Ad=e=>new ii(e,t=>t),wo=e=>e._size,Nd=e=>qa(!0,e._edit+1,e._root,e._size),PS=e=>(e._editable=!1,e),Va=l(3,(e,t,n)=>LS(e,t,$(t),n)),LS=l(4,(e,t,n,r)=>{const s={value:e._size},o=e._root.modify(e._editable?e._edit:NaN,0,r,n,t,s);return p(e,NS(o,s.value))}),El=l(2,(e,t)=>Va(e,t,I)),xS=l(2,(e,t)=>ai(e,ci(),(n,r,s)=>ss(n,s,t(r,s)))),Pd=l(2,(e,t)=>ai(e,void 0,(n,r,s)=>t(r,s))),ai=l(3,(e,t,n)=>{const r=e._root;if(r._tag==="LeafNode")return $e(r.value)?n(t,r.value.value,r.key):t;if(r._tag==="EmptyNode")return t;const s=[r.children];let o;for(;o=s.pop();)for(let i=0,c=o.length;i<c;){const a=o[i++];a&&!et(a)&&(a._tag==="LeafNode"?$e(a.value)&&(t=n(t,a.value.value,a.key)):s.push(a.children))}return t}),Ld="effect/HashSet",Rc=Symbol.for(Ld),jS={[Rc]:Rc,[Symbol.iterator](){return Ad(this._keyMap)},[B](){return oe(this,q($(this._keyMap))($(Ld)))},[C](e){return US(e)?wo(this._keyMap)===wo(e._keyMap)&&j(this._keyMap,e._keyMap):!1},toString(){return we(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(he)}},[re](){return this.toJSON()},pipe(){return M(this,arguments)}},ui=e=>{const t=Object.create(jS);return t._keyMap=e,t},US=e=>P(e,Rc),DS=ui(ci()),li=()=>DS,CS=e=>{const t=za(li());for(const n of e)os(t,n);return Wa(t)},BS=(...e)=>{const t=za(li());for(const n of e)os(t,n);return Wa(t)},KS=l(2,(e,t)=>AS(e._keyMap,t)),qS=e=>wo(e._keyMap),za=e=>ui(Nd(e._keyMap)),Wa=e=>(e._keyMap._editable=!1,e),xd=l(2,(e,t)=>{const n=za(e);return t(n),Wa(n)}),os=l(2,(e,t)=>e._keyMap._editable?(ss(t,!0)(e._keyMap),e):ui(ss(t,!0)(e._keyMap))),jd=l(2,(e,t)=>e._keyMap._editable?(El(t)(e._keyMap),e):ui(El(t)(e._keyMap))),JS=l(2,(e,t)=>xd(e,n=>{for(const r of t)jd(n,r)})),VS=l(2,(e,t)=>xd(li(),n=>{zS(e,r=>os(n,r));for(const r of t)os(n,r)})),zS=l(2,(e,t)=>Pd(e._keyMap,(n,r)=>t(r))),WS=l(3,(e,t,n)=>ai(e._keyMap,t,(r,s,o)=>n(r,o))),rn=li,HS=CS,Ha=BS,GS=KS,Ud=qS,Bn=os,Ga=jd,vl=JS,is=VS,ko=WS,$l=Symbol.for("effect/MutableRef"),YS={[$l]:$l,toString(){return we(this.toJSON())},toJSON(){return{_id:"MutableRef",current:he(this.current)}},[re](){return this.toJSON()},pipe(){return M(this,arguments)}},Ya=e=>{const t=Object.create(YS);return t.current=e,t},sn=e=>e.current,fi=l(2,(e,t)=>(e.current=t,e)),Qa="effect/FiberId",cs=Symbol.for(Qa),To="None",Fc="Runtime",QS="Composite",ZS=fe(`${Qa}-${To}`);let XS=class{[cs]=cs;_tag=To;id=-1;startTimeMillis=-1;[B](){return ZS}[C](t){return Dd(t)&&t._tag===To}toString(){return we(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[re](){return this.toJSON()}};class ew{id;startTimeMillis;[cs]=cs;_tag=Fc;constructor(t,n){this.id=t,this.startTimeMillis=n}[B](){return oe(this,fe(`${Qa}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[C](t){return Dd(t)&&t._tag===Fc&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return we(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[re](){return this.toJSON()}}const tw=new XS,Dd=e=>P(e,cs),Mc=e=>{switch(e._tag){case To:return rn();case Fc:return Ha(e.id);case QS:return p(Mc(e.left),is(Mc(e.right)))}},Il=U(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>Ya(0)),hi=e=>Array.from(Mc(e)).map(n=>`#${n}`).join(","),nw=()=>{const e=sn(Il);return p(Il,fi(e+1)),new ew(e,Date.now())},on=tw,rw=hi,Cd=nw,di=ci,sw=IS,ow=FS,Bd=MS,Kd=ss,qd=Ad,Jd=wo,iw=Va,cw=xS,aw=Pd,Vd=ai,as=Symbol.for("effect/List"),Ac=e=>se(e),uw=e=>ny(Ra(e),Ac),lw=uw(j),fw={[as]:as,_tag:"Cons",toString(){return we(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:Ac(this).map(he)}},[re](){return this.toJSON()},[C](e){return Wd(e)&&this._tag===e._tag&&lw(this,e)},[B](){return oe(this,ms(Ac(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();const n=t.head;return t=t.tail,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},pipe(){return M(this,arguments)}},Oo=(e,t)=>{const n=Object.create(fw);return n.head=e,n.tail=t,n},hw=fe("Nil"),dw={[as]:as,_tag:"Nil",toString(){return we(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[re](){return this.toJSON()},[B](){return hw},[C](e){return Wd(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return M(this,arguments)}},zd=Object.create(dw),Wd=e=>P(e,as),Et=e=>e._tag==="Nil",Za=e=>e._tag==="Cons",pw=()=>zd,cn=(e,t)=>Oo(e,t),nr=pw,Xa=e=>Oo(e,zd),gw=l(2,(e,t)=>yw(t,e)),mw=l(2,(e,t)=>cn(t,e)),yw=l(2,(e,t)=>{if(Et(e))return t;if(Et(t))return e;{const n=Oo(t.head,e);let r=n,s=t.tail;for(;!Et(s);){const o=Oo(s.head,e);r.tail=o,r=o,s=s.tail}return n}}),_w=l(3,(e,t,n)=>{let r=t,s=e;for(;!Et(s);)r=n(r,s.head),s=s.tail;return r}),bw=e=>{let t=nr(),n=e;for(;!Et(n);)t=mw(t,n.head),n=n.tail;return t},pi=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=Ea,e}(),Sw=Symbol.for("effect/DifferContextPatch");function Rl(e){return e}const $s={...pi.prototype,[Sw]:{_Value:Rl,_Patch:Rl}},ww=Object.assign(Object.create($s),{_tag:"Empty"}),kw=Object.create(ww),Hd=()=>kw,Tw=Object.assign(Object.create($s),{_tag:"AndThen"}),Ow=(e,t)=>{const n=Object.create(Tw);return n.first=e,n.second=t,n},Ew=Object.assign(Object.create($s),{_tag:"AddService"}),vw=(e,t)=>{const n=Object.create(Ew);return n.key=e,n.service=t,n},$w=Object.assign(Object.create($s),{_tag:"RemoveService"}),Iw=e=>{const t=Object.create($w);return t.key=e,t},Rw=Object.assign(Object.create($s),{_tag:"UpdateService"}),Fw=(e,t)=>{const n=Object.create(Rw);return n.key=e,n.update=t,n},Mw=(e,t)=>{const n=new Map(e.unsafeMap);let r=Hd();for(const[s,o]of t.unsafeMap.entries())if(n.has(s)){const i=n.get(s);n.delete(s),j(i,o)||(r=Zs(Fw(s,()=>o))(r))}else n.delete(s),r=Zs(vw(s,o))(r);for(const[s]of n.entries())r=Zs(Iw(s))(r);return r},Zs=l(2,(e,t)=>Ow(e,t)),Aw=l(2,(e,t)=>{if(e._tag==="Empty")return t;let n=!1,r=Je(e);const s=new Map(t.unsafeMap);for(;Zn(r);){const i=Xn(r),c=Ht(r);switch(i._tag){case"Empty":{r=c;break}case"AddService":{s.set(i.key,i.service),r=c;break}case"AndThen":{r=nt(nt(c,i.second),i.first);break}case"RemoveService":{s.delete(i.key),r=c;break}case"UpdateService":{s.set(i.key,i.update(s.get(i.key))),n=!0,r=c;break}}}if(!n)return Gn(s);const o=new Map;for(const[i]of t.unsafeMap)s.has(i)&&(o.set(i,s.get(i)),s.delete(i));for(const[i,c]of s)o.set(i,c);return Gn(o)}),Nw=Symbol.for("effect/DifferHashSetPatch");function Yi(e){return e}const gi={...pi.prototype,[Nw]:{_Value:Yi,_Key:Yi,_Patch:Yi}},Pw=Object.assign(Object.create(gi),{_tag:"Empty"}),Lw=Object.create(Pw),Gd=()=>Lw,xw=Object.assign(Object.create(gi),{_tag:"AndThen"}),jw=(e,t)=>{const n=Object.create(xw);return n.first=e,n.second=t,n},Uw=Object.assign(Object.create(gi),{_tag:"Add"}),Dw=e=>{const t=Object.create(Uw);return t.value=e,t},Cw=Object.assign(Object.create(gi),{_tag:"Remove"}),Bw=e=>{const t=Object.create(Cw);return t.value=e,t},Kw=(e,t)=>{const[n,r]=ko([e,Gd()],([s,o],i)=>GS(i)(s)?[Ga(i)(s),o]:[s,Nc(Dw(i))(o)])(t);return ko(r,(s,o)=>Nc(Bw(o))(s))(n)},Nc=l(2,(e,t)=>jw(e,t)),qw=l(2,(e,t)=>{if(e._tag==="Empty")return t;let n=t,r=Je(e);for(;Zn(r);){const s=Xn(r),o=Ht(r);switch(s._tag){case"Empty":{r=o;break}case"AndThen":{r=nt(s.first)(nt(s.second)(o));break}case"Add":{n=Bn(s.value)(n),r=o;break}case"Remove":n=Ga(s.value)(n),r=o}}return n}),Jw=Symbol.for("effect/DifferReadonlyArrayPatch");function Fl(e){return e}const Is={...pi.prototype,[Jw]:{_Value:Fl,_Patch:Fl}},Vw=Object.assign(Object.create(Is),{_tag:"Empty"}),zw=Object.create(Vw),Yd=()=>zw,Ww=Object.assign(Object.create(Is),{_tag:"AndThen"}),Hw=(e,t)=>{const n=Object.create(Ww);return n.first=e,n.second=t,n},Gw=Object.assign(Object.create(Is),{_tag:"Append"}),Yw=e=>{const t=Object.create(Gw);return t.values=e,t},Qw=Object.assign(Object.create(Is),{_tag:"Slice"}),Zw=(e,t)=>{const n=Object.create(Qw);return n.from=e,n.until=t,n},Xw=Object.assign(Object.create(Is),{_tag:"Update"}),ek=(e,t)=>{const n=Object.create(Xw);return n.index=e,n.patch=t,n},tk=e=>{let t=0,n=Yd();for(;t<e.oldValue.length&&t<e.newValue.length;){const r=e.oldValue[t],s=e.newValue[t],o=e.differ.diff(r,s);j(o,e.differ.empty)||(n=Xs(n,ek(t,o))),t=t+1}return t<e.oldValue.length&&(n=Xs(n,Zw(0,t))),t<e.newValue.length&&(n=Xs(n,Yw(p_(t)(e.newValue)))),n},Xs=l(2,(e,t)=>Hw(e,t)),nk=l(3,(e,t,n)=>{if(e._tag==="Empty")return t;let r=t.slice(),s=Ze(e);for(;Ys(s);){const o=Ne(s),i=en(s);switch(o._tag){case"Empty":{s=i;break}case"AndThen":{i.unshift(o.first,o.second),s=i;break}case"Append":{for(const c of o.values)r.push(c);s=i;break}case"Slice":{r=r.slice(o.from,o.until),s=i;break}case"Update":{r[o.index]=n.patch(o.patch,r[o.index]),s=i;break}}}return r}),rk=Symbol.for("effect/Differ"),sk={[rk]:{_P:z,_V:z},pipe(){return M(this,arguments)}},br=e=>{const t=Object.create(sk);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},ok=()=>br({empty:Hd(),combine:(e,t)=>Zs(t)(e),diff:(e,t)=>Mw(e,t),patch:(e,t)=>Aw(t)(e)}),ik=()=>br({empty:Gd(),combine:(e,t)=>Nc(t)(e),diff:(e,t)=>Kw(e,t),patch:(e,t)=>qw(t)(e)}),ck=e=>br({empty:Yd(),combine:(t,n)=>Xs(t,n),diff:(t,n)=>tk({oldValue:t,newValue:n,differ:e}),patch:(t,n)=>nk(t,n,e)}),Qd=()=>ak((e,t)=>t),ak=e=>br({empty:z,combine:(t,n)=>t===z?n:n===z?t:r=>n(t(r)),diff:(t,n)=>j(t,n)?z:zo(n),patch:(t,n)=>e(n,t(n))}),us=255,Zd=8,Pc=e=>e&us,Lc=e=>e>>Zd&us,Rs=(e,t)=>(e&us)+((t&e&us)<<Zd),uk=Rs(0,0),lk=e=>Rs(e,e),fk=e=>Rs(e,0),hk=l(2,(e,t)=>Rs(Pc(e)&~t,Lc(e))),dk=l(2,(e,t)=>e|t),pk=e=>~e>>>0&us,gk=0,yn=1,mk=2,Xd=4,xc=16,ep=32,yk=e=>mi(e,ep),_k=l(2,(e,t)=>e&~t),bk=l(2,(e,t)=>e|t),At=e=>tp(e)&&!wk(e),tp=e=>mi(e,yn),mi=l(2,(e,t)=>(e&t)!==0),np=(...e)=>e.reduce((t,n)=>t|n,0),Sk=np(gk),Ml=e=>mi(e,Xd),wk=e=>mi(e,xc),Yr=l(2,(e,t)=>Rs(e^t,t)),eo=l(2,(e,t)=>e&(pk(Pc(t))|Lc(t))|Pc(t)&Lc(t)),Al=br({empty:uk,diff:(e,t)=>Yr(e,t),combine:(e,t)=>dk(t)(e),patch:(e,t)=>eo(t,e)}),kk=lk,rp=fk,Nl=hk,sp=(e,t)=>({_tag:"Par",left:e,right:t}),qs=(e,t)=>({_tag:"Seq",left:e,right:t}),Tk=e=>{let t=Xa(e),n=nr();for(;;){const[r,s]=_w(t,[op(),nr()],([o,i],c)=>{const[a,u]=Ok(c);return[Rk(o,a),gw(i,u)]});if(n=Ek(n,r),Et(s))return bw(n);t=s}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},Ok=e=>{let t=e,n=op(),r=nr(),s=nr();for(;;)switch(t._tag){case"Empty":{if(Et(r))return[n,s];t=r.head,r=r.tail;break}case"Par":{r=cn(t.right,r),t=t.left;break}case"Seq":{const o=t.left,i=t.right;switch(o._tag){case"Empty":{t=i;break}case"Par":{const c=o.left,a=o.right;t=sp(qs(c,i),qs(a,i));break}case"Seq":{const c=o.left,a=o.right;t=qs(c,qs(a,i));break}case"Single":{t=o,s=cn(i,s);break}}break}case"Single":{if(n=Ik(n,t),Et(r))return[n,s];t=r.head,r=r.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},Ek=(e,t)=>{if(Et(e))return Xa(Qi(t));if(Fk(t))return e;const n=xk(e.head),r=Mk(t);return n.length===1&&r.length===1&&j(n[0],r[0])?cn(Lk(e.head,Qi(t)),e.tail):cn(Qi(t),e)},vk=Symbol.for("effect/RequestBlock/RequestBlockParallel"),$k={_R:e=>e};class eu{map;[vk]=$k;constructor(t){this.map=t}}const op=()=>new eu(di()),Ik=(e,t)=>new eu(iw(e.map,t.dataSource,n=>Hy(Wr(n,Gb(t.blockedRequest)),()=>Je(t.blockedRequest)))),Rk=(e,t)=>new eu(Vd(e.map,t.map,(n,r,s)=>Kd(n,s,qe(Bd(n,s),{onNone:()=>r,onSome:o=>Xe(r,o)})))),Fk=e=>ow(e.map),Mk=e=>Array.from(qd(e.map)),Qi=e=>Pk(cw(e.map,t=>Je(t))),Ak=Symbol.for("effect/RequestBlock/RequestBlockSequential"),Nk={_R:e=>e};class ip{map;[Ak]=Nk;constructor(t){this.map=t}}const Pk=e=>new ip(e),Lk=(e,t)=>new ip(Vd(t.map,e.map,(n,r,s)=>Kd(n,s,qe(Bd(n,s),{onNone:()=>ft(),onSome:o=>Xe(o,r)})))),xk=e=>Array.from(qd(e.map)),jk=e=>Array.from(e.map),Fs="Die",an="Empty",_n="Fail",Sr="Interrupt",rr="Parallel",sr="Sequential",cp="effect/Cause",ap=Symbol.for(cp),Uk={_E:e=>e},wr={[ap]:Uk,[B](){return p($(cp),q($(Gk(this))),oe(this))},[C](e){return up(e)&&Hk(this,e)},pipe(){return M(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:he(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:he(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:he(this.left),right:he(this.right)}}},toString(){return Bt(this)},[re](){return this.toJSON()}},or=(()=>{const e=Object.create(wr);return e._tag=an,e})(),ls=e=>{const t=Object.create(wr);return t._tag=_n,t.error=e,t},Ge=e=>{const t=Object.create(wr);return t._tag=Fs,t.defect=e,t},bt=e=>{const t=Object.create(wr);return t._tag=Sr,t.fiberId=e,t},yi=(e,t)=>{const n=Object.create(wr);return n._tag=rr,n.left=e,n.right=t,n},Ae=(e,t)=>{const n=Object.create(wr);return n._tag=sr,n.left=e,n.right=t,n},up=e=>P(e,ap),Dk=e=>e._tag===an,Ck=e=>e._tag===_n,tu=e=>e._tag===an?!0:ir(e,!0,(t,n)=>{switch(n._tag){case an:return A(t);case Fs:case _n:case Sr:return A(!1);default:return I()}}),Bk=e=>$e(zk(e)),nu=e=>ru(void 0,Qk)(e),Kk=e=>Qn(ir(e,ft(),(t,n)=>n._tag===_n?A(p(t,nt(n.error))):I())),qk=e=>Qn(ir(e,ft(),(t,n)=>n._tag===Fs?A(p(t,nt(n.defect))):I())),Jk=e=>ir(e,rn(),(t,n)=>n._tag===Sr?A(p(t,Bn(n.fiberId))):I()),Vk=e=>fp(e,t=>t._tag===_n?A(t.error):I()),lp=e=>{const t=Vk(e);switch(t._tag){case"None":return K(e);case"Some":return L(t.value)}},zk=e=>fp(e,t=>t._tag===Sr?A(t.fiberId):I()),Pl=e=>hp(e,{onEmpty:or,onFail:()=>or,onDie:Ge,onInterrupt:bt,onSequential:Ae,onParallel:yi}),Wk=e=>hp(e,{onEmpty:or,onFail:Ge,onDie:Ge,onInterrupt:bt,onSequential:Ae,onParallel:yi}),Hk=(e,t)=>{let n=Je(e),r=Je(t);for(;Zn(n)&&Zn(r);){const[s,o]=p(Xn(n),ir([rn(),ft()],([a,u],h)=>{const[f,d]=jc(h);return A([p(a,is(f)),p(u,Xe(d))])})),[i,c]=p(Xn(r),ir([rn(),ft()],([a,u],h)=>{const[f,d]=jc(h);return A([p(a,is(f)),p(u,Xe(d))])}));if(!j(s,i))return!1;n=o,r=c}return!0},Gk=e=>Yk(Je(e),ft()),Yk=(e,t)=>{for(;;){const[n,r]=p(e,Mh([rn(),ft()],([o,i],c)=>{const[a,u]=jc(c);return[p(o,is(a)),p(i,Xe(u))]})),s=Ud(n)>0?p(t,nt(n)):t;if(Yb(r))return Qn(s);e=r,t=s}throw new Error(Go("Cause.flattenCauseLoop"))},fp=l(2,(e,t)=>{const n=[e];for(;n.length>0;){const r=n.pop(),s=t(r);switch(s._tag){case"None":{switch(r._tag){case sr:case rr:{n.push(r.right),n.push(r.left);break}}break}case"Some":return s}}return I()}),jc=e=>{let t=e;const n=[];let r=rn(),s=ft();for(;t!==void 0;)switch(t._tag){case an:{if(n.length===0)return[r,s];t=n.pop();break}case _n:{if(r=Bn(r,Hi(t._tag,t.error)),n.length===0)return[r,s];t=n.pop();break}case Fs:{if(r=Bn(r,Hi(t._tag,t.defect)),n.length===0)return[r,s];t=n.pop();break}case Sr:{if(r=Bn(r,Hi(t._tag,t.fiberId)),n.length===0)return[r,s];t=n.pop();break}case sr:{switch(t.left._tag){case an:{t=t.right;break}case sr:{t=Ae(t.left.left,Ae(t.left.right,t.right));break}case rr:{t=yi(Ae(t.left.left,t.right),Ae(t.left.right,t.right));break}default:{s=nt(s,t.right),t=t.left;break}}break}case rr:{n.push(t.right),t=t.left;break}}throw new Error(Go("Cause.evaluateCauseLoop"))},Qk={emptyCase:ol,failCase:ao,dieCase:ao,interruptCase:ol,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},Ll="SequentialCase",xl="ParallelCase",hp=l(2,(e,{onDie:t,onEmpty:n,onFail:r,onInterrupt:s,onParallel:o,onSequential:i})=>ru(e,void 0,{emptyCase:()=>n,failCase:(c,a)=>r(a),dieCase:(c,a)=>t(a),interruptCase:(c,a)=>s(a),sequentialCase:(c,a,u)=>i(a,u),parallelCase:(c,a,u)=>o(a,u)})),ir=l(3,(e,t,n)=>{let r=t,s=e;const o=[];for(;s!==void 0;){const i=n(r,s);switch(r=$e(i)?i.value:r,s._tag){case sr:{o.push(s.right),s=s.left;break}case rr:{o.push(s.right),s=s.left;break}default:{s=void 0;break}}s===void 0&&o.length>0&&(s=o.pop())}return r}),ru=l(3,(e,t,n)=>{const r=[e],s=[];for(;r.length>0;){const i=r.pop();switch(i._tag){case an:{s.push(K(n.emptyCase(t)));break}case _n:{s.push(K(n.failCase(t,i.error)));break}case Fs:{s.push(K(n.dieCase(t,i.defect)));break}case Sr:{s.push(K(n.interruptCase(t,i.fiberId)));break}case sr:{r.push(i.right),r.push(i.left),s.push(L({_tag:Ll}));break}case rr:{r.push(i.right),r.push(i.left),s.push(L({_tag:xl}));break}}}const o=[];for(;s.length>0;){const i=s.pop();switch(i._tag){case"Left":{switch(i.left._tag){case Ll:{const c=o.pop(),a=o.pop(),u=n.sequentialCase(t,c,a);o.push(u);break}case xl:{const c=o.pop(),a=o.pop(),u=n.parallelCase(t,c,a);o.push(u);break}}break}case"Right":{o.push(i.right);break}}}if(o.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return o.pop()}),Bt=(e,t)=>nu(e)?"All fibers interrupted without errors.":pp(e).map(function(n){return t?.renderErrorCause!==!0||n.cause===void 0?n.stack:`${n.stack} {
${dp(n.cause,"  ")}
}`}).join(`
`),dp=(e,t)=>{const n=e.stack.split(`
`);let r=`${t}[cause]: ${n[0]}`;for(let s=1,o=n.length;s<o;s++)r+=`
${t}${n[s]}`;return e.cause&&(r+=` {
${dp(e.cause,`${t}  `)}
${t}}`),r};class Eo extends globalThis.Error{span=void 0;constructor(t){const n=typeof t=="object"&&t!==null,r=Error.stackTraceLimit;Error.stackTraceLimit=1,super(Zk(t),n&&"cause"in t&&typeof t.cause<"u"?{cause:new Eo(t.cause)}:void 0),this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=r,this.name=t instanceof Error?t.name:"Error",n&&(cr in t&&(this.span=t[cr]),Object.keys(t).forEach(s=>{s in this||(this[s]=t[s])})),this.stack=e0(`${this.name}: ${this.message}`,t instanceof Error&&t.stack?t.stack:"",this.span)}}const Zk=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(P(e,"toString")&&gr(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return ah(e)},Xk=/\((.*)\)/g,vo=U("effect/Tracer/spanToTrace",()=>new WeakMap),e0=(e,t,n)=>{const r=[e],s=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let o=1;o<s.length;o++){if(s[o].includes(" at new BaseEffectError")||s[o].includes(" at new YieldableError")){o++;continue}if(s[o].includes("Generator.next")||s[o].includes("effect_internal_function"))break;r.push(s[o].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(n){let o=n,i=0;for(;o&&o._tag==="Span"&&i<10;){const c=vo.get(o);if(typeof c=="function"){const a=c();if(typeof a=="string"){const u=a.matchAll(Xk);let h=!1;for(const[,f]of u)h=!0,r.push(`    at ${o.name} (${f})`);h||r.push(`    at ${o.name} (${a.replace(/^at /,"")})`)}else r.push(`    at ${o.name}`)}else r.push(`    at ${o.name}`);o=it(o.parent),i++}}return r.join(`
`)},cr=Symbol.for("effect/SpanAnnotation"),pp=e=>ru(e,void 0,{emptyCase:()=>[],dieCase:(t,n)=>[new Eo(n)],failCase:(t,n)=>[new Eo(n)],interruptCase:()=>[],parallelCase:(t,n,r)=>[...n,...r],sequentialCase:(t,n,r)=>[...n,...r]}),Ms="Pending",su="Done",t0="effect/Deferred",n0=Symbol.for(t0),r0={_E:e=>e,_A:e=>e},s0=e=>({_tag:Ms,joiners:e}),gp=e=>({_tag:su,effect:e});class As{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new As(this.self)}}const mp=(e,t)=>{const n=new ye("Blocked");return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n},o0=e=>{const t=new ye("RunBlocked");return t.effect_instruction_i0=e,t},ar=Symbol.for("effect/Effect");class i0{patch;op;_op=Oa;constructor(t,n){this.patch=t,this.op=n}}class ye{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[ar]=zn;constructor(t){this._op=t}[C](t){return this===t}[B](){return oe(this,Sa(this))}pipe(){return M(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:he(this.effect_instruction_i0),effect_instruction_i1:he(this.effect_instruction_i1),effect_instruction_i2:he(this.effect_instruction_i2)}}toString(){return we(this.toJSON())}[re](){return this.toJSON()}[Symbol.iterator](){return new As(new gs(this))}}class yp{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[ar]=zn;constructor(t){this._op=t,this._tag=t}[C](t){return mu(t)&&t._op==="Failure"&&j(this.effect_instruction_i0,t.effect_instruction_i0)}[B](){return p(fe(this._tag),q($(this.effect_instruction_i0)),oe(this))}get cause(){return this.effect_instruction_i0}pipe(){return M(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return we(this.toJSON())}[re](){return this.toJSON()}[Symbol.iterator](){return new As(new gs(this))}}class _p{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[ar]=zn;constructor(t){this._op=t,this._tag=t}[C](t){return mu(t)&&t._op==="Success"&&j(this.effect_instruction_i0,t.effect_instruction_i0)}[B](){return p(fe(this._tag),q($(this.effect_instruction_i0)),oe(this))}get value(){return this.effect_instruction_i0}pipe(){return M(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:he(this.value)}}toString(){return we(this.toJSON())}[re](){return this.toJSON()}[Symbol.iterator](){return new As(new gs(this))}}const bn=e=>P(e,ar),Z=e=>{const t=new ye(fh);return t.effect_instruction_i0=e,t},c0=l(3,(e,t,n)=>jt(r=>k(e,s=>k(Kn(G(()=>r(t(s)))),o=>G(()=>n(s,o)).pipe($t({onFailure:i=>{switch(o._tag){case Re:return ke(Ae(o.effect_instruction_i0,i));case Fe:return ke(i)}},onSuccess:()=>o})))))),rt=l(2,(e,t)=>k(e,()=>x(t))),Kt=e=>rt(e,void 0),bp=function(){const e=new ye(Qo);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(Go("you're not supposed to end up here"))}return e},fs=(e,t=on)=>{const n=new ye(Vr);let r;return n.effect_instruction_i0=s=>{r=e(s)},n.effect_instruction_i1=t,Op(n,s=>bn(r)?r:ue)},Sp=(e,t=on)=>G(()=>fs(e,t)),un=(e,t=on)=>bp(e,function(){let n,r;function s(a){n?n(a):r===void 0&&(r=a)}const o=new ye(Vr);o.effect_instruction_i0=a=>{n=a,r&&a(r)},o.effect_instruction_i1=t;let i,c;return this.effect_instruction_i0.length!==1?(c=new AbortController,i=ve(()=>this.effect_instruction_i0(s,c.signal))):i=ve(()=>this.effect_instruction_i0(s)),i||c?Op(o,a=>(c&&c.abort(),i??ue)):o}),Uc=l(2,(e,t)=>uu(e,{onFailure:t,onSuccess:x})),jl=Symbol.for("effect/OriginalAnnotation"),ou=(e,t)=>$e(t)?new Proxy(e,{has(n,r){return r===cr||r===jl||r in n},get(n,r){return r===cr?t.value:r===jl?e:n[r]}}):e,$o=e=>It(e)&&!(cr in e)?Z(t=>ke(Ge(ou(e,wu(t))))):ke(Ge(e)),Ul=e=>a0(()=>Ge(new B0(e))),ur=e=>uu(e,{onFailure:t=>x(L(t)),onSuccess:t=>x(K(t))}),Kn=e=>l0(e,{onFailure:H,onSuccess:te}),le=e=>It(e)&&!(cr in e)?Z(t=>ke(ls(ou(e,wu(t))))):ke(ls(e)),iu=e=>k(v(e),le),ke=e=>{const t=new yp(Re);return t.effect_instruction_i0=e,t},a0=e=>k(v(e),ke),cu=Z(e=>x(e.id())),au=e=>Z(t=>e(t.id())),k=l(2,(e,t)=>{const n=new ye(fo);return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n}),Nn=l(2,(e,t)=>k(e,n=>{const r=typeof t=="function"?t(n):t;return bn(r)?r:nh(r)?fs(s=>{r.then(o=>s(x(o)),o=>s(le(new $i(o,"An unknown error occurred in Effect.andThen"))))}):x(r)})),u0=e=>{const t=new ye("OnStep");return t.effect_instruction_i0=e,t},_i=e=>k(e,z),l0=l(2,(e,t)=>$t(e,{onFailure:n=>x(t.onFailure(n)),onSuccess:n=>x(t.onSuccess(n))})),$t=l(2,(e,t)=>{const n=new ye(ho);return n.effect_instruction_i0=e,n.effect_instruction_i1=t.onFailure,n.effect_instruction_i2=t.onSuccess,n}),uu=l(2,(e,t)=>$t(e,{onFailure:n=>{if(qk(n).length>0)return ke(Wk(n));const s=Kk(n);return s.length>0?t.onFailure(wd(s)):ke(n)},onSuccess:t.onSuccess})),St=l(2,(e,t)=>G(()=>{const n=se(e),r=Zo(n.length);let s=0;return rt(fu({while:()=>s<n.length,body:()=>t(n[s],s),step:o=>{r[s++]=o}}),r)})),bi=l(2,(e,t)=>G(()=>{const n=se(e);let r=0;return fu({while:()=>r<n.length,body:()=>t(n[r],r),step:()=>{r++}})})),cF=k(cu,e=>wp(e)),wp=e=>ke(bt(e)),kp=e=>{const t=new ye(mr);return t.effect_instruction_i0=kk(yn),t.effect_instruction_i1=()=>e,t},Y=l(2,(e,t)=>k(e,n=>v(()=>t(n)))),Tp=l(2,(e,t)=>uu(e,{onFailure:n=>iu(()=>t.onFailure(n)),onSuccess:n=>v(()=>t.onSuccess(n))})),Si=l(2,(e,t)=>$t(e,{onFailure:n=>{const r=lp(n);switch(r._tag){case"Left":return iu(()=>t(r.left));case"Right":return ke(r.right)}},onSuccess:x})),lr=l(2,(e,t)=>jt(n=>$t(n(e),{onFailure:r=>{const s=H(r);return $t(t(s),{onFailure:o=>H(Ae(r,o)),onSuccess:()=>s})},onSuccess:r=>{const s=te(r);return at(t(s),s)}}))),Op=l(2,(e,t)=>lr(e,yu({onFailure:n=>nu(n)?Kt(t(Jk(n))):ue,onSuccess:()=>ue}))),x=e=>{const t=new _p(Fe);return t.effect_instruction_i0=e,t},G=e=>{const t=new ye(Qo);return t.commit=e,t},v=e=>{const t=new ye(lh);return t.effect_instruction_i0=e,t},wi=l(e=>e.length===3||e.length===2&&!(It(e[1])&&"onlyEffect"in e[1]),(e,t)=>k(e,n=>{const r=typeof t=="function"?t(n):t;return bn(r)?rt(r,n):nh(r)?fs(s=>{r.then(o=>s(x(n)),o=>s(le(new $i(o,"An unknown error occurred in Effect.tap"))))}):x(n)})),f0=e=>Z(t=>{const n=t.getFiberRef(Cc),r=p(n,ae(()=>t.scope()));return e(Ei(Cc,A(r)))}),lu=e=>{const t=new ye(mr);return t.effect_instruction_i0=rp(yn),t.effect_instruction_i1=()=>e,t},jt=e=>bp(e,function(){const t=new ye(mr);return t.effect_instruction_i0=rp(yn),t.effect_instruction_i1=n=>tp(n)?ve(()=>this.effect_instruction_i0(kp)):ve(()=>this.effect_instruction_i0(lu)),t}),ue=x(void 0),h0=e=>{const t=new ye(mr);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},d0=l(2,(e,t)=>k(t,n=>n?p(e,Y(A)):x(I()))),fu=e=>{const t=new ye(po);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},Ep=e=>G(()=>{const t=new ye(zr);return t.effect_instruction_i0=e(),t}),p0=function(){const e=arguments.length===1?arguments[0]:arguments[1].bind(arguments[0]);return Ep(()=>e(p))},g0=l(2,(e,t)=>{const n=new ye(mr);return n.effect_instruction_i0=t,n.effect_instruction_i1=()=>e,n}),ki=e=>{const t=new ye(Gs);return typeof e?.priority<"u"?N0(t,e.priority):t},vp=l(2,(e,t)=>k(e,n=>Y(t,r=>[n,r]))),$p=l(2,(e,t)=>k(e,n=>rt(t,n))),at=l(2,(e,t)=>k(e,()=>t)),m0=l(3,(e,t,n)=>k(e,r=>Y(t,s=>n(r,s)))),Ip=e=>k(cu,t=>p(e,hu(t))),hu=l(2,(e,t)=>k(e.interruptAsFork(t),()=>e.await)),y0={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return M(this,arguments)}},_0={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return M(this,arguments)}},b0={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return M(this,arguments)}},S0={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return M(this,arguments)}},Rp={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return M(this,arguments)}},Fp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return M(this,arguments)}},w0={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return M(this,arguments)}},k0={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return M(this,arguments)}},T0="effect/FiberRef",O0=Symbol.for(T0),E0={_A:e=>e},Ti=e=>Z(t=>te(t.getFiberRef(e))),Oi=l(2,(e,t)=>k(Ti(e),t)),Io=l(2,(e,t)=>v0(e,()=>[void 0,t])),v0=l(2,(e,t)=>Z(n=>{const[r,s]=t(n.getFiberRef(e));return n.setFiberRef(e,s),x(r)})),Ei=l(3,(e,t,n)=>c0($p(Ti(t),Io(t,n)),()=>e,r=>Io(t,r))),Ie=(e,t)=>kr(e,{differ:Qd(),fork:t?.fork??z,join:t?.join}),$0=e=>{const t=ik();return kr(e,{differ:t,fork:t.empty})},I0=e=>{const t=ck(Qd());return kr(e,{differ:t,fork:t.empty})},Mp=e=>{const t=ok();return kr(e,{differ:t,fork:t.empty})},kr=(e,t)=>({...yr,[O0]:E0,initial:e,commit(){return Ti(this)},diff:(r,s)=>t.differ.diff(r,s),combine:(r,s)=>t.differ.combine(r,s),patch:r=>s=>t.differ.patch(r,s),fork:t.fork,join:t.join??((r,s)=>s)}),R0=e=>kr(e,{differ:Al,fork:Al.empty}),Sn=U(Symbol.for("effect/FiberRef/currentContext"),()=>Mp(Yn())),Ns=U(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>Ie(0)),Ap=U(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>Ie(2048)),F0=U(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>Ie(di())),M0=U(Symbol.for("effect/FiberRef/currentLogLevel"),()=>Ie(Rp)),A0=U(Symbol.for("effect/FiberRef/currentLogSpan"),()=>Ie(nr())),N0=l(2,(e,t)=>Ei(e,Ns,t)),P0=U(Symbol.for("effect/FiberRef/currentConcurrency"),()=>Ie("unbounded")),L0=U(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>Ie(!0)),x0=U(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>Ie(A(Fp))),Dc=U(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>I0(tn())),Cc=U(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>Ie(I(),{fork:()=>I(),join:(e,t)=>e})),Js=U(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>Ie(or,{fork:()=>or,join:(e,t)=>e})),j0=U(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>Ie(!0)),Np=U(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>Ie(!0)),U0=U(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>Ie(di())),D0=U(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>Ie(ft())),Dl=Symbol.for("effect/Scope"),Cl=Symbol.for("effect/CloseableScope"),C0=(e,t)=>e.addFinalizer(()=>Kt(t)),Bc=(e,t)=>e.addFinalizer(t),Kc=(e,t)=>e.close(t),vi=(e,t)=>e.fork(t),du=function(){class e extends globalThis.Error{commit(){return le(this)}toJSON(){const n={...this};return this.message&&(n.message=this.message),this.cause&&(n.cause=this.cause),n}[re](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?Bt(ls(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,Ay),e}(),pu=(e,t)=>{class n extends du{_tag=t}return Object.assign(n.prototype,e),n.prototype.name=t,n},Bl=Symbol.for("effect/Cause/errors/RuntimeException"),B0=pu({[Bl]:Bl},"RuntimeException"),K0=Symbol.for("effect/Cause/errors/InterruptedException"),q0=e=>P(e,K0),Kl=Symbol.for("effect/Cause/errors/IllegalArgument"),J0=pu({[Kl]:Kl},"IllegalArgumentException"),ql=Symbol.for("effect/Cause/errors/NoSuchElement"),gu=pu({[ql]:ql},"NoSuchElementException"),Jl=Symbol.for("effect/Cause/errors/UnknownException"),$i=function(){class e extends du{_tag="UnknownException";error;constructor(n,r){super(r??"An unknown error occurred",{cause:n}),this.error=n}}return Object.assign(e.prototype,{[Jl]:Jl,name:"UnknownException"}),e}(),mu=e=>bn(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),V0=e=>e._tag==="Failure",z0=e=>e._tag==="Success",W0=l(2,(e,t)=>{switch(e._tag){case Re:return H(e.effect_instruction_i0);case Fe:return te(t)}}),Zi=e=>W0(e,void 0),Qr=(e,t)=>eT(e,t?.parallel?yi:Ae),H0=e=>H(Ge(e)),Vl=e=>H(ls(e)),H=e=>{const t=new yp(Re);return t.effect_instruction_i0=e,t},G0=l(2,(e,t)=>{switch(e._tag){case Re:return H(e.effect_instruction_i0);case Fe:return t(e.effect_instruction_i0)}}),Y0=e=>p(e,G0(z)),Q0=e=>H(bt(e)),Xi=l(2,(e,t)=>{switch(e._tag){case Re:return H(e.effect_instruction_i0);case Fe:return te(t(e.effect_instruction_i0))}}),yu=l(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case Re:return t(e.effect_instruction_i0);case Fe:return n(e.effect_instruction_i0)}}),Z0=l(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case Re:return t(e.effect_instruction_i0);case Fe:return n(e.effect_instruction_i0)}}),te=e=>{const t=new _p(Fe);return t.effect_instruction_i0=e,t},Be=te(void 0),X0=l(3,(e,t,{onFailure:n,onSuccess:r})=>{switch(e._tag){case Re:switch(t._tag){case Fe:return H(e.effect_instruction_i0);case Re:return H(n(e.effect_instruction_i0,t.effect_instruction_i0))}case Fe:switch(t._tag){case Fe:return te(r(e.effect_instruction_i0,t.effect_instruction_i0));case Re:return H(t.effect_instruction_i0)}}}),eT=(e,t)=>{const n=Sd(e);return Zn(n)?p(Ht(n),Mh(p(Xn(n),Xi(Je)),(r,s)=>p(r,X0(s,{onSuccess:(o,i)=>p(o,nt(i)),onFailure:t}))),Xi(Qn),Xi(r=>Ot(r)),A):I()},Pp=e=>({...yr,[n0]:r0,state:Ya(s0([])),commit(){return _u(this)},blockingOn:e}),tT=()=>k(cu,e=>nT(e)),nT=e=>v(()=>Pp(e)),_u=e=>Sp(t=>{const n=sn(e.state);switch(n._tag){case su:return t(n.effect);case Ms:return n.joiners.push(t),oT(e,t)}},e.blockingOn),bu=l(2,(e,t)=>v(()=>{const n=sn(e.state);switch(n._tag){case su:return!1;case Ms:{fi(e.state,gp(t));for(let r=0,s=n.joiners.length;r<s;r++)n.joiners[r](t);return!0}}})),rT=l(2,(e,t)=>bu(e,ke(t))),aF=l(2,(e,t)=>bu(e,wp(t))),sT=l(2,(e,t)=>bu(e,x(t))),Lp=(e,t)=>{const n=sn(e.state);if(n._tag===Ms){fi(e.state,gp(t));for(let r=0,s=n.joiners.length;r<s;r++)n.joiners[r](t)}},oT=(e,t)=>v(()=>{const n=sn(e.state);if(n._tag===Ms){const r=n.joiners.indexOf(t);r>=0&&n.joiners.splice(r,1)}}),iT=Z(e=>te(e.currentContext)),Su=()=>iT,Tr=e=>k(Su(),e),Ps=l(2,(e,t)=>Ei(Sn,t)(e)),cT=l(2,(e,t)=>Tr(n=>Ps(e,t(n)))),wu=e=>{const t=e.currentSpan;return t!==void 0&&t._tag==="Span"?A(t):I()},aT={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:Be},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},uT=e=>Object.assign(Object.create(aT),e),lT=z0,fT=Y0,uF=Be,zl=Symbol.for("effect/MutableHashMap"),hT={[zl]:zl,[Symbol.iterator](){return new ku(this)},toString(){return we(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(he)}},[re](){return this.toJSON()},pipe(){return M(this,arguments)}};class ku{self;referentialIterator;bucketIterator;constructor(t){this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();const t=this.referentialIterator.next();return t.done?(this.bucketIterator=new dT(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new ku(this.self)}}class dT{backing;constructor(t){this.backing=t}currentBucket;next(){if(this.currentBucket===void 0){const n=this.backing.next();if(n.done)return n;this.currentBucket=n.value[Symbol.iterator]()}const t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}}const pT=()=>{const e=Object.create(hT);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},zt=l(2,(e,t)=>{if(lo(t)===!1)return e.referential.has(t)?A(e.referential.get(t)):I();const n=t[B](),r=e.buckets.get(n);return r===void 0?I():gT(e,r,t)}),gT=(e,t,n,r=!1)=>{for(let s=0,o=t.length;s<o;s++)if(n[C](t[s][0])){const i=t[s][1];return r&&(t.splice(s,1),e.bucketsSize--),A(i)}return I()},Nr=l(2,(e,t)=>$e(zt(e,t))),Pr=l(3,(e,t,n)=>{if(lo(t)===!1)return e.referential.set(t,n),e;const r=t[B](),s=e.buckets.get(r);return s===void 0?(e.buckets.set(r,[[t,n]]),e.bucketsSize++,e):(mT(e,s,t),s.push([t,n]),e.bucketsSize++,e)}),mT=(e,t,n)=>{for(let r=0,s=t.length;r<s;r++)if(n[C](t[r][0])){t.splice(r,1),e.bucketsSize--;return}},yT="effect/Clock",Wl=Symbol.for(yT),Or=gn("effect/Clock"),_T=2**31-1,Hl={unsafeSchedule(e,t){const n=$c(t);if(n>_T)return ao;let r=!1;const s=setTimeout(()=>{r=!0,e()},n);return()=>(clearTimeout(s),!r)}},Gl=function(){const e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t;return()=>(t===void 0&&(t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6))),t+BigInt(Math.round(performance.now()*1e6)))}(),bT=function(){const e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return Gl;const t=Gl()-e.bigint();return()=>t+e.bigint()}();class ST{[Wl]=Wl;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return bT()}currentTimeMillis=v(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=v(()=>this.unsafeCurrentTimeNanos());scheduler(){return x(Hl)}sleep(t){return un(n=>{const r=Hl.unsafeSchedule(()=>n(ue),t);return Kt(v(r))})}}const wT=()=>new ST,xp="And",jp="Or",Up="InvalidData",Dp="MissingData",Cp="SourceUnavailable",Bp="Unsupported",kT="effect/ConfigError",Yl=Symbol.for(kT),Er={_tag:"ConfigError",[Yl]:Yl},Kp=(e,t)=>{const n=Object.create(Er);return n._op=xp,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},qp=(e,t)=>{const n=Object.create(Er);return n._op=jp,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},TT=(e,t,n={pathDelim:"."})=>{const r=Object.create(Er);return r._op=Up,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Invalid data at ${p(this.path,_r(n.pathDelim))}: "${this.message}")`}}),r},ln=(e,t,n={pathDelim:"."})=>{const r=Object.create(Er);return r._op=Dp,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Missing data at ${p(this.path,_r(n.pathDelim))}: "${this.message}")`}}),r},OT=(e,t,n,r={pathDelim:"."})=>{const s=Object.create(Er);return s._op=Cp,s.path=e,s.message=t,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){return`(Source unavailable at ${p(this.path,_r(r.pathDelim))}: "${this.message}")`}}),s},ET=(e,t,n={pathDelim:"."})=>{const r=Object.create(Er);return r._op=Bp,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${p(this.path,_r(n.pathDelim))}: "${this.message}")`}}),r},Gt=l(2,(e,t)=>{switch(e._op){case xp:return Kp(Gt(e.left,t),Gt(e.right,t));case jp:return qp(Gt(e.left,t),Gt(e.right,t));case Up:return TT([...t,...e.path],e.message);case Dp:return ln([...t,...e.path],e.message);case Cp:return OT([...t,...e.path],e.message,e.cause);case Bp:return ET([...t,...e.path],e.message)}}),vT={_tag:"Empty"},ec=l(2,(e,t)=>{let n=Xa(t),r=e;for(;Za(n);){const s=n.head;switch(s._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=cn(s.first,cn(s.second,n.tail));break}case"MapName":{r=xn(r,s.f),n=n.tail;break}case"Nested":{r=go(r,s.name),n=n.tail;break}case"Unnested":{if(p(Hr(r),Xy(s.name)))r=en(r),n=n.tail;else return L(ln(r,`Expected ${s.name} to be in path in ConfigProvider#unnested`));break}}}return K(r)}),$T="Constant",IT="Fail",RT="Fallback",FT="Described",MT="Lazy",AT="MapOrFail",NT="Nested",PT="Primitive",LT="Sequence",xT="HashMap",jT="ZipWith";var Ql={};const Ro=(e,t)=>[...e,...t],UT="effect/ConfigProvider",Zl=Symbol.for(UT),DT=gn("effect/ConfigProvider"),CT="effect/ConfigProviderFlat",Xl=Symbol.for(CT),BT=e=>({[Zl]:Zl,pipe(){return M(this,arguments)},...e}),KT=e=>({[Xl]:Xl,patch:e.patch,load:(t,n,r=!0)=>e.load(t,n,r),enumerateChildren:e.enumerateChildren}),qT=e=>BT({load:t=>k(ze(e,tn(),t,!1),n=>qe(Hr(n),{onNone:()=>le(ln(tn(),`Expected a single value having structure: ${t}`)),onSome:x})),flattened:e}),JT=e=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),r=a=>p(a,_r(t)),s=a=>a.split(t),o=()=>typeof process<"u"&&"env"in process&&typeof Ql=="object"?Ql:{};return qT(KT({load:(a,u,h=!0)=>{const f=r(a),d=o(),g=f in d?A(d[f]):I();return p(g,Si(()=>ln(a,`Expected ${f} to exist in the process context`)),k(y=>GT(y,a,u,n,h)))},enumerateChildren:a=>v(()=>{const u=o(),d=Object.keys(u).map(g=>s(g.toUpperCase())).filter(g=>{for(let y=0;y<a.length;y++){const E=p(a,Rh(y)),b=g[y];if(b===void 0||E!==b)return!1}return!0}).flatMap(g=>g.slice(a.length,a.length+1));return HS(d)}),patch:vT}))},VT=(e,t,n,r)=>{const s=ll(n.length,a=>a>=r.length?I():A([e(a),a+1])),o=ll(r.length,a=>a>=n.length?I():A([t(a),a+1])),i=Ro(n,s),c=Ro(r,o);return[i,c]},zT=(e,t)=>{let n=t;if(n._tag==="Nested"){const r=e.slice();for(;n._tag==="Nested";)r.push(n.name),n=n.config;return r}return e},ze=(e,t,n,r)=>{const s=n;switch(s._tag){case $T:return x(Ze(s.value));case FT:return G(()=>ze(e,t,s.config,r));case IT:return le(ln(t,s.message));case RT:return p(G(()=>ze(e,t,s.first,r)),Uc(o=>s.condition(o)?p(ze(e,t,s.second,r),Uc(i=>le(qp(o,i)))):le(o)));case MT:return G(()=>ze(e,t,s.config(),r));case AT:return G(()=>p(ze(e,t,s.original,r),k(St(o=>p(s.mapOrFail(o),Si(Gt(zT(t,s.original))))))));case NT:return G(()=>ze(e,Ro(t,Ze(s.name)),s.config,r));case PT:return p(ec(t,e.patch),k(o=>p(e.load(o,s,r),k(i=>{if(i.length===0){const c=p(f_(o),ae(()=>"<n/a>"));return le(ln([],`Expected ${s.description} with name ${c}`))}return x(i)}))));case LT:return p(ec(t,e.patch),k(o=>p(e.enumerateChildren(o),k(QT),k(i=>i.length===0?G(()=>Y(ze(e,t,s.config,!0),Ze)):p(St(i,c=>ze(e,o_(t,`[${c}]`),s.config,!0)),Y(c=>{const a=S_(c);return a.length===0?Ze(tn()):Ze(a)}))))));case xT:return G(()=>p(ec(t,e.patch),k(o=>p(e.enumerateChildren(o),k(i=>p(i,St(c=>ze(e,Ro(o,Ze(c)),s.valueConfig,r)),Y(c=>c.length===0?Ze(di()):p(YT(c),xn(a=>sw(ul(se(i),a)))))))))));case jT:return G(()=>p(ze(e,t,s.left,r),ur,k(o=>p(ze(e,t,s.right,r),ur,k(i=>{if(Ee(o)&&Ee(i))return le(Kp(o.left,i.left));if(Ee(o)&&ut(i))return le(o.left);if(ut(o)&&Ee(i))return le(i.left);if(ut(o)&&ut(i)){const c=p(t,_r(".")),a=WT(t,c),[u,h]=VT(a,a,p(o.right,xn(K)),p(i.right,xn(K)));return p(u,ul(h),St(([f,d])=>p(vp(f,d),Y(([g,y])=>s.zip(g,y)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},WT=(e,t)=>n=>L(ln(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),HT=(e,t)=>e.split(new RegExp(`\\s*${yo(t)}\\s*`)),GT=(e,t,n,r,s)=>s?p(HT(e,r),St(o=>n.parse(o.trim())),Si(Gt(t))):p(n.parse(e),Tp({onFailure:Gt(t),onSuccess:Ze})),YT=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),QT=e=>p(St(e,XT),Tp({onFailure:()=>tn(),onSuccess:ts(Wn)}),ur,Y(Jy)),ZT=/^(\[(\d+)\])$/,XT=e=>{const t=e.match(ZT);if(t!==null){const n=t[2];return p(n!==void 0&&n.length>0?A(n):I(),bs(eO))}return I()},eO=e=>{const t=Number.parseInt(e);return Number.isNaN(t)?I():A(t)},ef=Symbol.for("effect/Console"),Ii=gn("effect/Console"),tO={[ef]:ef,assert(e,...t){return v(()=>{console.assert(e,...t)})},clear:v(()=>{console.clear()}),count(e){return v(()=>{console.count(e)})},countReset(e){return v(()=>{console.countReset(e)})},debug(...e){return v(()=>{console.debug(...e)})},dir(e,t){return v(()=>{console.dir(e,t)})},dirxml(...e){return v(()=>{console.dirxml(...e)})},error(...e){return v(()=>{console.error(...e)})},group(e){return e?.collapsed?v(()=>console.groupCollapsed(e?.label)):v(()=>console.group(e?.label))},groupEnd:v(()=>{console.groupEnd()}),info(...e){return v(()=>{console.info(...e)})},log(...e){return v(()=>{console.log(...e)})},table(e,t){return v(()=>{console.table(e,t)})},time(e){return v(()=>console.time(e))},timeEnd(e){return v(()=>console.timeEnd(e))},timeLog(e,...t){return v(()=>{console.timeLog(e,...t)})},trace(...e){return v(()=>{console.trace(...e)})},warn(...e){return v(()=>{console.warn(...e)})},unsafe:console},nO="effect/Random",tf=Symbol.for(nO),rO=gn("effect/Random");class sO{seed;[tf]=tf;PRNG;constructor(t){this.seed=t,this.PRNG=new my(t)}get next(){return v(()=>this.PRNG.number())}get nextBoolean(){return Y(this.next,t=>t>.5)}get nextInt(){return v(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,n){return Y(this.next,r=>(n-t)*r+t)}nextIntBetween(t,n){return v(()=>this.PRNG.integer(n-t)+t)}shuffle(t){return oO(t,n=>this.nextIntBetween(0,n))}}const oO=(e,t)=>G(()=>p(v(()=>Array.from(e)),k(n=>{const r=[];for(let s=n.length;s>=2;s=s-1)r.push(s);return p(r,bi(s=>p(t(s),Y(o=>iO(n,s-1,o)))),rt(Sd(n)))}))),iO=(e,t,n)=>{const r=e[t];return e[t]=e[n],e[n]=r,e},cO=e=>new sO($(e)),nf=Symbol.for("effect/Tracer"),aO=e=>({[nf]:nf,...e}),Tu=gn("effect/Tracer"),Ri=gn("effect/ParentSpan"),rf=function(){const e="abcdef0123456789",t=e.length;return function(n){let r="";for(let s=0;s<n;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}}();class uO{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(t,n,r,s,o,i){this.name=t,this.parent=n,this.context=r,this.startTime=o,this.kind=i,this.status={_tag:"Started",startTime:o},this.attributes=new Map,this.traceId=n._tag==="Some"?n.value.traceId:rf(32),this.spanId=rf(16),this.links=Array.from(s)}end(t,n){this.status={_tag:"Ended",endTime:t,exit:n,startTime:this.status.startTime}}attribute(t,n){this.attributes.set(t,n)}event(t,n,r){this.events.push([t,n,r??{}])}addLinks(t){this.links.push(...t)}}const lO=aO({span:(e,t,n,r,s,o)=>new uO(e,t,n,r,s,o),context:e=>e()}),Jp=e=>{if(e?.captureStackTrace===!1)return e;if(e?.captureStackTrace!==void 0&&typeof e.captureStackTrace!="boolean")return e;const t=Error.stackTraceLimit;Error.stackTraceLimit=3;const n=new Error;Error.stackTraceLimit=t;let r=!1;return{...e,captureStackTrace:()=>{if(r!==!1)return r;if(n.stack!==void 0){const s=n.stack.split(`
`);if(s[3]!==void 0)return r=s[3].trim(),r}}}},Fo=Es()("effect/Tracer/DisablePropagation",{defaultValue:ao}),fO=p(Yn(),Wt(Or,wT()),Wt(Ii,tO),Wt(rO,cO(Math.random())),Wt(DT,JT()),Wt(Tu,lO)),Ut=U(Symbol.for("effect/DefaultServices/currentServices"),()=>Mp(fO)),hO=e=>{const t=ht(e);return pO(n=>n.sleep(t))},dO=e=>Z(t=>e(t.currentDefaultServices)),pO=e=>dO(t=>e(t.unsafeMap.get(Or.key))),gO=hO,mO=Or;function yO(e){return new Dt(e)}function _O(){return yO(new Map)}const sf=Symbol.for("effect/FiberRefs");class Dt{locals;[sf]=sf;constructor(t){this.locals=t}pipe(){return M(this,arguments)}}const bO=(e,t,n,r=!1)=>{const s=e;let o=t,i=n,c=r,a;for(;a===void 0;)if(ne(o)&&ne(i)){const u=Ne(o)[0],h=en(o),f=Ne(i)[0],d=Ne(i)[1],g=en(i);u.startTimeMillis<f.startTimeMillis?(i=g,c=!0):u.startTimeMillis>f.startTimeMillis?o=h:u.id<f.id?(i=g,c=!0):u.id>f.id?o=h:a=[d,c]}else a=[s.initial,!0];return a},SO=l(3,(e,t,n)=>{const r=new Map(e.locals);return n.locals.forEach((s,o)=>{const i=s[0][1];if(!s[0][0][C](t)){if(!r.has(o)){if(j(i,o.initial))return;r.set(o,[[t,o.join(o.initial,i)]]);return}const c=r.get(o),[a,u]=bO(o,c,s);if(u){const h=o.diff(a,i),f=c[0][1],d=o.join(f,o.patch(h)(f));if(!j(f,d)){let g;const y=c[0][0];y[C](t)?g=[[y,d],...c.slice(1)]:g=[[t,d],...c],r.set(o,g)}}}}),new Dt(r)}),wO=l(2,(e,t)=>{const n=new Map;return Vp(e,n,t),new Dt(n)}),Vp=(e,t,n)=>{e.locals.forEach((r,s)=>{const o=r[0][1],i=s.patch(s.fork)(o);j(o,i)?t.set(s,r):t.set(s,[[n,i],...r])})},zp=l(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new Dt(n)}),Wp=l(2,(e,t)=>e.locals.has(t)?A(Ne(e.locals.get(t))[1]):I()),hs=l(2,(e,t)=>p(Wp(e,t),ae(()=>t.initial))),qc=l(2,(e,{fiberId:t,fiberRef:n,value:r})=>{if(e.locals.size===0)return new Dt(new Map([[n,[[t,r]]]]));const s=new Map(e.locals);return Jc(s,t,n,r),new Dt(s)}),Jc=(e,t,n,r)=>{const s=e.get(n)??[];let o;if(ne(s)){const[i,c]=Ne(s);if(i[C](t)){if(j(c,r))return;o=[[t,r],...s.slice(1)]}else o=[[t,r],...s]}else o=[[t,r]];e.set(n,o)},kO=l(2,(e,{entries:t,forkAs:n})=>{if(e.locals.size===0)return new Dt(new Map(t));const r=new Map(e.locals);return n!==void 0&&Vp(e,r,n),t.forEach(([s,o])=>{o.length===1?Jc(r,o[0][0],s,o[0][1]):o.forEach(([i,c])=>{Jc(r,i,s,c)})}),new Dt(r)}),of=Wp,Ou=hs,TO=kO,OO=_O,EO=y0,vO=_0,$O=b0,IO=S0,Hp=Rp,RO=Fp,FO=w0,MO=k0,AO=p(Wn,vh(e=>e.ordinal)),NO=Wy(AO),PO=e=>{switch(e){case"All":return EO;case"Debug":return RO;case"Error":return $O;case"Fatal":return vO;case"Info":return Hp;case"Trace":return FO;case"None":return MO;case"Warning":return IO}},Gp=e=>e.replace(/[\s="]/g,"_"),Eu=e=>t=>`${Gp(t.label)}=${e-t.startTime}ms`,LO=ys,xO=yr,jO=Ny;let vu=class extends jO{};const Mo=Symbol.for("effect/Readable"),Yp=Symbol.for("effect/Ref"),Qp={_A:e=>e};class UO extends vu{ref;commit(){return this.get}[Yp]=Qp;[Mo]=Mo;constructor(t){super(),this.ref=t,this.get=v(()=>sn(this.ref))}get;modify(t){return v(()=>{const n=sn(this.ref),[r,s]=t(n);return n!==s&&fi(s)(this.ref),r})}}const Zp=e=>new UO(Ya(e)),cf=e=>v(()=>Zp(e)),Ao=e=>e.get,Xp=l(2,(e,t)=>e.modify(()=>[void 0,t])),DO=l(2,(e,t)=>e.modify(t)),af=l(2,(e,t)=>e.modify(n=>[void 0,t(n)])),eg="Empty",tg="Add",ng="Remove",rg="Update",sg="AndThen",CO={_tag:eg},og=(e,t)=>{const n=new Map(e.locals);let r=CO;for(const[s,o]of t.locals.entries()){const i=Ne(o)[1],c=n.get(s);if(c!==void 0){const a=Ne(c)[1];j(a,i)||(r=tc({_tag:rg,fiberRef:s,patch:s.diff(a,i)})(r))}else r=tc({_tag:tg,fiberRef:s,value:i})(r);n.delete(s)}for(const[s]of n.entries())r=tc({_tag:ng,fiberRef:s})(r);return r},tc=l(2,(e,t)=>({_tag:sg,first:e,second:t})),ig=l(3,(e,t,n)=>{let r=n,s=Ze(e);for(;ne(s);){const o=Ne(s),i=en(s);switch(o._tag){case eg:{s=i;break}case tg:{r=qc(r,{fiberId:t,fiberRef:o.fiberRef,value:o.value}),s=i;break}case ng:{r=zp(r,o.fiberRef),s=i;break}case rg:{const c=hs(r,o.fiberRef);r=qc(r,{fiberId:t,fiberRef:o.fiberRef,value:o.fiberRef.patch(o.patch)(c)}),s=i;break}case sg:{s=go(o.first)(go(o.second)(i));break}}}return r}),cg="effect/MetricLabel",Vc=Symbol.for(cg);class BO{key;value;[Vc]=Vc;_hash;constructor(t,n){this.key=t,this.value=n,this._hash=fe(cg+this.key+this.value)}[B](){return this._hash}[C](t){return qO(t)&&this.key===t.key&&this.value===t.value}pipe(){return M(this,arguments)}}const KO=(e,t)=>new BO(e,t),qO=e=>P(e,Vc),JO=e=>Y(e,A),VO=e=>{let t,n;return typeof e=="function"?t=e:(t=e.try,n=e.catch),G(()=>{try{return x(ve(t))}catch(r){return le(n?ve(()=>n(r)):new $i(r,"An unknown error occurred in Effect.try"))}})},zO=e=>eE(e,HO,og),WO=e=>{const t=k(k(e,()=>ki()),()=>t);return t},HO=Z(e=>x(e.getFiberRefs())),GO=e=>(...t)=>{const n=_s(e);let r;for(let s=0,o=t.length;s<o;s++){const i=t[s];up(i)&&(r!==void 0?r=Ae(r,i):r=i,t=[...t.slice(0,s),...t.slice(s+1)],s--)}return r===void 0&&(r=or),Z(s=>(s.log(t,r,n),ue))},YO=GO(Hp),QO=e=>nE((t,n)=>p(e,ig(t,n))),$u=l(3,(e,t,n)=>Tr(r=>Ps(e,Wt(r,t,n)))),ZO=gO,XO=x(I()),eE=l(3,(e,t,n)=>k(t,r=>k(e,s=>Y(t,o=>[n(r,o),s])))),tE=e=>{let t,n;typeof e=="function"?t=e:(t=e.try,n=e.catch);const r=s=>n?iu(()=>n(s)):le(new $i(s,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?un((s,o)=>{try{t(o).then(i=>s(te(i)),i=>s(r(i)))}catch(i){s(r(i))}}):un(s=>{try{t().then(o=>s(te(o)),o=>s(r(o)))}catch(o){s(r(o))}})},nE=e=>Z(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),ue)),rE=e=>Y(Su(),mn(e)),ag=BigInt(0),ug=bs(e=>Tt(e.context,Fo)?e._tag==="Span"?ug(e.parent):I():A(e)),sE=(e,t,n)=>{const r=!e.getFiberRef(j0)||n.context&&Tt(n.context,Fo),s=e.getFiberRef(Sn),o=n.parent?A(n.parent):n.root?I():ug(mn(s,Ri));let i;if(r)i=uT({name:t,parent:o,context:Wt(n.context??Yn(),Fo,!0)});else{const c=e.getFiberRef(Ut),a=Tt(c,Tu),u=Tt(c,mO),h=e.getFiberRef(Np),f=e.getFiberRefs(),d=of(f,U0),g=of(f,D0),y=g._tag==="Some"?n.links!==void 0?[...Ot(g.value),...n.links??[]]:Ot(g.value):n.links??tn();i=a.span(t,o,n.context??Yn(),y,h?u.unsafeCurrentTimeNanos():ag,n.kind??"internal"),d._tag==="Some"&&aw(d.value,(E,b)=>i.attribute(b,E)),n.attributes!==void 0&&Object.entries(n.attributes).forEach(([E,b])=>i.attribute(E,b))}return typeof n.captureStackTrace=="function"&&vo.set(i,n.captureStackTrace),i},oE=(e,t,n,r)=>v(()=>{e.status._tag!=="Ended"&&(V0(t)&&vo.has(e)&&e.attribute("code.stacktrace",vo.get(e)()),e.end(r?n.unsafeCurrentTimeNanos():ag,t))}),uf=(e,...t)=>{const n=Jp(t.length===1?void 0:t[0]),r=t[t.length-1];return Z(s=>{const o=sE(s,e,n),i=s.getFiberRef(Np),c=Tt(s.getFiberRef(Ut),Or);return lr(r(o),a=>oE(o,a,c,i))})},lf=l(2,(e,t)=>$u(e,Ri,t)),iE=function(){const e=typeof arguments[0]!="string",t=e?arguments[1]:arguments[0],n=Jp(e?arguments[2]:arguments[1]);if(e){const r=arguments[0];return uf(t,n,s=>lf(r,s))}return r=>uf(t,n,s=>lf(r,s))},cE=e=>e==null?le(new gu):x(e),lg="Sequential",fg="Parallel",aE="ParallelN",Fi={_tag:lg},uE={_tag:fg},lE=e=>({_tag:aE,parallelism:e}),fE=e=>e._tag===lg,hE=e=>e._tag===fg,zc=Fi,Wc=uE,Hc=lE,Gc=og,Yc=ig,Mi="effect/FiberStatus",fn=Symbol.for(Mi),No="Done",ff="Running",hf="Suspended",dE=fe(`${Mi}-${No}`);class pE{[fn]=fn;_tag=No;[B](){return dE}[C](t){return Iu(t)&&t._tag===No}}class gE{runtimeFlags;[fn]=fn;_tag=ff;constructor(t){this.runtimeFlags=t}[B](){return p($(Mi),q($(this._tag)),q($(this.runtimeFlags)),oe(this))}[C](t){return Iu(t)&&t._tag===ff&&this.runtimeFlags===t.runtimeFlags}}class mE{runtimeFlags;blockingOn;[fn]=fn;_tag=hf;constructor(t,n){this.runtimeFlags=t,this.blockingOn=n}[B](){return p($(Mi),q($(this._tag)),q($(this.runtimeFlags)),q($(this.blockingOn)),oe(this))}[C](t){return Iu(t)&&t._tag===hf&&this.runtimeFlags===t.runtimeFlags&&j(this.blockingOn,t.blockingOn)}}const yE=new pE,_E=e=>new gE(e),bE=(e,t)=>new mE(e,t),Iu=e=>P(e,fn),SE=e=>e._tag===No,wE=yE,hg=_E,kE=bE,TE=SE,dg=Symbol.for("effect/Micro"),Po=Symbol.for("effect/Micro/MicroExit"),df=e=>typeof e=="object"&&e!==null&&dg in e,pf=Symbol.for("effect/Micro/MicroCause"),OE={_E:z};class Ru extends globalThis.Error{_tag;traces;[pf];constructor(t,n,r){const s=`MicroCause.${t}`;let o,i,c;if(n instanceof globalThis.Error){o=`(${s}) ${n.name}`,i=n.message;const a=i.split(`
`).length;c=n.stack?`(${s}) ${n.stack.split(`
`).slice(0,a+3).join(`
`)}`:`${o}: ${i}`}else o=s,i=Vn(n,0),c=`${o}: ${i}`;r.length>0&&(c+=`
    ${r.join(`
    `)}`),super(i),this._tag=t,this.traces=r,this[pf]=OE,this.name=o,this.stack=c}pipe(){return M(this,arguments)}toString(){return this.stack}[re](){return this.stack}}class EE extends Ru{error;constructor(t,n=[]){super("Fail",t,n),this.error=t}}const vE=(e,t=[])=>new EE(e,t);class $E extends Ru{defect;constructor(t,n=[]){super("Die",t,n),this.defect=t}}const IE=(e,t=[])=>new $E(e,t);class RE extends Ru{constructor(t=[]){super("Interrupt","interrupted",t)}}const FE=(e=[])=>new RE(e),pg=e=>e._tag==="Interrupt",gf=Symbol.for("effect/Micro/MicroFiber"),ME={_A:z,_E:z};class AE{context;interruptible;[gf];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(t,n=!0){this.context=t,this.interruptible=n,this[gf]=ME}getRef(t){return Ub(this.context,t)}addObserver(t){return this._exit?(t(this._exit),ty):(this._observers.push(t),()=>{const n=this._observers.indexOf(t);n>=0&&this._observers.splice(n,1)})}_interrupted=!1;unsafeInterrupt(){this._exit||(this._interrupted=!0,this.interruptible&&this.evaluate(Mu))}unsafePoll(){return this._exit}evaluate(t){if(this._exit)return;if(this._yielded!==void 0){const s=this._yielded;this._yielded=void 0,s()}const n=this.runLoop(t);if(n===Pn)return;const r=mf.interruptChildren&&mf.interruptChildren(this);if(r!==void 0)return this.evaluate(fr(r,()=>n));this._exit=n;for(let s=0;s<this._observers.length;s++)this._observers[s](n);this._observers.length=0}runLoop(t){let n=!1,r=t;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!n&&this.getRef(Au).shouldYield(this)){n=!0;const s=r;r=fr(UE,()=>s)}if(r=r[Qc](this),r===Pn){const s=this._yielded;return Po in s?(this._yielded=void 0,s):Pn}}}catch(s){return P(r,Qc)?Zc(s):Zc(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`)}}getCont(t){for(;;){const n=this._stack.pop();if(!n)return;const r=n[Lo]&&n[Lo](this);if(r)return{[t]:r};if(n[t])return n}}_yielded=void 0;yieldWith(t){return this._yielded=t,Pn}children(){return this._children??=new Set}}const mf=U("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),gg=Symbol.for("effect/Micro/identifier"),X=Symbol.for("effect/Micro/args"),Qc=Symbol.for("effect/Micro/evaluate"),hn=Symbol.for("effect/Micro/successCont"),qn=Symbol.for("effect/Micro/failureCont"),Lo=Symbol.for("effect/Micro/ensureCont"),Pn=Symbol.for("effect/Micro/Yield"),NE={_A:z,_E:z,_R:z},PE={...LO,_op:"Micro",[dg]:NE,pipe(){return M(this,arguments)},[Symbol.iterator](){return new rh(new gs(this))},toJSON(){return{_id:"Micro",op:this[gg],...X in this?{args:this[X]}:void 0}},toString(){return we(this)},[re](){return we(this)}};function LE(e){return Zc("Micro.evaluate: Not implemented")}const Ai=e=>({...PE,[gg]:e.op,[Qc]:e.eval??LE,[hn]:e.contA,[qn]:e.contE,[Lo]:e.ensure}),wn=e=>{const t=Ai(e);return function(){const n=Object.create(t);return n[X]=e.single===!1?arguments:arguments[0],n}},mg=e=>{const t={...Ai(e),[Po]:Po,_tag:e.op,get[e.prop](){return this[X]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[X]}},[C](n){return JE(n)&&n._tag===e.op&&j(this[X],n[X])},[B](){return oe(this,q(fe(e.op))($(this[X])))}};return function(n){const r=Object.create(t);return r[X]=n,r[hn]=void 0,r[qn]=void 0,r[Lo]=void 0,r}},kn=mg({op:"Success",prop:"value",eval(e){const t=e.getCont(hn);return t?t[hn](this[X],e):e.yieldWith(this)}}),ds=mg({op:"Failure",prop:"cause",eval(e){let t=e.getCont(qn);for(;pg(this[X])&&t&&e.interruptible;)t=e.getCont(qn);return t?t[qn](this[X],e):e.yieldWith(this)}}),yf=e=>ds(vE(e)),xE=wn({op:"Suspend",eval(e){return this[X]()}}),jE=wn({op:"Yield",eval(e){let t=!1;return e.getRef(Au).scheduleTask(()=>{t||e.evaluate(_g)},this[X]??0),e.yieldWith(()=>{t=!0})}}),UE=jE(0),DE=kn(void 0),fF=e=>CE(function(t,n){try{e.try(n).then(r=>t(kn(r)),r=>t(yf(e.catch(r))))}catch(r){t(yf(e.catch(r)))}},e.try.length!==0),Ni=wn({op:"WithMicroFiber",eval(e){return this[X](e)}}),CE=wn({op:"Async",single:!1,eval(e){const t=this[X][0];let n=!1,r=!1;const s=this[X][1]?new AbortController:void 0,o=t(i=>{n||(n=!0,r?e.evaluate(i):r=i)},s?.signal);return r!==!1?r:(r=!0,e._yielded=()=>{n=!0},s===void 0&&o===void 0||e._stack.push(BE(()=>(n=!0,s?.abort(),o??_g))),Pn)}}),BE=wn({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(Nu(!0)))},contE(e,t){return pg(e)?fr(this[X](),()=>ds(e)):ds(e)}}),hF=(...e)=>xE(()=>KE(e.length===1?e[0]():e[1].call(e[0]))),KE=wn({op:"Iterator",contA(e,t){const n=this[X].next(e);return n.done?kn(n.value):(t._stack.push(this),oh(n.value))},eval(e){return this[hn](void 0,e)}}),dF=l(2,(e,t)=>fr(e,n=>{const r=df(t)?t:typeof t=="function"?t(n):t;return df(r)?r:kn(r)})),fr=l(2,(e,t)=>{const n=Object.create(qE);return n[X]=e,n[hn]=t,n}),qE=Ai({op:"OnSuccess",eval(e){return e._stack.push(this),this[X]}}),JE=e=>P(e,Po),yg=kn,Fu=ds,Mu=Fu(FE()),Zc=e=>Fu(IE(e)),_g=yg(void 0),VE="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class bg{tasks=[];running=!1;scheduleTask(t,n){this.tasks.push(t),this.running||(this.running=!0,VE(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){const t=this.tasks;this.tasks=[];for(let n=0,r=t.length;n<r;n++)t[n]()}shouldYield(t){return t.currentOpCount>=t.getRef(HE)}flush(){for(;this.tasks.length>0;)this.runTasks()}}const pF=e=>Ni(t=>kn(Da(t.context,e))),zE=l(2,(e,t)=>Ni(n=>{const r=n.context;return n.context=t(r),QE(e,()=>(n.context=r,DE))})),WE=l(2,(e,t)=>zE(e,Os(t)));class HE extends Es()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class Au extends Es()("effect/Micro/currentScheduler",{defaultValue:()=>new bg}){}const GE=l(2,(e,t)=>{const n=Object.create(YE);return n[X]=e,n[hn]=t.onSuccess,n[qn]=t.onFailure,n}),YE=Ai({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[X]}}),QE=l(2,(e,t)=>XE(n=>GE(n(e),{onFailure:r=>fr(t(Fu(r)),()=>ds(r)),onSuccess:r=>fr(t(yg(r)),()=>kn(r))}))),Nu=wn({op:"SetInterruptible",ensure(e){if(e.interruptible=this[X],e._interrupted&&e.interruptible)return()=>Mu}}),ZE=e=>Ni(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(Nu(!1)),t._interrupted?Mu:e)),XE=e=>Ni(t=>t.interruptible?(t.interruptible=!1,t._stack.push(Nu(!0)),e(ZE)):e(z)),e1=(e,t)=>{const n=new AE(Au.context(new bg));return n.evaluate(e),n};class Sg{buckets=[];scheduleTask(t,n){const r=this.buckets.length;let s,o=0;for(;o<r&&this.buckets[o][0]<=n;o++)s=this.buckets[o];s&&s[0]===n?s[1].push(t):o===r?this.buckets.push([n,[t]]):this.buckets.splice(o,0,[n,[t]])}}class t1{maxNextTickBeforeTimer;running=!1;tasks=new Sg;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){const n=this.tasks.buckets;this.tasks.buckets=[];for(const[r,s]of n)for(let o=0;o<s.length;o++)s[o]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(Ap)?t.getFiberRef(Ns):!1}scheduleTask(t,n){this.tasks.scheduleTask(t,n),this.running||(this.running=!0,this.starve())}}const wg=U(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new t1(2048));class kg{tasks=new Sg;deferred=!1;scheduleTask(t,n){this.deferred?wg.scheduleTask(t,n):this.tasks.scheduleTask(t,n)}shouldYield(t){return t.currentOpCount>t.getFiberRef(Ap)?t.getFiberRef(Ns):!1}flush(){for(;this.tasks.buckets.length>0;){const t=this.tasks.buckets;this.tasks.buckets=[];for(const[n,r]of t)for(let s=0;s<r.length;s++)r[s]()}this.deferred=!0}}const Pu=U(Symbol.for("effect/FiberRef/currentScheduler"),()=>Ie(wg)),Tg=U(Symbol.for("effect/FiberRef/currentRequestMap"),()=>Ie(new Map)),_f=(e,t,n,r)=>{switch(e){case void 0:return t();case"unbounded":return n();case"inherit":return Oi(P0,s=>s==="unbounded"?n():s>1?r(s):t());default:return e>1?r(e):t()}},Lu="InterruptSignal",xu="Stateful",ju="Resume",Uu="YieldNow",nc=e=>({_tag:Lu,cause:e}),to=e=>({_tag:xu,onFiber:e}),En=e=>({_tag:ju,effect:e}),n1=()=>({_tag:Uu}),r1="effect/FiberScope",xo=Symbol.for(r1);class s1{[xo]=xo;fiberId=on;roots=new Set;add(t,n){this.roots.add(n),n.addObserver(()=>{this.roots.delete(n)})}}class o1{fiberId;parent;[xo]=xo;constructor(t,n){this.fiberId=t,this.parent=n}add(t,n){this.parent.tell(to(r=>{r.addChild(n),n.addObserver(()=>{r.removeChild(n)})}))}}const i1=e=>new o1(e.id(),e),Pi=U(Symbol.for("effect/FiberScope/Global"),()=>new s1),c1="effect/Fiber",a1=Symbol.for(c1),u1={_E:e=>e,_A:e=>e},l1="effect/Fiber",f1=Symbol.for(l1),Og=e=>$p(_i(e.await),e.inheritAll);({...yr});const Jt="effect/FiberCurrent",h1="effect/Logger",d1=Symbol.for(h1),p1={_Message:e=>e,_Output:e=>e},Ls=e=>({[d1]:p1,log:e,pipe(){return M(this,arguments)}}),g1=/^[^\s"=]*$/,m1=(e,t)=>({annotations:n,cause:r,date:s,fiberId:o,logLevel:i,message:c,spans:a})=>{const u=y=>y.match(g1)?y:e(y),h=(y,E)=>`${Gp(y)}=${u(E)}`,f=(y,E)=>" "+h(y,E);let d=h("timestamp",s.toISOString());d+=f("level",i.label),d+=f("fiber",hi(o));const g=Ia(c);for(let y=0;y<g.length;y++)d+=f("message",Vn(g[y],t));Dk(r)||(d+=f("cause",Bt(r,{renderErrorCause:!0})));for(const y of a)d+=" "+Eu(s.getTime())(y);for(const[y,E]of n)d+=f(y,Vn(E,t));return d},y1=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,_1=Ls(m1(y1)),Eg=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return he(e)}},b1=(e,...t)=>{let n="";for(let r=0;r<t.length;r++)n+=`\x1B[${t[r]}m`;return n+e+"\x1B[0m"},S1=(e,...t)=>e,We={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},w1={None:[],All:[],Trace:[We.gray],Debug:[We.blue],Info:[We.green],Warning:[We.yellow],Error:[We.red],Fatal:[We.bgBrightRed,We.black]},k1={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},T1=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,vg=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null,O1=vg&&process.stdout.isTTY===!0,E1=vg||"Deno"in globalThis,v1=e=>{const t=e?.mode??"auto",r=(t==="auto"?E1?"tty":"browser":t)==="browser",s=typeof e?.colors=="boolean"?e.colors:O1||r,o=e?.formatDate??T1;return r?I1({colors:s,formatDate:o}):$1({colors:s,formatDate:o,stderr:e?.stderr===!0})},$1=e=>{const t=typeof process=="object"&&"isBun"in process&&process.isBun===!0,n=e.colors?b1:S1;return Ls(({annotations:r,cause:s,context:o,date:i,fiberId:c,logLevel:a,message:u,spans:h})=>{const f=Ou(o,Ut),d=Tt(f,Ii).unsafe,g=e.stderr===!0?d.error:d.log,y=Ia(u);let E=n(`[${e.formatDate(i)}]`,We.white)+` ${n(a.label,...w1[a._tag])} (${hi(c)})`;if(Za(h)){const w=i.getTime(),R=Eu(w);for(const m of h)E+=" "+R(m)}E+=":";let b=0;if(y.length>0){const w=Eg(y[0]);typeof w=="string"&&(E+=" "+n(w,We.bold,We.cyan),b++)}if(g(E),t||d.group(),tu(s)||g(Bt(s,{renderErrorCause:!0})),b<y.length)for(;b<y.length;b++)g(es(y[b]));if(Jd(r)>0)for(const[w,R]of r)g(n(`${w}:`,We.bold,We.white),es(R));t||d.groupEnd()})},I1=e=>{const t=e.colors?"%c":"";return Ls(({annotations:n,cause:r,context:s,date:o,fiberId:i,logLevel:c,message:a,spans:u})=>{const h=Ou(s,Ut),f=Tt(h,Ii).unsafe,d=Ia(a);let g=`${t}[${e.formatDate(o)}]`;const y=[];if(e.colors&&y.push("color:gray"),g+=` ${t}${c.label}${t} (${hi(i)})`,e.colors&&y.push(k1[c._tag],""),Za(u)){const b=o.getTime(),w=Eu(b);for(const R of u)g+=" "+w(R)}g+=":";let E=0;if(d.length>0){const b=Eg(d[0]);typeof b=="string"&&(g+=` ${t}${b}`,e.colors&&y.push("color:deepskyblue"),E++)}if(f.groupCollapsed(g,...y),tu(r)||f.error(Bt(r,{renderErrorCause:!0})),E<d.length)for(;E<d.length;E++)f.log(es(d[E]));if(Jd(n)>0)for(const[b,w]of n){const R=es(w);e.colors?f.log(`%c${b}:`,"color:gray",R):f.log(`${b}:`,R)}f.groupEnd()})},R1=U("effect/Logger/prettyLoggerDefault",()=>v1()),$g="effect/MetricBoundaries",Xc=Symbol.for($g);class F1{values;[Xc]=Xc;constructor(t){this.values=t,this._hash=p(fe($g),q(ms(this.values)))}_hash;[B](){return this._hash}[C](t){return M1(t)&&j(this.values,t.values)}pipe(){return M(this,arguments)}}const M1=e=>P(e,Xc),A1=e=>{const t=p(e,$h(Je(Number.POSITIVE_INFINITY)),T_);return new F1(t)},N1=e=>p(n_(e.count-1,t=>e.start*Math.pow(e.factor,t)),vs,A1),P1="effect/MetricKeyType",Ig=Symbol.for(P1),Rg="effect/MetricKeyType/Counter",ea=Symbol.for(Rg),L1="effect/MetricKeyType/Frequency",x1=Symbol.for(L1),j1="effect/MetricKeyType/Gauge",U1=Symbol.for(j1),Fg="effect/MetricKeyType/Histogram",ta=Symbol.for(Fg),D1="effect/MetricKeyType/Summary",C1=Symbol.for(D1),Mg={_In:e=>e,_Out:e=>e};class B1{incremental;bigint;[Ig]=Mg;[ea]=ea;constructor(t,n){this.incremental=t,this.bigint=n,this._hash=fe(Rg)}_hash;[B](){return this._hash}[C](t){return Ag(t)}pipe(){return M(this,arguments)}}class K1{boundaries;[Ig]=Mg;[ta]=ta;constructor(t){this.boundaries=t,this._hash=p(fe(Fg),q($(this.boundaries)))}_hash;[B](){return this._hash}[C](t){return Ng(t)&&j(this.boundaries,t.boundaries)}pipe(){return M(this,arguments)}}const q1=e=>new B1(e?.incremental??!1,e?.bigint??!1),J1=e=>new K1(e),Ag=e=>P(e,ea),V1=e=>P(e,x1),z1=e=>P(e,U1),Ng=e=>P(e,ta),W1=e=>P(e,C1),H1="effect/MetricKey",Pg=Symbol.for(H1),G1={_Type:e=>e},Y1=Ra(j);class Du{name;keyType;description;tags;[Pg]=G1;constructor(t,n,r,s=[]){this.name=t,this.keyType=n,this.description=r,this.tags=s,this._hash=p(fe(this.name+this.description),q($(this.keyType)),q(ms(this.tags)))}_hash;[B](){return this._hash}[C](t){return Q1(t)&&this.name===t.name&&j(this.keyType,t.keyType)&&j(this.description,t.description)&&Y1(this.tags,t.tags)}pipe(){return M(this,arguments)}}const Q1=e=>P(e,Pg),Z1=(e,t)=>new Du(e,q1(t),_s(t?.description)),X1=(e,t,n)=>new Du(e,J1(t),_s(n)),ev=l(2,(e,t)=>t.length===0?e:new Du(e.name,e.keyType,e.description,Qs(e.tags,t))),tv="effect/MetricState",xs=Symbol.for(tv),Lg="effect/MetricState/Counter",na=Symbol.for(Lg),xg="effect/MetricState/Frequency",ra=Symbol.for(xg),jg="effect/MetricState/Gauge",sa=Symbol.for(jg),Ug="effect/MetricState/Histogram",oa=Symbol.for(Ug),Dg="effect/MetricState/Summary",ia=Symbol.for(Dg),js={_A:e=>e};class nv{count;[xs]=js;[na]=na;constructor(t){this.count=t}[B](){return p($(Lg),q($(this.count)),oe(this))}[C](t){return dv(t)&&this.count===t.count}pipe(){return M(this,arguments)}}const rv=Ra(j);class sv{occurrences;[xs]=js;[ra]=ra;constructor(t){this.occurrences=t}_hash;[B](){return p(fe(xg),q(ms(se(this.occurrences.entries()))),oe(this))}[C](t){return pv(t)&&rv(se(this.occurrences.entries()),se(t.occurrences.entries()))}pipe(){return M(this,arguments)}}class ov{value;[xs]=js;[sa]=sa;constructor(t){this.value=t}[B](){return p($(jg),q($(this.value)),oe(this))}[C](t){return gv(t)&&this.value===t.value}pipe(){return M(this,arguments)}}class iv{buckets;count;min;max;sum;[xs]=js;[oa]=oa;constructor(t,n,r,s,o){this.buckets=t,this.count=n,this.min=r,this.max=s,this.sum=o}[B](){return p($(Ug),q($(this.buckets)),q($(this.count)),q($(this.min)),q($(this.max)),q($(this.sum)),oe(this))}[C](t){return mv(t)&&j(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return M(this,arguments)}}class cv{error;quantiles;count;min;max;sum;[xs]=js;[ia]=ia;constructor(t,n,r,s,o,i){this.error=t,this.quantiles=n,this.count=r,this.min=s,this.max=o,this.sum=i}[B](){return p($(Dg),q($(this.error)),q($(this.quantiles)),q($(this.count)),q($(this.min)),q($(this.max)),q($(this.sum)),oe(this))}[C](t){return yv(t)&&this.error===t.error&&j(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return M(this,arguments)}}const av=e=>new nv(e),uv=e=>new sv(e),lv=e=>new ov(e),fv=e=>new iv(e.buckets,e.count,e.min,e.max,e.sum),hv=e=>new cv(e.error,e.quantiles,e.count,e.min,e.max,e.sum),dv=e=>P(e,na),pv=e=>P(e,ra),gv=e=>P(e,sa),mv=e=>P(e,oa),yv=e=>P(e,ia),_v="effect/MetricHook",bv=Symbol.for(_v),Sv={_In:e=>e,_Out:e=>e},Us=e=>({[bv]:Sv,pipe(){return M(this,arguments)},...e}),bf=BigInt(0),wv=e=>{let t=e.keyType.bigint?bf:0;const n=e.keyType.incremental?e.keyType.bigint?s=>s>=bf:s=>s>=0:s=>!0,r=s=>{n(s)&&(t=t+s)};return Us({get:()=>av(t),update:r,modify:r})},kv=e=>{const t=new Map;for(const r of e.keyType.preregisteredWords)t.set(r,0);const n=r=>{const s=t.get(r)??0;t.set(r,s+1)};return Us({get:()=>uv(t),update:n,modify:n})},Tv=(e,t)=>{let n=t;return Us({get:()=>lv(n),update:r=>{n=r},modify:r=>{n=n+r}})},Ov=e=>{const t=e.keyType.boundaries.values,n=t.length,r=new Uint32Array(n+1),s=new Float32Array(n);let o=0,i=0,c=Number.MAX_VALUE,a=Number.MIN_VALUE;p(t,ts(Wn),xn((f,d)=>{s[d]=f}));const u=f=>{let d=0,g=n;for(;d!==g;){const y=Math.floor(d+(g-d)/2),E=s[y];f<=E?g=y:d=y,g===d+1&&(f<=s[d]?g=d:d=g)}r[d]=r[d]+1,o=o+1,i=i+f,f<c&&(c=f),f>a&&(a=f)},h=()=>{const f=Zo(n);let d=0;for(let g=0;g<n;g++){const y=s[g],E=r[g];d=d+E,f[g]=[y,d]}return f};return Us({get:()=>fv({buckets:h(),count:o,min:c,max:a,sum:i}),update:u,modify:u})},Ev=e=>{const{error:t,maxAge:n,maxSize:r,quantiles:s}=e.keyType,o=p(s,ts(Wn)),i=Zo(r);let c=0,a=0,u=0,h=0,f=0;const d=y=>{const E=[];let b=0;for(;b!==r-1;){const w=i[b];if(w!=null){const[R,m]=w,T=vc(y-R);hS(T,Od)&&fS(T,n)&&E.push(m)}b=b+1}return vv(t,o,ts(E,Wn))},g=(y,E)=>{if(r>0){c=c+1;const b=c%r;i[b]=[E,y]}h=a===0?y:Math.min(h,y),f=a===0?y:Math.max(f,y),a=a+1,u=u+y};return Us({get:()=>hv({error:t,quantiles:d(Date.now()),count:a,min:h,max:f,sum:u}),update:([y,E])=>g(y,E),modify:([y,E])=>g(y,E)})},vv=(e,t,n)=>{const r=n.length;if(!ne(t))return tn();const s=t[0],o=t.slice(1),i=Sf(e,r,I(),0,s,n),c=Ze(i);return o.forEach(a=>{c.push(Sf(e,r,i.value,i.consumed,a,i.rest))}),xn(c,a=>[a.quantile,a.value])},Sf=(e,t,n,r,s,o)=>{let i=e,c=t,a=n,u=r,h=s,f=o,d=e,g=t,y=n,E=r,b=s,w=o;for(;;){if(!ne(f))return{quantile:h,value:I(),consumed:u,rest:[]};if(h===1)return{quantile:h,value:A(Fh(f)),consumed:u+f.length,rest:[]};const R=Ne(f),m=d_(f,F=>F===R),T=h*c,O=i/2*T,S=u+m[0].length,_=Math.abs(S-T);if(S<T-O){d=i,g=c,y=Hr(f),E=S,b=h,w=m[1],i=d,c=g,a=y,u=E,h=b,f=w;continue}if(S>T+O){const F=Se(a)?A(R):a;return{quantile:h,value:F,consumed:u,rest:f}}switch(a._tag){case"None":{d=i,g=c,y=Hr(f),E=S,b=h,w=m[1],i=d,c=g,a=y,u=E,h=b,f=w;continue}case"Some":{const F=Math.abs(T-a.value);if(_<F){d=i,g=c,y=Hr(f),E=S,b=h,w=m[1],i=d,c=g,a=y,u=E,h=b,f=w;continue}return{quantile:h,value:A(a.value),consumed:u,rest:f}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},$v="effect/MetricPair",Iv=Symbol.for($v),Rv={_Type:e=>e},Fv=(e,t)=>({[Iv]:Rv,metricKey:e,metricState:t,pipe(){return M(this,arguments)}}),Mv="effect/MetricRegistry",wf=Symbol.for(Mv);class Av{[wf]=wf;map=pT();snapshot(){const t=[];for(const[n,r]of this.map)t.push(Fv(n,r.get()));return t}get(t){const n=p(this.map,zt(t),it);if(n==null){if(Ag(t.keyType))return this.getCounter(t);if(z1(t.keyType))return this.getGauge(t);if(V1(t.keyType))return this.getFrequency(t);if(Ng(t.keyType))return this.getHistogram(t);if(W1(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return n}getCounter(t){let n=p(this.map,zt(t),it);if(n==null){const r=wv(t);p(this.map,Nr(t))||p(this.map,Pr(t,r)),n=r}return n}getFrequency(t){let n=p(this.map,zt(t),it);if(n==null){const r=kv(t);p(this.map,Nr(t))||p(this.map,Pr(t,r)),n=r}return n}getGauge(t){let n=p(this.map,zt(t),it);if(n==null){const r=Tv(t,t.keyType.bigint?BigInt(0):0);p(this.map,Nr(t))||p(this.map,Pr(t,r)),n=r}return n}getHistogram(t){let n=p(this.map,zt(t),it);if(n==null){const r=Ov(t);p(this.map,Nr(t))||p(this.map,Pr(t,r)),n=r}return n}getSummary(t){let n=p(this.map,zt(t),it);if(n==null){const r=Ev(t);p(this.map,Nr(t))||p(this.map,Pr(t,r)),n=r}return n}}const Nv=()=>new Av,Pv="effect/Metric",Lv=Symbol.for(Pv),xv={_Type:e=>e,_In:e=>e,_Out:e=>e},kf=U(Symbol.for("effect/Metric/globalMetricRegistry"),()=>Nv()),Cg=function(e,t,n,r){const s=Object.assign(o=>wi(o,i=>Cv(s,i)),{[Lv]:xv,keyType:e,unsafeUpdate:t,unsafeValue:n,unsafeModify:r,register(){return this.unsafeValue([]),this},pipe(){return M(this,arguments)}});return s},Li=(e,t)=>Bg(Z1(e,t)),Bg=e=>{let t;const n=new WeakMap,r=s=>{if(s.length===0)return t!==void 0||(t=kf.get(e)),t;let o=n.get(s);return o!==void 0||(o=kf.get(ev(e,s)),n.set(s,o)),o};return Cg(e.keyType,(s,o)=>r(o).update(s),s=>r(s).get(),(s,o)=>r(o).modify(s))},jv=(e,t,n)=>Bg(X1(e,t,n)),Uv=l(3,(e,t,n)=>Dv(e,[KO(t,n)])),Dv=l(2,(e,t)=>Cg(e.keyType,(n,r)=>e.unsafeUpdate(n,Qs(t,r)),n=>e.unsafeValue(Qs(t,n)),(n,r)=>e.unsafeModify(n,Qs(t,r)))),Cv=l(2,(e,t)=>Oi(Dc,n=>v(()=>e.unsafeUpdate(t,n))));({...Ea});const Bv=l(2,(e,t)=>Oi(Tg,n=>v(()=>{if(n.has(e)){const r=n.get(e);r.state.completed||(r.state.completed=!0,Lp(r.result,t))}}))),Kv="effect/Supervisor",xi=Symbol.for(Kv),Cu={_T:e=>e};class ji{underlying;value0;[xi]=Cu;constructor(t,n){this.underlying=t,this.value0=n}get value(){return this.value0}onStart(t,n,r,s){this.underlying.onStart(t,n,r,s)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new ji(this,p(this.value,Y(t)))}zip(t){return new Ui(this,t)}}class Ui{left;right;_tag="Zip";[xi]=Cu;constructor(t,n){this.left=t,this.right=n}get value(){return vp(this.left.value,this.right.value)}onStart(t,n,r,s){this.left.onStart(t,n,r,s),this.right.onStart(t,n,r,s)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new ji(this,p(this.value,Y(t)))}zip(t){return new Ui(this,t)}}const Kg=e=>P(e,xi)&&th(e,"Zip");class qv{effect;[xi]=Cu;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,n,r,s){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new ji(this,p(this.value,Y(t)))}zip(t){return new Ui(this,t)}onRun(t,n){return t()}}const Jv=e=>new qv(e),Di=U("effect/Supervisor/none",()=>Jv(ue)),Vv=br,qg="Empty",Jg="AddSupervisor",Vg="RemoveSupervisor",zg="AndThen",Zr={_tag:qg},no=(e,t)=>({_tag:zg,first:e,second:t}),zv=(e,t)=>Wv(t,Je(e)),Wv=(e,t)=>{let n=e,r=t;for(;Zn(r);){const s=Xn(r);switch(s._tag){case qg:{r=Ht(r);break}case Jg:{n=n.zip(s.supervisor),r=Ht(r);break}case Vg:{n=ca(n,s.supervisor),r=Ht(r);break}case zg:{r=nt(s.first)(nt(s.second)(Ht(r)));break}}}return n},ca=(e,t)=>j(e,t)?Di:Kg(e)?ca(e.left,t).zip(ca(e.right,t)):e,jo=e=>j(e,Di)?rn():Kg(e)?p(jo(e.left),is(jo(e.right))):Ha(e),Hv=(e,t)=>{if(j(e,t))return Zr;const n=jo(e),r=jo(t),s=p(r,vl(n),ko(Zr,(i,c)=>no(i,{_tag:Jg,supervisor:c}))),o=p(n,vl(r),ko(Zr,(i,c)=>no(i,{_tag:Vg,supervisor:c})));return no(s,o)},Gv=Vv({empty:Zr,patch:zv,combine:no,diff:Hv}),Yv=Li("effect_fiber_started",{incremental:!0}),Tf=Li("effect_fiber_active"),Qv=Li("effect_fiber_successes",{incremental:!0}),Zv=Li("effect_fiber_failures",{incremental:!0}),Xv=Uv(jv("effect_fiber_lifetimes",N1({start:.5,factor:2,count:35})),"time_unit","milliseconds"),Lr="Continue",e$="Done",Of="Yield",t$={_E:e=>e,_A:e=>e},Vs=e=>{throw new Error(`BUG: FiberRuntime - ${Vn(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},mt=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),yt=U("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),xr={[fo]:(e,t,n)=>ve(()=>t.effect_instruction_i1(n)),OnStep:(e,t,n)=>te(te(n)),[ho]:(e,t,n)=>ve(()=>t.effect_instruction_i2(n)),[Oa]:(e,t,n)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),At(e.currentRuntimeFlags)&&e.isInterrupted()?H(e.getInterruptedCause()):te(n)),[po]:(e,t,n)=>(ve(()=>t.effect_instruction_i2(n)),ve(()=>t.effect_instruction_i0())?(e.pushStack(t),ve(()=>t.effect_instruction_i1())):ue),[zr]:(e,t,n)=>{const r=ve(()=>t.effect_instruction_i0.next(n));return r.done?te(r.value):(e.pushStack(t),oh(r.value))}},n$={[Lu]:(e,t,n,r)=>(e.processNewInterruptSignal(r.cause),At(t)?H(r.cause):n),[ju]:(e,t,n,r)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[xu]:(e,t,n,r)=>(r.onFiber(e,hg(t)),n),[Uu]:(e,t,n,r)=>k(ki(),()=>n)},r$=e=>bi(Tk(e),t=>Xt(jk(t),([n,r])=>{const s=new Map,o=[];for(const c of r){o.push(Ot(c));for(const a of c)s.set(a.request,a)}const i=o.flat();return Ei(k$(n.runAll(o),i,()=>i.forEach(c=>{c.listeners.interrupted=!0})),Tg,s)},!1,!1)),s$=Wo();class Wg extends vu{[a1]=u1;[f1]=t$;_fiberRefs;_fiberId;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(t,n,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=t,this._fiberRefs=n,Ml(r)){const s=this.getFiberRef(Dc);Yv.unsafeUpdate(1,s),Tf.unsafeUpdate(1,s)}this.refreshRefCache()}commit(){return Og(this)}id(){return this._fiberId}resume(t){this.tell(En(t))}get status(){return this.ask((t,n)=>n)}get runtimeFlags(){return this.ask((t,n)=>TE(n)?t.currentRuntimeFlags:n.runtimeFlags)}scope(){return i1(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(Js)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return G(()=>{const n=Pp(this._fiberId);return this.tell(to((r,s)=>{Lp(n,v(()=>t(r,s)))})),_u(n)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return un(t=>{const n=r=>t(x(r));return this.tell(to((r,s)=>{r._exitValue!==null?n(this._exitValue):r.addObserver(n)})),v(()=>this.tell(to((r,s)=>{r.removeObserver(n)})))},this.id())}get inheritAll(){return Z((t,n)=>{const r=t.id(),s=t.getFiberRefs(),o=n.runtimeFlags,i=this.getFiberRefs(),c=SO(s,r,i);t.setFiberRefs(c);const a=t.getFiberRef(If),u=p(Yr(o,a),Nl(yn),Nl(xc));return h0(u)})}get poll(){return v(()=>_s(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return v(()=>this.tell(nc(bt(t))))}unsafeInterruptAsFork(t){this.tell(nc(bt(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(n=>n!==t)}getFiberRefs(){return this.setFiberRef(If,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=zp(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,n){this._fiberRefs=qc(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:n}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(Ut),this.currentTracer=this.currentDefaultServices.unsafeMap.get(Tu.key),this.currentSupervisor=this.getFiberRef(w$),this.currentScheduler=this.getFiberRef(Pu),this.currentContext=this.getFiberRef(Sn),this.currentSpan=this.currentContext.unsafeMap.get(Ri.key)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}transferChildren(t){const n=this._children;if(this._children=null,n!==null&&n.size>0)for(const r of n)r._exitValue===null&&t.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let n=Lr;const r=globalThis[Jt];globalThis[Jt]=this;try{for(;n===Lr;)n=this._queue.length===0?e$:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Jt]=r}this._queue.length>0&&!this._running?(this._running=!0,n===Of?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(Ns))}drainQueueWhileRunning(t,n){let r=n;for(;this._queue.length>0;){const s=this._queue.splice(0,1)[0];r=n$[s._tag](this,t,r,s)}return r}isInterrupted(){return!tu(this.getFiberRef(Js))}addInterruptedCause(t){const n=this.getFiberRef(Js);this.setFiberRef(Js,Ae(n,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(const n of this._children)n.tell(nc(bt(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const t=this._children.values();this._children=null;let n=!1;return fu({while:()=>!n,body:()=>{const s=t.next();return s.done?v(()=>{n=!0}):Kt(s.value.await)},step:()=>{}})}return null}reportExitValue(t){if(Ml(this.currentRuntimeFlags)){const n=this.getFiberRef(Dc),r=this.id().startTimeMillis,s=Date.now();switch(Xv.unsafeUpdate(s-r,n),Tf.unsafeUpdate(-1,n),t._tag){case Fe:{Qv.unsafeUpdate(1,n);break}case Re:{Zv.unsafeUpdate(1,n);break}}}if(t._tag==="Failure"){const n=this.getFiberRef(x0);!nu(t.cause)&&n._tag==="Some"&&this.log("Fiber terminated with an unhandled error",t.cause,n)}}setExitValue(t){this._exitValue=t,this.reportExitValue(t);for(let n=this._observers.length-1;n>=0;n--)this._observers[n](t);this._observers=[]}getLoggers(){return this.getFiberRef(Bu)}log(t,n,r){const s=$e(r)?r.value:this.getFiberRef(M0),o=this.getFiberRef(o$);if(NO(o,s))return;const i=this.getFiberRef(A0),c=this.getFiberRef(F0),a=this.getLoggers(),u=this.getFiberRefs();if(Ud(a)>0){const h=Tt(this.getFiberRef(Ut),Or),f=new Date(h.unsafeCurrentTimeMillis());Oy(u,()=>{for(const d of a)d.log({fiberId:this.id(),logLevel:s,message:t,cause:n,context:u,spans:i,annotations:c,date:f})})}}evaluateMessageWhileSuspended(t){switch(t._tag){case Uu:return Of;case Lu:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(H(t.cause)),this._asyncInterruptor=null),Lr;case ju:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Lr;case xu:return t.onFiber(this,this._exitValue!==null?wE:kE(this.currentRuntimeFlags,this._asyncBlockingOn)),Lr;default:return Vs(t)}}evaluateEffect(t){this.currentSupervisor.onResume(this);try{let n=At(this.currentRuntimeFlags)&&this.isInterrupted()?H(this.getInterruptedCause()):t;for(;n!==null;){const r=n,s=this.runLoop(r);if(s===mt){const o=yt.currentOp;yt.currentOp=null,o._op===Gs?yk(this.currentRuntimeFlags)?(this.tell(n1()),this.tell(En(Be)),n=null):n=Be:o._op===Vr&&(n=null)}else{this.currentRuntimeFlags=p(this.currentRuntimeFlags,bk(xc));const o=this.interruptAllChildren();o!==null?n=k(o,()=>s):(this._queue.length===0?this.setExitValue(s):this.tell(En(s)),n=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(t){if(this._running)this.tell(En(t));else{this._running=!0;const n=globalThis[Jt];globalThis[Jt]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Jt]=n,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(En(t))}patchRuntimeFlags(t,n){const r=eo(t,n);return globalThis[Jt]=this,this.currentRuntimeFlags=r,r}initiateAsync(t,n){let r=!1;const s=o=>{r||(r=!0,this.tell(En(o)))};At(t)&&(this._asyncInterruptor=s);try{n(s)}catch(o){s(ke(Ge(o)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){const t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==qi)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==fo&&t._op!==po&&t._op!==zr)return t;t=this.popStack()}}[Ey](t){return v(()=>Da(this.currentContext,t))}Left(t){return le(t.left)}None(t){return le(new gu)}Right(t){return te(t.right)}Some(t){return te(t.value)}Micro(t){return fs(n=>{let r=n;const s=e1(WE(t,this.currentContext));return s.addObserver(o=>{if(o._tag==="Success")return r(te(o.value));switch(o.cause._tag){case"Interrupt":return r(H(bt(on)));case"Fail":return r(le(o.cause.error));case"Die":return r($o(o.cause.defect))}}),fs(o=>{r=i=>{o(ue)},s.unsafeInterrupt()})})}[lh](t){const n=ve(()=>t.effect_instruction_i0()),r=this.getNextSuccessCont();return r!==void 0?(r._op in xr||Vs(r),xr[r._op](this,r,n)):(yt.currentOp=te(n),mt)}[Fe](t){const n=t,r=this.getNextSuccessCont();return r!==void 0?(r._op in xr||Vs(r),xr[r._op](this,r,n.effect_instruction_i0)):(yt.currentOp=n,mt)}[Re](t){const n=t.effect_instruction_i0,r=this.getNextFailCont();if(r!==void 0)switch(r._op){case qi:case ho:return At(this.currentRuntimeFlags)&&this.isInterrupted()?H(Pl(n)):ve(()=>r.effect_instruction_i1(n));case"OnStep":return At(this.currentRuntimeFlags)&&this.isInterrupted()?H(Pl(n)):te(H(n));case Oa:return this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),At(this.currentRuntimeFlags)&&this.isInterrupted()?H(Ae(n,this.getInterruptedCause())):H(n);default:Vs(r)}else return yt.currentOp=H(n),mt}[fh](t){return ve(()=>t.effect_instruction_i0(this,hg(this.currentRuntimeFlags)))}Blocked(t){const n=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){const s=[],o=this._steps[this._steps.length-1];let i=this.popStack();for(;i&&i._op!=="OnStep";)s.push(i),i=this.popStack();this.setFiberRefs(o.refs),this.currentRuntimeFlags=o.flags;const c=Gc(o.refs,n),a=Yr(o.flags,r);return te(mp(t.effect_instruction_i0,Z(u=>{for(;s.length>0;)u.pushStack(s.pop());return u.setFiberRefs(Yc(u.id(),u.getFiberRefs())(c)),u.currentRuntimeFlags=eo(a)(u.currentRuntimeFlags),t.effect_instruction_i1})))}return jt(s=>k(Zg(o0(t.effect_instruction_i0)),()=>s(t.effect_instruction_i1)))}RunBlocked(t){return r$(t.effect_instruction_i0)}[mr](t){const n=t.effect_instruction_i0,r=this.currentRuntimeFlags,s=eo(r,n);if(At(s)&&this.isInterrupted())return H(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,n),t.effect_instruction_i1){const o=Yr(s,r);return this.pushStack(new i0(o,t)),ve(()=>t.effect_instruction_i1(r))}else return Be}[fo](t){return this.pushStack(t),t.effect_instruction_i0}OnStep(t){return this.pushStack(t),t.effect_instruction_i0}[qi](t){return this.pushStack(t),t.effect_instruction_i0}[ho](t){return this.pushStack(t),t.effect_instruction_i0}[Vr](t){return this._asyncBlockingOn=t.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,t.effect_instruction_i0),yt.currentOp=t,mt}[Gs](t){return this._isYielding=!1,yt.currentOp=t,mt}[po](t){const n=t.effect_instruction_i0,r=t.effect_instruction_i1;return n()?(this.pushStack(t),r()):Be}[zr](t){return xr[zr](this,t,void 0)}[Qo](t){return ve(()=>t.commit())}runLoop(t){let n=t;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&mk)!==0&&this.currentSupervisor.onEffect(this,n),this._queue.length>0&&(n=this.drainQueueWhileRunning(this.currentRuntimeFlags,n)),!this._isYielding){this.currentOpCount+=1;const r=this.currentScheduler.shouldYield(this);if(r!==!1){this._isYielding=!0,this.currentOpCount=0;const s=n;n=k(ki({priority:r}),()=>s)}}try{if(n=this.currentTracer.context(()=>s$!==n[ar]._V?Ul(`Cannot execute an Effect versioned ${n[ar]._V} with a Runtime of version ${Wo()}`):this[n._op](n),this),n===mt){const r=yt.currentOp;return r._op===Gs||r._op===Vr?mt:(yt.currentOp=null,r._op===Fe||r._op===Re?r:H(Ge(r)))}}catch(r){n!==mt&&!P(n,"_op")||!(n._op in this)?n=Ul(`Not a valid effect: ${Vn(n)}`):q0(r)?n=H(Ae(Ge(r),bt(on))):n=$o(r)}}}run=()=>{this.drainQueueOnCurrentThread()}}const o$=U("effect/FiberRef/currentMinimumLogLevel",()=>Ie(PO("Info"))),i$=e=>Ls(t=>{const n=Ou(t.context,Ut);Tt(n,Ii).unsafe.log(e.log(t))}),Hg=U(Symbol.for("effect/Logger/defaultLogger"),()=>i$(_1)),c$=U(Symbol.for("effect/Logger/prettyLogger"),()=>R1),a$=U(Symbol.for("effect/Logger/tracerLogger"),()=>Ls(({annotations:e,cause:t,context:n,fiberId:r,logLevel:s,message:o})=>{const i=mn(hs(n,Sn),Ri);if(i._tag==="None"||i.value._tag==="ExternalSpan")return;const c=Da(hs(n,Ut),Or),a={};for(const[u,h]of e)a[u]=h;a["effect.fiberId"]=rw(r),a["effect.logLevel"]=s.label,t!==null&&t._tag!=="Empty"&&(a["effect.cause"]=Bt(t,{renderErrorCause:!0})),i.value.event(Vn(Array.isArray(o)?o[0]:o),c.unsafeCurrentTimeNanos(),a)})),Bu=U(Symbol.for("effect/FiberRef/currentLoggers"),()=>$0(Ha(Hg,a$))),u$=l(e=>bn(e[0]),(e,t)=>lu(wi(e,n=>Gg(r=>t(n,r))))),Gg=e=>Z(t=>{const n=t.getFiberRefs(),r=_k(t.currentRuntimeFlags,yn);return k(m$,s=>Bc(s,o=>Z(i=>{const c=i.getFiberRefs(),a=i.currentRuntimeFlags,u=Gc(c,n),h=Yr(a,r),f=Gc(n,c);return i.setFiberRefs(Yc(u,i.id(),n)),ua(g0(e(o),h),v(()=>{i.setFiberRefs(Yc(f,i.id(),i.getFiberRefs()))}))})))}),l$=e=>{if(Array.isArray(e)||ba(e))return[e,I()];const t=Object.keys(e),n=t.length;return[t.map(r=>e[r]),A(r=>{const s={};for(let o=0;o<n;o++)s[t[o]]=r[o];return s})]},f$=(e,t,n)=>{const r=[];for(const s of e)r.push(ur(s));return k(hr(r,z,{concurrency:n?.concurrency,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),s=>{const o=I(),i=s.length,c=new Array(i),a=new Array(i);let u=!1;for(let h=0;h<i;h++){const f=s[h];f._tag==="Left"?(c[h]=A(f.left),u=!0):(a[h]=f.right,c[h]=o)}return u?t._tag==="Some"?le(t.value(c)):le(c):n?.discard?ue:t._tag==="Some"?x(t.value(a)):x(a)})},h$=(e,t,n)=>{const r=[];for(const s of e)r.push(ur(s));return n?.discard?hr(r,z,{concurrency:n?.concurrency,batching:n?.batching,discard:!0,concurrentFinalizers:n?.concurrentFinalizers}):Y(hr(r,z,{concurrency:n?.concurrency,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),s=>t._tag==="Some"?t.value(s):s)},Yg=(e,t)=>{const[n,r]=l$(e);return t?.mode==="validate"?f$(n,r,t):t?.mode==="either"?h$(n,r,t):t?.discard!==!0&&r._tag==="Some"?Y(hr(n,z,t),r.value):hr(n,z,t)},hr=l(e=>ba(e[0]),(e,t,n)=>Z(r=>{const s=n?.batching===!0||n?.batching==="inherit"&&r.getFiberRef(L0);return n?.discard?_f(n.concurrency,()=>vn(zc,n?.concurrentFinalizers)(o=>s?Xt(e,(i,c)=>o(t(i,c)),!0,!1,1):bi(e,(i,c)=>o(t(i,c)))),()=>vn(Wc,n?.concurrentFinalizers)(o=>Xt(e,(i,c)=>o(t(i,c)),s,!1)),o=>vn(Hc(o),n?.concurrentFinalizers)(i=>Xt(e,(c,a)=>i(t(c,a)),s,!1,o))):_f(n?.concurrency,()=>vn(zc,n?.concurrentFinalizers)(o=>s?aa(e,1,(i,c)=>o(t(i,c)),!0):St(e,(i,c)=>o(t(i,c)))),()=>vn(Wc,n?.concurrentFinalizers)(o=>Qg(e,(i,c)=>o(t(i,c)),s)),o=>vn(Hc(o),n?.concurrentFinalizers)(i=>aa(e,o,(c,a)=>i(t(c,a)),s)))})),Qg=(e,t,n)=>G(()=>{const r=se(e),s=new Array(r.length);return at(Xt(r,(i,c)=>k(t(i,c),a=>v(()=>s[c]=a)),n,!1),x(s))}),Xt=(e,t,n,r,s)=>jt(o=>f0(i=>Z(c=>{let a=Array.from(e).reverse(),u=a.length;if(u===0)return ue;let h=0,f=!1;const d=s?Math.min(a.length,s):a.length,g=new Set,y=new Array,E=()=>g.forEach(F=>{F.currentScheduler.scheduleTask(()=>{F.unsafeInterruptAsFork(c.id())},0)}),b=new Array,w=new Array,R=new Array,m=()=>{const F=y.filter(({exit:J})=>J._tag==="Failure").sort((J,V)=>J.index<V.index?-1:J.index===V.index?0:1).map(({exit:J})=>J);return F.length===0&&F.push(Be),F},T=(F,J=!1)=>{const V=lu(i(F)),D=d$(V,c,c.currentRuntimeFlags,Pi);return c.currentScheduler.scheduleTask(()=>{J&&D.unsafeInterruptAsFork(c.id()),D.resume(V)},0),D},O=()=>{r||(u-=a.length,a=[]),f=!0,E()},S=n?u0:Kn,_=T(un(F=>{const J=(D,Q)=>{D._op==="Blocked"?R.push(D):(y.push({index:Q,exit:D}),D._op==="Failure"&&!f&&O())},V=()=>{if(a.length>0){const D=a.pop();let Q=h++;const Te=()=>{const ee=a.pop();return Q=h++,k(ki(),()=>k(S(o(t(ee,Q))),N))},N=ee=>a.length>0&&(J(ee,Q),a.length>0)?Te():x(ee),W=k(S(o(t(D,Q))),N),pe=T(W);b.push(pe),g.add(pe),f&&pe.currentScheduler.scheduleTask(()=>{pe.unsafeInterruptAsFork(c.id())},0),pe.addObserver(ee=>{let gt;if(ee._op==="Failure"?gt=ee:gt=ee.effect_instruction_i0,w.push(pe),g.delete(pe),J(gt,Q),y.length===u)F(x(ae(Qr(m(),{parallel:!0}),()=>Be)));else if(R.length+y.length===u){const Rr=m(),Ym=R.map(Fr=>Fr.effect_instruction_i0).reduce(sp);F(x(mp(Ym,Xt([ae(Qr(Rr,{parallel:!0}),()=>Be),...R.map(Fr=>Fr.effect_instruction_i1)],Fr=>Fr,n,!0,s))))}else V()})}};for(let D=0;D<d;D++)V()}));return Kt(lr(_i(o(Og(_))),yu({onFailure:F=>{O();const J=R.length+1,V=Math.min(typeof s=="number"?s:R.length,R.length),D=Array.from(R);return un(Q=>{let Te=0,N=0;const W=(ee,gt)=>Rr=>{Te++,Te===J&&Q(te(H(F))),D.length>0&&gt&&pe()},pe=()=>{T(D.pop(),!0).addObserver(W(N,!0)),N++};_.addObserver(W(N,!1)),N++;for(let ee=0;ee<V;ee++)pe()})},onSuccess:()=>St(w,F=>F.inheritAll)})))}))),aa=(e,t,n,r)=>G(()=>{const s=se(e),o=new Array(s.length);return at(Xt(s,(c,a)=>Y(n(c,a),u=>o[a]=u),r,!1,t),x(o))}),Zg=e=>p$(e,Pi),Xg=(e,t,n,r=null)=>{const s=em(e,t,n,r);return s.resume(e),s},d$=(e,t,n,r=null)=>em(e,t,n,r),em=(e,t,n,r=null)=>{const s=Cd(),o=t.getFiberRefs(),i=wO(o,s),c=new Wg(s,i,n),a=hs(i,Sn),u=c.currentSupervisor;return u.onStart(a,e,A(t),c),c.addObserver(f=>u.onEnd(f,c)),(r!==null?r:p(t.getFiberRef(Cc),ae(()=>t.scope()))).add(n,c),c},p$=(e,t)=>Z((n,r)=>x(Xg(e,n,r.runtimeFlags,t))),Ef=e=>Tr(t=>qe(mn(t,qt),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return k(vi(n,Wc),r=>Ds(e,r))}}})),vf=e=>t=>Tr(n=>qe(mn(n,qt),{onNone:()=>t,onSome:r=>r.strategy._tag==="ParallelN"&&r.strategy.parallelism===e?t:k(vi(r,Hc(e)),s=>Ds(t,s))})),vn=(e,t)=>n=>Tr(r=>qe(mn(r,qt),{onNone:()=>n(z),onSome:s=>{if(t===!0){const o=e._tag==="Parallel"?Ef:e._tag==="Sequential"?$f:vf(e.parallelism);switch(s.strategy._tag){case"Parallel":return o(n(Ef));case"Sequential":return o(n($f));case"ParallelN":return o(n(vf(s.strategy.parallelism)))}}else return n(z)}})),tm=e=>k(qt,e),$f=e=>Tr(t=>qe(mn(t,qt),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return k(vi(n,zc),r=>Ds(e,r))}}})),g$=l(e=>bn(e[1]),(e,t,n,r)=>Y(Yg([e,t],{concurrency:r?.concurrent?2:1,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),([s,o])=>n(s,o))),qt=gn("effect/Scope"),m$=qt,y$=(e,t)=>{e.state._tag==="Open"&&e.state.finalizers.set({},t)},_$={[Dl]:Dl,[Cl]:Cl,pipe(){return M(this,arguments)},fork(e){return v(()=>{const t=nm(e);if(this.state._tag==="Closed")return t.state=this.state,t;const n={},r=s=>t.close(s);return this.state.finalizers.set(n,r),y$(t,s=>v(()=>{this.state._tag==="Open"&&this.state.finalizers.delete(n)})),t})},close(e){return G(()=>{if(this.state._tag==="Closed")return ue;const t=Array.from(this.state.finalizers.values()).reverse();return this.state={_tag:"Closed",exit:e},t.length===0?ue:fE(this.strategy)?p(St(t,n=>Kn(n(e))),k(n=>p(Qr(n),Wr(Zi),ae(()=>Be)))):hE(this.strategy)?p(Qg(t,n=>Kn(n(e)),!1),k(n=>p(Qr(n,{parallel:!0}),Wr(Zi),ae(()=>Be)))):p(aa(t,this.strategy.parallelism,n=>Kn(n(e)),!1),k(n=>p(Qr(n,{parallel:!0}),Wr(Zi),ae(()=>Be))))})},addFinalizer(e){return G(()=>this.state._tag==="Closed"?e(this.state.exit):(this.state.finalizers.set({},e),ue))}},nm=(e=Fi)=>{const t=Object.create(_$);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},Ku=(e=Fi)=>v(()=>nm(e)),Ds=l(2,(e,t)=>cT(e,Os(Ts(qt,t)))),b$=e=>kr(e,{differ:Gv,fork:Zr}),S$=l(2,(e,t)=>Kt(u$(k(Ti(e),n=>rt(Io(e,t),n)),n=>Io(e,n)))),rm=l(2,(e,t)=>Oi(e,n=>S$(e,t(n)))),If=R0(Sk),w$=b$(Di),ua=l(2,(e,t)=>jt(n=>$t(n(e),{onFailure:r=>$t(t,{onFailure:s=>ke(Ae(r,s)),onSuccess:()=>ke(r)}),onSuccess:r=>rt(t,r)}))),k$=(e,t,n)=>au(r=>k(k(Zg(kp(e)),s=>un(o=>{const i=t.map(u=>u.listeners.count),c=()=>{i.every(u=>u===0)&&t.every(u=>u.result.state.current._tag==="Pending"?!0:!!(u.result.state.current._tag==="Done"&&mu(u.result.state.current.effect)&&u.result.state.current.effect._tag==="Failure"&&Bk(u.result.state.current.effect.cause)))&&(a.forEach(u=>u()),n?.(),o(Ip(s)))};s.addObserver(u=>{a.forEach(h=>h()),o(u)});const a=t.map((u,h)=>{const f=d=>{i[h]=d,c()};return u.listeners.addObserver(f),()=>u.listeners.removeObserver(f)});return c(),v(()=>{a.forEach(u=>u())})})),()=>G(()=>{const s=t.flatMap(o=>o.state.completed?[]:[o]);return bi(s,o=>Bv(o.request,Q0(r)))}))),T$=ls,O$=Ck,E$=lp,gF=J0,v$=Bt,mF=qt,sm=Kc,$$=Ds,I$=vi,yF=Ku;class R${permits;waiters=new Set;taken=0;constructor(t){this.permits=t}get free(){return this.permits-this.taken}take=t=>Sp(n=>{if(this.free<t){const r=()=>{this.free<t||(this.waiters.delete(r),this.taken+=t,n(x(t)))};return this.waiters.add(r),v(()=>{this.waiters.delete(r)})}return this.taken+=t,n(x(t))});updateTaken=t=>Z(n=>(this.taken=t(this.taken),this.waiters.size>0&&n.getFiberRef(Pu).scheduleTask(()=>{const r=this.waiters.values();let s=r.next();for(;s.done===!1&&this.free>0;)s.value(),s=r.next()},n.getFiberRef(Ns)),x(this.free)));release=t=>this.updateTaken(n=>n-t);releaseAll=this.updateTaken(t=>0);withPermits=t=>n=>jt(r=>k(r(this.take(t)),s=>ua(r(n),this.release(s))));withPermitsIfAvailable=t=>n=>jt(r=>G(()=>this.free<t?XO:(this.taken+=t,ua(r(JO(n)),this.release(t)))))}const F$=e=>new R$(e),M$=l(2,(e,t)=>Z((n,r)=>{const s=t,o=Xg(e,n,r.runtimeFlags,Pi);if(s.state._tag==="Open"){const i=()=>au(a=>j(a,o.id())?ue:Kt(Ip(o))),c={};s.state.finalizers.set(c,i),o.addObserver(()=>{s.state._tag!=="Closed"&&s.state.finalizers.delete(c)})}else o.unsafeInterruptAsFork(n.id());return x(o)})),A$="effect/Ref/SynchronizedRef",N$=Symbol.for(A$),P$={_A:e=>e};class L$ extends vu{ref;withLock;[N$]=P$;[Yp]=Qp;[Mo]=Mo;constructor(t,n){super(),this.ref=t,this.withLock=n,this.get=Ao(this.ref)}get;commit(){return this.get}modify(t){return this.modifyEffect(n=>x(t(n)))}modifyEffect(t){return this.withLock(p(k(Ao(this.ref),t),k(([n,r])=>rt(Xp(this.ref,r),n))))}}const x$=e=>v(()=>om(e)),om=e=>{const t=Zp(e),n=F$(1);return new L$(t,n.withPermits(1))},Rf=Symbol.for("effect/ManagedRuntime"),j$="Fold",U$="Fresh",D$="FromEffect",C$="Scoped",B$="Suspend",K$="Provide",im="ProvideMerge",q$="ZipWith",J$=hu,vr=e=>function(){if(arguments.length===1){const t=arguments[0];return(n,...r)=>e(t,n,...r)}return e.apply(this,arguments)},Cs=vr((e,t,n)=>{const r=Cd(),s=[[Sn,[[r,e.context]]]];n?.scheduler&&s.push([Pu,[[r,n.scheduler]]]);let o=TO(e.fiberRefs,{entries:s,forkAs:r});n?.updateRefs&&(o=n.updateRefs(o,r));const i=new Wg(r,o,e.runtimeFlags);let c=t;n?.scope&&(c=k(I$(n.scope,Fi),u=>at(C0(u,au(h=>j(h,i.id())?ue:hu(i,h))),lr(t,h=>sm(u,h)))));const a=i.currentSupervisor;return a!==Di&&(a.onStart(e.context,c,I(),i),i.addObserver(u=>a.onEnd(u,i))),Pi.add(e.runtimeFlags,i),n?.immediate===!1?i.resume(c):i.start(c),i}),la=vr((e,t,n={})=>{const r=Cs(e,t,n);return n.onExit&&r.addObserver(s=>{n.onExit(s)}),(s,o)=>la(e)(p(r,J$(s??on)),{...o,onExit:o?.onExit?i=>o.onExit(fT(i)):void 0})}),cm=vr((e,t)=>{const n=qu(e)(t);if(n._tag==="Failure")throw am(n.effect_instruction_i0);return n.effect_instruction_i0});class V$ extends Error{fiber;_tag="AsyncFiberException";constructor(t){super(`Fiber #${t.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=t,this.name=this._tag,this.stack=this.message}}const z$=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new V$(e);return Error.stackTraceLimit=t,n},rc=Symbol.for("effect/Runtime/FiberFailure"),zs=Symbol.for("effect/Runtime/FiberFailure/Cause");class W$ extends Error{[rc];[zs];constructor(t){const n=pp(t)[0];super(n?.message||"An error has occurred"),this[rc]=rc,this[zs]=t,this.name=n?`(FiberFailure) ${n.name}`:"FiberFailure",n?.stack&&(this.stack=n.stack)}toJSON(){return{_id:"FiberFailure",cause:this[zs].toJSON()}}toString(){return"(FiberFailure) "+Bt(this[zs],{renderErrorCause:!0})}[re](){return this.toString()}}const am=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new W$(e);return Error.stackTraceLimit=t,n},um=e=>{const t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return Vl(t.left);case"Right":return te(t.right);case"Some":return te(t.value);case"None":return Vl(gu())}},qu=vr((e,t)=>{const n=um(t);if(n)return n;const r=new kg,s=Cs(e)(t,{scheduler:r});r.flush();const o=s.unsafePoll();return o||H0(ou(z$(s),wu(s)))}),lm=vr((e,t,n)=>Ju(e,t,n).then(r=>{switch(r._tag){case Fe:return r.effect_instruction_i0;case Re:throw am(r.effect_instruction_i0)}})),Ju=vr((e,t,n)=>new Promise(r=>{const s=um(t);s&&r(s);const o=Cs(e)(t);o.addObserver(i=>{r(i)}),n?.signal!==void 0&&(n.signal.aborted?o.unsafeInterruptAsFork(o.id()):n.signal.addEventListener("abort",()=>{o.unsafeInterruptAsFork(o.id())},{once:!0}))}));class fm{context;runtimeFlags;fiberRefs;constructor(t,n,r){this.context=t,this.runtimeFlags=n,this.fiberRefs=r}pipe(){return M(this,arguments)}}const H$=e=>new fm(e.context,e.runtimeFlags,e.fiberRefs),G$=()=>Z((e,t)=>x(new fm(e.getFiberRef(Sn),t.runtimeFlags,e.getFiberRefs()))),Y$=np(yn,ep,Xd),$r=H$({context:Yn(),runtimeFlags:Y$,fiberRefs:OO()}),fa=Cs($r),ro=lm($r),hm=Ju($r),ha=cm($r),Q$=qu($r),Z$=l(2,(e,t)=>e.modifyEffect(t)),X$="effect/Layer",eI=Symbol.for(X$),tI={_RIn:e=>e,_E:e=>e,_ROut:e=>e},Ct={[eI]:tI,pipe(){return M(this,arguments)}},nI="effect/Layer/MemoMap",sc=Symbol.for(nI),rI=Es()("effect/Layer/CurrentMemoMap",{defaultValue:()=>pm()}),sI=e=>e._op_layer===U$;class dm{ref;[sc];constructor(t){this.ref=t,this[sc]=sc}getOrElseMemoize(t,n){return p(Z$(this.ref,r=>{const s=r.get(t);if(s!==void 0){const[o,i]=s,c=p(o,k(([a,u])=>p(QO(a),rt(u))),lr(yu({onFailure:()=>ue,onSuccess:()=>Bc(n,i)})));return x([c,r])}return p(cf(0),k(o=>p(tT(),k(i=>p(cf(()=>ue),Y(c=>{const a=jt(h=>p(Ku(),k(f=>p(h(k(mm(t,f,!0),d=>zO(d(this)))),Kn,k(d=>{switch(d._tag){case Re:return p(rT(i,d.effect_instruction_i0),at(Kc(f,d)),at(ke(d.effect_instruction_i0)));case Fe:return p(Xp(c,g=>p(Kc(f,g),d0(DO(o,y=>[y===1,y-1])),Kt)),at(af(o,g=>g+1)),at(Bc(n,g=>p(v(()=>r.delete(t)),at(Ao(c)),k(y=>y(g))))),at(sT(i,d.effect_instruction_i0)),rt(d.effect_instruction_i0[1]))}}))))),u=[p(_u(i),lr(Z0({onFailure:()=>ue,onSuccess:()=>af(o,h=>h+1)}))),h=>p(Ao(c),k(f=>f(h)))];return[a,sI(t)?r:r.set(t,u)]}))))))}),_i)}}const oI=G(()=>Y(x$(new Map),e=>new dm(e))),pm=()=>new dm(om(new Map)),iI=l(2,(e,t)=>k(oI,n=>gm(e,n,t))),gm=l(3,(e,t,n)=>k(mm(e,n),r=>$u(r(t),rI,t))),mm=(e,t,n=!1)=>{const r=e;switch(r._op_layer){case"Locally":return v(()=>s=>r.f(s.getOrElseMemoize(r.self,t)));case"ExtendScope":return v(()=>s=>tm(o=>s.getOrElseMemoize(r.layer,o)));case"Fold":return v(()=>s=>p(s.getOrElseMemoize(r.layer,t),$t({onFailure:o=>s.getOrElseMemoize(r.failureK(o),t),onSuccess:o=>s.getOrElseMemoize(r.successK(o),t)})));case"Fresh":return v(()=>s=>p(r.layer,iI(t)));case"FromEffect":return v(n?()=>s=>r.effect:()=>s=>s.getOrElseMemoize(e,t));case"Provide":return v(()=>s=>p(s.getOrElseMemoize(r.first,t),k(o=>p(s.getOrElseMemoize(r.second,t),Ps(o)))));case"Scoped":return v(n?()=>s=>Ds(r.effect,t):()=>s=>s.getOrElseMemoize(e,t));case"Suspend":return v(()=>s=>s.getOrElseMemoize(r.evaluate(),t));case"ProvideMerge":return v(()=>s=>p(s.getOrElseMemoize(r.first,t),m0(s.getOrElseMemoize(r.second,t),r.zipK)));case"ZipWith":return v(()=>s=>p(s.getOrElseMemoize(r.first,t),g$(s.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})))}},cI=()=>Bs(Su()),aI=e=>ym(T$(e)),ym=e=>Bs(ke(e)),uI=l(2,(e,t)=>fI(e,{onFailure:aI,onSuccess:t})),da=l(2,(e,t)=>{const n=ri(e),r=n?e:t;return Bs(Y(n?t:e,o=>Ts(r,o)))});function Bs(e){const t=Object.create(Ct);return t._op_layer=D$,t.effect=e,t}const lI=l(2,(e,{onFailure:t,onSuccess:n})=>{const r=Object.create(Ct);return r._op_layer=j$,r.layer=e,r.failureK=t,r.successK=n,r}),fI=l(2,(e,{onFailure:t,onSuccess:n})=>lI(e,{onFailure:r=>{const s=E$(r);switch(s._tag){case"Left":return t(s.left);case"Right":return ym(s.right)}},onSuccess:n})),hI=l(2,(e,t)=>mI(e,t,(n,r)=>Os(n,r))),_m=(...e)=>{let t=e[0];for(let n=1;n<e.length;n++)t=hI(t,e[n]);return t},Ff=l(2,(e,t)=>{const n=ri(e),r=n?e:t;return Sm(Y(n?t:e,o=>Ts(r,o)))}),bm=e=>Sm(p(e,rt(Yn()))),Sm=e=>{const t=Object.create(Ct);return t._op_layer=C$,t.effect=e,t},wm=l(2,(e,t)=>{const n=ri(e);return Bs(x(Ts(n?e:t,n?t:e)))}),km=e=>{const t=Object.create(Ct);return t._op_layer=B$,t.evaluate=e,t},dI=l(2,(e,t)=>{const n=ri(e),r=n?e:t,s=n?t:e;return Bs(v(()=>Ts(r,s())))}),pI=l(2,(e,t)=>k(tm(n=>gm(e,t,n)),n=>p(G$(),Ps(n)))),Uo=l(2,(e,t)=>km(()=>{const n=Object.create(Ct);return n._op_layer=K$,n.first=Object.create(Ct,{_op_layer:{value:im,enumerable:!0},first:{value:cI(),enumerable:!0},second:{value:Array.isArray(t)?_m(...t):t},zipK:{value:(r,s)=>p(r,Os(s))}}),n.second=e,n})),gI=l(2,(e,t)=>{const n=Object.create(Ct);return n._op_layer=im,n.first=t,n.second=Uo(e,t),n.zipK=(r,s)=>p(r,Os(s)),n}),mI=l(3,(e,t,n)=>km(()=>{const r=Object.create(Ct);return r._op_layer=q$,r.first=e,r.second=t,r.zipK=n,r})),yI=pi,_I=function(){const e=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends du{constructor(n){super(n?.message,n?.cause?{cause:n.cause}:void 0),n&&(Object.assign(this,n),Object.defineProperty(this,e,{value:n,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}.BaseEffectError}(),bI=e=>{const t={BaseEffectError:class extends _I{_tag=e}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError},SI=bn,_F=Yg,so=hr,wI=ke,Mf=$o,Do=p0,Ws=G,Ue=ue,kI=Uc,TI=VO,Co=tE,Yt=Y,OI=Si,EI=Gg,bF=M$,SF=ZO,wF=$u,vI=rE,$n=ur,ot=k,Af=Nn,kF=wi,TF=WO,Bo=YO,$I=fa,OF=ro,EF=hm,II=ha,RI=iE,FI=cE,MI=e=>{const t=new Map;return new Proxy(e,{get(n,r,s){if(r in n)return Reflect.get(n,r,s);if(t.has(r))return t.get(r);const o=(...c)=>Nn(n,a=>typeof a[r]=="function"?(t.set(r,(...u)=>Nn(n,h=>h[r](...u))),a[r](...c)):(t.set(r,Nn(n,u=>u[r])),a[r])),i=Nn(n,c=>c[r]);return Object.assign(o,i),Object.setPrototypeOf(o,Object.getPrototypeOf(i)),t.set(r,o),o}})},Tm=function(){return function(){const[e,t]=arguments,n="accessors"in t?t.accessors:!1,r=Error.stackTraceLimit;Error.stackTraceLimit=2;const s=new Error;Error.stackTraceLimit=r;let o="unchecked";const i=function(f){if(o==="unchecked"){const d=Object.getPrototypeOf(f);if(d===Object.prototype||d===null)o="plain";else{const g=Object.getPrototypeOf(this);Object.setPrototypeOf(g,d),o="patched"}}if(o==="plain")Object.assign(this,f);else if(o==="patched")return Object.setPrototypeOf(f,Object.getPrototypeOf(this)),f};i.prototype._tag=e,Object.defineProperty(i,"make",{get(){return f=>new this(f)}}),Object.defineProperty(i,"use",{get(){return f=>Nn(this,f)}}),i.key=e,Object.assign(i,ni),Object.defineProperty(i,"stack",{get(){return s.stack}});const c="dependencies"in t&&t.dependencies.length>0,a=c?"DefaultWithoutDependencies":"Default";let u,h=!1;if("effect"in t?(h=typeof t.effect=="function",Object.defineProperty(i,a,{get(){return h?function(){return da(i,Yt(t.effect.apply(null,arguments),f=>new this(f)))}.bind(this):u??=da(i,Yt(t.effect,f=>new this(f)))}})):"scoped"in t?(h=typeof t.scoped=="function",Object.defineProperty(i,a,{get(){return h?function(){return Ff(i,Yt(t.scoped.apply(null,arguments),f=>new this(f)))}.bind(this):u??=Ff(i,Yt(t.scoped,f=>new this(f)))}})):"sync"in t?Object.defineProperty(i,a,{get(){return u??=dI(i,()=>new this(t.sync()))}}):Object.defineProperty(i,a,{get(){return u??=wm(i,new this(t.succeed))}}),c){let f;Object.defineProperty(i,"Default",{get(){return h?function(){return Uo(this.DefaultWithoutDependencies.apply(null,arguments),t.dependencies)}:f??=Uo(this.DefaultWithoutDependencies,t.dependencies)}})}return n===!0?MI(i):i}},Vu=function(e,...t){const n=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=new Error;if(Error.stackTraceLimit=n,typeof e!="string")return Nf(e.length,function(...i){const c=Error.stackTraceLimit;Error.stackTraceLimit=2;const a=new Error;return Error.stackTraceLimit=c,Pf({self:this,body:e,args:i,pipeables:t,spanName:"<anonymous>",spanOptions:{context:Fo.context(!0)},errorDef:r,errorCall:a})});const s=e,o=t[0];return(i,...c)=>Nf(i.length,{[s](...a){const u=Error.stackTraceLimit;Error.stackTraceLimit=2;const h=new Error;return Error.stackTraceLimit=u,Pf({self:this,body:i,args:a,pipeables:c,spanName:s,spanOptions:o,errorDef:r,errorCall:h})}}[s])};function Nf(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function Pf(e){let t,n;if(wy(e.body))t=Ep(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(i){n=i,t=Mf(i)}if(e.pipeables.length>0)try{for(const i of e.pipeables)t=i(t,...e.args)}catch(i){t=n?wI(Ae(Ge(n),Ge(i))):Mf(i)}let r=!1;const s=()=>{if(r!==!1)return r;if(e.errorCall.stack){const i=e.errorDef.stack.trim().split(`
`),c=e.errorCall.stack.trim().split(`
`);let a=i.slice(2).join(`
`).trim();a.includes("(")||(a=a.replace(/at (.*)/,"at ($1)"));let u=c.slice(2).join(`
`).trim();return u.includes("(")||(u=u.replace(/at (.*)/,"at ($1)")),r=`${a}
${u}`,r}},o=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:s,...e.spanOptions};return RI(t,e.spanName,o)}const AI=e=>bm(rm(Bu,Bn(e))),NI=e=>bm(rm(Bu,Ga(e))),PI=l(2,(e,t)=>uI(NI(e),()=>AI(t))),Lf=da,vF=_m,$F=wm,xf=Uo,IF=gI;class Oe{path;actual;issue;_tag="Pointer";constructor(t,n,r){this.path=t,this.actual=n,this.issue=r}}class jf{actual;message;_tag="Unexpected";constructor(t,n){this.actual=t,this.message=n}}class jr{ast;message;_tag="Missing";actual=void 0;constructor(t,n){this.ast=t,this.message=n}}class ie{ast;actual;issues;output;_tag="Composite";constructor(t,n,r,s){this.ast=t,this.actual=n,this.issues=r,this.output=s}}class oc{ast;actual;kind;issue;_tag="Refinement";constructor(t,n,r,s){this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class ic{ast;actual;kind;issue;_tag="Transformation";constructor(t,n,r,s){this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class Ce{ast;actual;message;_tag="Type";constructor(t,n,r){this.ast=t,this.actual=n,this.message=r}}class Uf{ast;actual;message;_tag="Forbidden";constructor(t,n,r){this.ast=t,this.actual=n,this.message=r}}const Df=Symbol.for("effect/Schema/ParseErrorTypeId");class LI extends bI("ParseError"){[Df]=Df;get message(){return this.toString()}toString(){return io.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[re](){return this.toJSON()}}const zu=e=>new LI({issue:e}),ps=K,Om=L,Cf=By,Le=Ky,Pt=l(2,(e,t)=>Le(e)?$a(e,{onLeft:L,onRight:t}):ot(e,t)),De=l(2,(e,t)=>Le(e)?qy(e,t):Yt(e,t)),oo=l(2,(e,t)=>Le(e)?kh(e,t):OI(e,t)),Em=l(2,(e,t)=>Le(e)?$a(e,{onLeft:t,onRight:K}):kI(e,t)),Ci=(e,t)=>t===void 0||vt(t)?e:e===void 0?t:{...e,...t},vm=(e,t,n)=>{const r=_e(e,t);return(s,o)=>r(s,Ci(n,o))},xI=(e,t,n)=>{const r=vm(e,t,n);return(s,o)=>Th(r(s,o),zu)},$m=(e,t,n)=>{const r=_e(e,t);return(s,o)=>r(s,{...Ci(n,o),isEffectAllowed:!0})},jI=(e,t)=>$m(e.ast,!0,t),UI=(e,t)=>$m(e.ast,!1,t),Wu=(e,t)=>xI(ce(e.ast),!0,t),DI=(e,t)=>vm(ce(e.ast),!0,t),CI=(e,t)=>{const n=_e(ce(e.ast),!0);return(r,s)=>ut(n(r,{exact:!0,...Ci(t,s)}))},BI=U(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),KI=U(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),_e=(e,t)=>{const n=t?BI:KI,r=n.get(e);if(r)return r;const s=qI(e,t),o=K_(e),i=$e(o)?(u,h)=>s(u,Ci(h,o.value)):s,c=q_(e),a=t&&$e(c)?(u,h)=>Jr(Em(i(u,h),c.value),e,u,h):i;return n.set(e,a),a},cc=e=>it(D_(e)),ac=e=>it(C_(e)),qI=(e,t)=>{switch(e._tag){case"Refinement":if(t){const n=_e(e.from,!0);return(r,s)=>{s=s??Vi;const o=s?.errors==="all",i=Pt(Em(n(r,s),c=>{const a=new oc(e,r,"From",c);return o&&V_(e)&&Mm(c)?qe(e.filter(r,s,e),{onNone:()=>L(a),onSome:u=>L(new ie(e,r,[a,new oc(e,r,"Predicate",u)]))}):L(a)}),c=>qe(e.filter(c,s,e),{onNone:()=>K(c),onSome:a=>L(new oc(e,r,"Predicate",a))}));return Jr(i,e,r,s)}}else{const n=_e(ce(e),!0),r=_e(Im(e.from),!1);return(s,o)=>Jr(Pt(n(s,o),i=>r(i,o)),e,s,o)}case"Transformation":{const n=zI(e.transformation,t),r=t?_e(e.from,!0):_e(e.to,!1),s=t?_e(e.to,!0):_e(e.from,!1);return(o,i)=>Jr(Pt(oo(r(o,i),c=>new ic(e,o,t?"Encoded":"Type",c)),c=>Pt(oo(n(c,i??Vi,e,o),a=>new ic(e,o,"Transformation",a)),a=>oo(s(a,i),u=>new ic(e,o,t?"Type":"Encoded",u)))),e,o,i)}case"Declaration":{const n=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(r,s)=>Jr(n(r,s??Vi,e),e,r,s)}case"Literal":return je(e,n=>n===e.literal);case"UniqueSymbol":return je(e,n=>n===e.symbol);case"UndefinedKeyword":return je(e,oy);case"NeverKeyword":return je(e,iy);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return K;case"StringKeyword":return je(e,Ke);case"NumberKeyword":return je(e,vt);case"BooleanKeyword":return je(e,Jn);case"BigIntKeyword":return je(e,Ho);case"SymbolKeyword":return je(e,fc);case"ObjectKeyword":return je(e,It);case"Enums":return je(e,n=>e.enums.some(([r,s])=>s===n));case"TemplateLiteral":{const n=bb(e);return je(e,r=>Ke(r)&&n.test(r))}case"TupleType":{const n=e.elements.map(u=>_e(u.type,t)),r=e.rest.map(u=>_e(u.type,t));let s=e.elements.filter(u=>!u.isOptional);e.rest.length>0&&(s=s.concat(e.rest.slice(1)));const o=s.length,i=e.elements.length>0?e.elements.map((u,h)=>h).join(" | "):"never",c=cc(e),a=ac(e);return(u,h)=>{if(!i_(u))return L(new Ce(e,u));const f=h?.errors==="all",d=[];let g=0;const y=[],E=u.length;for(let m=E;m<=o-1;m++){const T=new Oe(m,u,new jr(s[m-E]));if(f){d.push([g++,T]);continue}else return L(new ie(e,u,T,y))}if(e.rest.length===0)for(let m=e.elements.length;m<=E-1;m++){const T=new Oe(m,u,new jf(u[m],`is unexpected, expected: ${i}`));if(f){d.push([g++,T]);continue}else return L(new ie(e,u,T,y))}let b=0,w;for(;b<n.length;b++)if(E<b+1){if(e.elements[b].isOptional)continue}else{const m=n[b],T=m(u[b],h);if(Le(T)){if(Ee(T)){const O=new Oe(b,u,T.left);if(f){d.push([g++,O]);continue}else return L(new ie(e,u,O,Qe(y)))}y.push([g++,T.right])}else{const O=g++,S=b;w||(w=[]),w.push(({es:_,output:F})=>ot($n(T),J=>{if(Ee(J)){const V=new Oe(S,u,J.left);return f?(_.push([O,V]),Ue):L(new ie(e,u,V,Qe(F)))}return F.push([O,J.right]),Ue}))}}if(ne(r)){const[m,...T]=r;for(;b<E-T.length;b++){const O=m(u[b],h);if(Le(O))if(Ee(O)){const S=new Oe(b,u,O.left);if(f){d.push([g++,S]);continue}else return L(new ie(e,u,S,Qe(y)))}else y.push([g++,O.right]);else{const S=g++,_=b;w||(w=[]),w.push(({es:F,output:J})=>ot($n(O),V=>{if(Ee(V)){const D=new Oe(_,u,V.left);return f?(F.push([S,D]),Ue):L(new ie(e,u,D,Qe(J)))}else return J.push([S,V.right]),Ue}))}}for(let O=0;O<T.length;O++)if(b+=O,!(E<b+1)){const S=T[O](u[b],h);if(Le(S)){if(Ee(S)){const _=new Oe(b,u,S.left);if(f){d.push([g++,_]);continue}else return L(new ie(e,u,_,Qe(y)))}y.push([g++,S.right])}else{const _=g++,F=b;w||(w=[]),w.push(({es:J,output:V})=>ot($n(S),D=>{if(Ee(D)){const Q=new Oe(F,u,D.left);return f?(J.push([_,Q]),Ue):L(new ie(e,u,Q,Qe(V)))}return V.push([_,D.right]),Ue}))}}}const R=({es:m,output:T})=>Ys(m)?L(new ie(e,u,Qe(m),Qe(T))):K(Qe(T));if(w&&w.length>0){const m=w;return Ws(()=>{const T={es:Br(d),output:Br(y)};return ot(so(m,O=>O(T),{concurrency:c,batching:a,discard:!0}),()=>R(T))})}return R({output:y,es:d})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return je(e,cy);const n=[],r={},s=[];for(const h of e.propertySignatures)n.push([_e(h.type,t),h]),r[h.name]=null,s.push(h.name);const o=e.indexSignatures.map(h=>[_e(h.parameter,t),_e(h.type,t),h.parameter]),i=xe.make(e.indexSignatures.map(h=>h.parameter).concat(s.map(h=>fc(h)?new G_(h):new pc(h)))),c=_e(i,t),a=cc(e),u=ac(e);return(h,f)=>{if(!uy(h))return L(new Ce(e,h));const d=f?.errors==="all",g=[];let y=0;const E=f?.onExcessProperty==="error",b=f?.onExcessProperty==="preserve",w={};let R;if(E||b){R=wt(h);for(const S of R){const _=c(S,f);if(Le(_)&&Ee(_))if(E){const F=new Oe(S,h,new jf(h[S],`is unexpected, expected: ${String(i)}`));if(d){g.push([y++,F]);continue}else return L(new ie(e,h,F,w))}else w[S]=h[S]}}let m;const T=f?.exact===!0;for(let S=0;S<n.length;S++){const _=n[S][1],F=_.name,J=Object.prototype.hasOwnProperty.call(h,F);if(!J){if(_.isOptional)continue;if(T){const Q=new Oe(F,h,new jr(_));if(d){g.push([y++,Q]);continue}else return L(new ie(e,h,Q,w))}}const V=n[S][0],D=V(h[F],f);if(Le(D)){if(Ee(D)){const Q=new Oe(F,h,J?D.left:new jr(_));if(d){g.push([y++,Q]);continue}else return L(new ie(e,h,Q,w))}w[F]=D.right}else{const Q=y++,Te=F;m||(m=[]),m.push(({es:N,output:W})=>ot($n(D),pe=>{if(Ee(pe)){const ee=new Oe(Te,h,J?pe.left:new jr(_));return d?(N.push([Q,ee]),Ue):L(new ie(e,h,ee,W))}return W[Te]=pe.right,Ue}))}}for(let S=0;S<o.length;S++){const _=o[S],F=_[0],J=_[1],V=Nh(h,_[2]);for(const D of V){const Q=F(D,f);if(Le(Q)&&ut(Q)){const Te=J(h[D],f);if(Le(Te))if(Ee(Te)){const N=new Oe(D,h,Te.left);if(d){g.push([y++,N]);continue}else return L(new ie(e,h,N,w))}else Object.prototype.hasOwnProperty.call(r,D)||(w[D]=Te.right);else{const N=y++,W=D;m||(m=[]),m.push(({es:pe,output:ee})=>ot($n(Te),gt=>{if(Ee(gt)){const Rr=new Oe(W,h,gt.left);return d?(pe.push([N,Rr]),Ue):L(new ie(e,h,Rr,ee))}else return Object.prototype.hasOwnProperty.call(r,D)||(ee[D]=gt.right),Ue}))}}}}const O=({es:S,output:_})=>{if(Ys(S))return L(new ie(e,h,Qe(S),_));if(f?.propertyOrder==="original"){const F=R||wt(h);for(const V of s)F.indexOf(V)===-1&&F.push(V);const J={};for(const V of F)Object.prototype.hasOwnProperty.call(_,V)&&(J[V]=_[V]);return K(J)}return K(_)};if(m&&m.length>0){const S=m;return Ws(()=>{const _={es:Br(g),output:Object.assign({},w)};return ot(so(S,F=>F(_),{concurrency:a,batching:u,discard:!0}),()=>O(_))})}return O({es:g,output:w})}}case"Union":{const n=JI(e.types,t),r=wt(n.keys),s=r.length,o=e.types.length,i=new Map;for(let u=0;u<o;u++)i.set(e.types[u],_e(e.types[u],t));const c=cc(e)??1,a=ac(e);return(u,h)=>{const f=[];let d=0,g=[];if(s>0)if(_a(u))for(let b=0;b<s;b++){const w=r[b],R=n.keys[w].buckets;if(Object.prototype.hasOwnProperty.call(u,w)){const m=String(u[w]);if(Object.prototype.hasOwnProperty.call(R,m))g=g.concat(R[m]);else{const{candidates:T,literals:O}=n.keys[w],S=xe.make(O),_=T.length===o?new kt([new be(w,S,!1,!0)],[]):xe.make(T);f.push([d++,new ie(_,u,new Oe(w,u,new Ce(S,u[w])))])}}else{const{candidates:m,literals:T}=n.keys[w],O=new be(w,xe.make(T),!1,!0),S=m.length===o?new kt([O],[]):xe.make(m);f.push([d++,new ie(S,u,new Oe(w,u,new jr(O)))])}}else{const b=n.candidates.length===o?e:xe.make(n.candidates);f.push([d++,new Ce(b,u)])}n.otherwise.length>0&&(g=g.concat(n.otherwise));let y;for(let b=0;b<g.length;b++){const w=g[b],R=i.get(w)(u,h);if(Le(R)&&(!y||y.length===0)){if(ut(R))return R;f.push([d++,R.left])}else{const m=d++;y||(y=[]),y.push(T=>Ws(()=>"finalResult"in T?Ue:ot($n(R),O=>(ut(O)?T.finalResult=O:T.es.push([m,O.left]),Ue))))}}const E=b=>Ys(b)?b.length===1&&b[0][1]._tag==="Type"?L(b[0][1]):L(new ie(e,u,Qe(b))):L(new Ce(e,u));if(y&&y.length>0){const b=y;return Ws(()=>{const w={es:Br(f)};return ot(so(b,R=>R(w),{concurrency:c,batching:a,discard:!0}),()=>"finalResult"in w?w.finalResult:E(w.es))})}return E(f)}}case"Suspend":{const n=Ph(()=>_e(Hn(e.f(),e.annotations),t));return(r,s)=>n()(r,s)}}},je=(e,t)=>n=>t(n)?K(n):L(new Ce(e,n)),qr=(e,t)=>{switch(e._tag){case"Declaration":{const n=td(e);if($e(n))return qr(n.value,t);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const s=e.propertySignatures[r],o=t?wc(s.type):ce(s.type);Gr(o)&&!s.isOptional&&n.push([s.name,o])}return n}case"TupleType":{const n=[];for(let r=0;r<e.elements.length;r++){const s=e.elements[r],o=t?wc(s.type):ce(s.type);Gr(o)&&!s.isOptional&&n.push([r,o])}return n}case"Refinement":return qr(e.from,t);case"Suspend":return qr(e.f(),t);case"Transformation":return qr(t?e.from:e.to,t)}return[]},JI=(e,t)=>{const n={},r=[],s=[];for(let o=0;o<e.length;o++){const i=e[o],c=qr(i,t);if(c.length>0){s.push(i);for(let a=0;a<c.length;a++){const[u,h]=c[a],f=String(h.literal);n[u]=n[u]||{buckets:{},literals:[],candidates:[]};const d=n[u].buckets;if(Object.prototype.hasOwnProperty.call(d,f)){if(a<c.length-1)continue;d[f].push(i),n[u].literals.push(h),n[u].candidates.push(i)}else{d[f]=[i],n[u].literals.push(h),n[u].candidates.push(i);break}}}else r.push(i)}return{keys:n,otherwise:r,candidates:s}},Im=e=>Un(e)?Im(e.from):e,Jr=(e,t,n,r)=>{if(r?.isEffectAllowed===!0||Le(e))return e;const s=new kg,o=$I(e,{scheduler:s});s.flush();const i=o.unsafePoll();if(i){if(lT(i))return K(i.value);const c=i.cause;return O$(c)?L(c.error):L(new Uf(t,n,v$(c)))}return L(new Uf(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},VI=([e],[t])=>e>t?1:e<t?-1:0;function Qe(e){return e.sort(VI).map(t=>t[1])}const zI=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return K;case"TypeLiteralTransformation":return n=>{let r=K(n);for(const s of e.propertySignatureTransformations){const[o,i]=t?[s.from,s.to]:[s.to,s.from],c=t?s.decode:s.encode;r=De(r,u=>{const h=c(Object.prototype.hasOwnProperty.call(u,o)?A(u[o]):I());return delete u[o],$e(h)&&(u[i]=h.value),u})}return r}}},Me=(e,t=[])=>({value:e,forest:t}),io={formatIssue:e=>De(Mn(e),WI),formatIssueSync:e=>{const t=io.formatIssue(e);return Le(t)?Vy(t):II(t)},formatError:e=>io.formatIssue(e.issue),formatErrorSync:e=>io.formatIssueSync(e.issue)},WI=e=>e.value+Rm(`
`,e.forest),Rm=(e,t)=>{let n="";const r=t.length;let s;for(let o=0;o<r;o++){s=t[o];const i=o===r-1;n+=e+(i?"└":"├")+"─ "+s.value,n+=Rm(e+(r>1&&!i?"│  ":"   "),s.forest)}return n},HI=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},GI=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},Fm=e=>"ast"in e?A(e.ast):I(),pa=K(void 0),YI=e=>Fm(e).pipe(bs(j_),qe({onNone:()=>pa,onSome:t=>{const n=t(e);return Ke(n)?K({message:n,override:!1}):SI(n)?Yt(n,r=>({message:r,override:!1})):Ke(n.message)?K({message:n.message,override:n.override}):Yt(n.message,r=>({message:r,override:n.override}))}})),Hu=e=>t=>t._tag===e,Mm=Hu("Composite"),Bf=Hu("Refinement"),Kf=Hu("Transformation"),Xr=e=>Pt(YI(e),t=>t!==void 0?!t.override&&(Mm(e)||Bf(e)&&e.kind==="From"||Kf(e)&&e.kind!=="Transformation")?Kf(e)||Bf(e)?Xr(e.issue):pa:K(t.message):pa),Am=e=>Fm(e).pipe(bs(B_),Yy(t=>t(e)),it);function QI(e){return ed(e).pipe(Lt(()=>Zh(e)),Lt(()=>Xh(e)),Lt(()=>Xo(e)),ae(()=>`{ ${e.from} | filter }`))}function ZI(e){return e.message!==void 0?e.message:`Expected ${Un(e.ast)?QI(e.ast):String(e.ast)}, actual ${tt(e.actual)}`}const XI=e=>De(Xr(e),t=>t??Am(e)??ZI(e)),Hs=e=>Am(e)??String(e.ast),eR=e=>e.message??"is forbidden",tR=e=>e.message??"is unexpected",nR=e=>{const t=U_(e.ast);if($e(t)){const n=t.value();return Ke(n)?K(n):n}return K(e.message??"is missing")},Mn=e=>{switch(e._tag){case"Type":return De(XI(e),Me);case"Forbidden":return K(Me(Hs(e),[Me(eR(e))]));case"Unexpected":return K(Me(tR(e)));case"Missing":return De(nR(e),Me);case"Transformation":return Pt(Xr(e),t=>t!==void 0?K(Me(t)):De(Mn(e.issue),n=>Me(Hs(e),[Me(HI(e.kind),[n])])));case"Refinement":return Pt(Xr(e),t=>t!==void 0?K(Me(t)):De(Mn(e.issue),n=>Me(Hs(e),[Me(GI(e.kind),[n])])));case"Pointer":return De(Mn(e.issue),t=>Me(jh(e.path),[t]));case"Composite":return Pt(Xr(e),t=>{if(t!==void 0)return K(Me(t));const n=Hs(e);return xh(e.issues)?De(so(e.issues,Mn),r=>Me(n,r)):De(Mn(e.issues),r=>Me(n,[r]))})}},rR=PI,RF=rR(Hg,c$);function In(e,t){return k(e.runtimeEffect,n=>Z(r=>(r.setFiberRefs(n.fiberRefs),r.currentRuntimeFlags=n.runtimeFlags,Ps(t,n.context))))}const sR={...xO,[Rf]:Rf,pipe(){return M(this,arguments)},commit(){return this.runtimeEffect}},oR=(e,t)=>{t=t??pm();const n=ha(Ku());let r;const s=Z(i=>(r||(r=fa(wi($$(pI(e,t),n),c=>{o.cachedRuntime=c}),{scope:n,scheduler:i.currentScheduler})),_i(r.await))),o=Object.assign(Object.create(sR),{memoMap:t,scope:n,runtimeEffect:s,cachedRuntime:void 0,runtime(){return o.cachedRuntime===void 0?ro(o.runtimeEffect):Promise.resolve(o.cachedRuntime)},dispose(){return ro(o.disposeEffect)},disposeEffect:G(()=>(o.runtimeEffect=$o("ManagedRuntime disposed"),o.cachedRuntime=void 0,sm(o.scope,Be))),runFork(i,c){return o.cachedRuntime===void 0?fa(In(o,i),c):Cs(o.cachedRuntime)(i,c)},runSyncExit(i){return o.cachedRuntime===void 0?Q$(In(o,i)):qu(o.cachedRuntime)(i)},runSync(i){return o.cachedRuntime===void 0?ha(In(o,i)):cm(o.cachedRuntime)(i)},runPromiseExit(i,c){return o.cachedRuntime===void 0?hm(In(o,i),c):Ju(o.cachedRuntime)(i,c)},runCallback(i,c){return o.cachedRuntime===void 0?la($r)(In(o,i),c):la(o.cachedRuntime)(i,c)},runPromise(i,c){return o.cachedRuntime===void 0?ro(In(o,i),c):lm(o.cachedRuntime)(i,c)}});return o},FF=oR,iR=l(e=>It(e[0]),(e,...t)=>{const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}),cR=l(e=>It(e[0]),(e,...t)=>{const n={...e};for(const r of t)delete n[r];return n}),dr=Symbol.for("effect/Schema");function de(e){return class{[dr]=ga;static ast=e;static annotations(n){return de(pt(this.ast,n))}static pipe(){return M(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static[dr]=ga}}const ga={_A:e=>e,_I:e=>e,_R:e=>e},qf={schemaId:N_,message:Ch,missingMessage:Fa,identifier:Ma,title:Ft,description:Ss,examples:Bh,default:Kh,documentation:P_,jsonSchema:qh,arbitrary:Jh,pretty:Vh,equivalence:zh,concurrency:Wh,batching:Hh,parseIssueTitle:Gh,parseOptions:Yh,decodingFallback:Qh},Ir=e=>{if(!e)return{};const t={...e};for(const n in qf)if(n in e){const r=qf[n];t[r]=e[n],delete t[n]}return t},pt=(e,t)=>Hn(e,Ir(t)),aR=e=>de(wc(e.ast)),Jf=e=>de(ce(e.ast)),AF=(e,t)=>{const n=jI(e,t);return(r,s)=>oo(n(r,s),zu)},NF=(e,t)=>{const n=DI(e,t);return(r,s)=>kh(n(r,s),zu)},dt=e=>P(e,dr)&&It(e[dr]);function uR(e){return La(e)?xe.make(lb(e,t=>new pc(t))):new pc(e[0])}function Nm(e,t=uR(e)){return class extends de(t){static annotations(r){return Nm(this.literals,pt(this.ast,r))}static literals=[...e]}}function LF(...e){return ne(e)?Nm(e):Pm}const lR=(e,t,n)=>Gu(e,new ei(e.map(r=>r.ast),(...r)=>t.decode(...r.map(de)),(...r)=>t.encode(...r.map(de)),Ir(n))),fR=(e,t)=>{const n=()=>(s,o,i)=>e(s)?ps(s):Om(new Ce(i,s)),r=n;return Gu([],new ei([],n,r,Ir(t)))};function Gu(e,t){return class extends de(t){static annotations(r){return Gu(this.typeParameters,pt(this.ast,r))}static typeParameters=[...e]}}const hR=function(){if(Array.isArray(arguments[0])){const n=arguments[0],r=arguments[1],s=arguments[2];return lR(n,r,s)}const e=arguments[0],t=arguments[1];return fR(e,t)};class dR extends de(ns){}class Pm extends de(Na){}class pR extends de(nd){}class Lm extends de(gc){}class jF extends de(yc){}const gR=e=>xe.make(e.map(t=>t.ast));function xm(e,t=gR(e)){return class extends de(t){static annotations(r){return xm(this.members,pt(this.ast,r))}static members=[...e]}}function mR(...e){return La(e)?xm(e):ne(e)?e[0]:Pm}const yR=e=>mR(e,dR),_R=(e,t)=>new ti(e.map(n=>dt(n)?new dn(n.ast,!1):n.ast),t.map(n=>dt(n)?new ws(n.ast):n.ast),!0);function jm(e,t,n=_R(e,t)){return class extends de(n){static annotations(s){return jm(this.elements,this.rest,pt(this.ast,s))}static elements=[...e];static rest=[...t]}}function Um(e,t){return class extends jm([e],[e],t){static annotations(r){return Um(this.value,pt(this.ast,r))}static value=e}}const BF=e=>Um(e),ma=e=>e?'"?:"':'":"';class Dm extends dn{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(t,n,r,s,o){super(t,n,s),this.isReadonly=r,this.defaultValue=o}toString(){const t=ma(this.isOptional),n=String(this.type);return`PropertySignature<${t}, ${n}, never, ${t}, ${n}>`}}class bR extends dn{isReadonly;defaultValue;constructor(t,n,r,s,o){super(t,n,s),this.isReadonly=r,this.defaultValue=o}}const SR=e=>e===void 0?"never":Ke(e)?JSON.stringify(e):String(e);class wR{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(t,n,r,s){this.from=t,this.to=n,this.decode=r,this.encode=s}toString(){return`PropertySignature<${ma(this.to.isOptional)}, ${this.to.type}, ${SR(this.from.fromKey)}, ${ma(this.from.isOptional)}, ${this.from.type}>`}}const Cm=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new Dm(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new wR(e.from,new bR(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},Bm=Symbol.for("effect/PropertySignature"),Yu=e=>P(e,Bm);class Qu{ast;[dr];[Bm]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(t){this.ast=t}pipe(){return M(this,arguments)}annotations(t){return new Qu(Cm(this.ast,Ir(t)))}toString(){return String(this.ast)}}class Zu extends Qu{from;constructor(t,n){super(t),this.from=n}annotations(t){return new Zu(Cm(this.ast,Ir(t)),this.from)}}const KF=e=>{const t=e.ast===ns||e.ast===Na?ns:yR(e).ast;return new Zu(new Dm(t,!0,!0,{},void 0),e)},kR=ud([Fa]),TR=(e,t)=>{const n=wt(e),r=[];if(n.length>0){const o=[],i=[],c=[];for(let a=0;a<n.length;a++){const u=n[a],h=e[u];if(Yu(h)){const f=h.ast;switch(f._tag){case"PropertySignatureDeclaration":{const d=f.type,g=f.isOptional,y=f.annotations;o.push(new be(u,d,g,!0,kR(f))),i.push(new be(u,ce(d),g,!0,y)),r.push(new be(u,d,g,!0,y));break}case"PropertySignatureTransformation":{const d=f.from.fromKey??u;o.push(new be(d,f.from.type,f.from.isOptional,!0,f.from.annotations)),i.push(new be(u,f.to.type,f.to.isOptional,!0,f.to.annotations)),c.push(new pb(d,u,f.decode,f.encode));break}}}else o.push(new be(u,h.ast,!1,!0)),i.push(new be(u,ce(h.ast),!1,!0)),r.push(new be(u,h.ast,!1,!0))}if(ne(c)){const a=[],u=[];for(const h of t){const{indexSignatures:f,propertySignatures:d}=Sl(h.key.ast,h.value.ast);d.forEach(g=>{o.push(g),i.push(new be(g.name,ce(g.type),g.isOptional,g.isReadonly,g.annotations))}),f.forEach(g=>{a.push(g),u.push(new ks(g.parameter,ce(g.type),g.isReadonly))})}return new Nt(new kt(o,a,{[jn]:"Struct (Encoded side)"}),new kt(i,u,{[jn]:"Struct (Type side)"}),new bc(c))}}const s=[];for(const o of t){const{indexSignatures:i,propertySignatures:c}=Sl(o.key.ast,o.value.ast);c.forEach(a=>r.push(a)),i.forEach(a=>s.push(a))}return new kt(r,s)},Km=(e,t)=>{const n=wt(e);for(const r of n){const s=e[r];if(t[r]===void 0&&Yu(s)){const o=s.ast,i=o._tag==="PropertySignatureDeclaration"?o.defaultValue:o.to.defaultValue;i!==void 0&&(t[r]=i())}}return t};function Xu(e,t,n=TR(e,t)){return class extends de(n){static annotations(s){return Xu(this.fields,this.records,pt(this.ast,s))}static fields={...e};static records=[...t];static make=(s,o)=>{const i=Km(e,{...s});return nl(o)?i:Wu(this)(i)};static pick(...s){return pr(iR(e,...s))}static omit(...s){return pr(cR(e,...s))}}}function pr(e,...t){return Xu(e,t)}function qm(e,t,n){return class extends Xu({},[{key:e,value:t}],n){static annotations(s){return qm(e,t,pt(this.ast,s))}static key=e;static value=t}}const VF=e=>qm(e.key,e.value),zF=e=>de(Kr(e.ast)),Ur=(e,t,n)=>{if(bl(e)&&bl(t)){const r=[...e.propertySignatures];for(const s of t.propertySignatures){const o=s.name,i=r.findIndex(c=>c.name===o);if(i===-1)r.push(s);else{const{isOptional:c,type:a}=r[i];r[i]=new be(o,Ko(a,s.type,n.concat(o)),c,!0)}}return new kt(r,e.indexSignatures.concat(t.indexSignatures))}throw new Error(Uh(e,t,n))},OR=Sb([Ma]),Dr=(e,t)=>t.map(n=>new ja(n,e.filter,OR(e))),Ko=(e,t,n)=>xe.make(_t([e],[t],n)),Vt=e=>xa(e)?e.types:[e],_t=(e,t,n)=>mo(e,r=>mo(t,s=>{switch(s._tag){case"Literal":{if(Ke(s.literal)&&mc(r)||vt(s.literal)&&gl(r)||Jn(s.literal)&&yl(r))return[s];break}case"StringKeyword":{if(s===gc){if(mc(r)||Gr(r)&&Ke(r.literal))return[r];if(Un(r))return Dr(r,_t(Vt(r.from),[s],n))}else if(r===gc)return[s];break}case"NumberKeyword":{if(s===yc){if(gl(r)||Gr(r)&&vt(r.literal))return[r];if(Un(r))return Dr(r,_t(Vt(r.from),[s],n))}else if(r===yc)return[s];break}case"BooleanKeyword":{if(s===ml){if(yl(r)||Gr(r)&&Jn(r.literal))return[r];if(Un(r))return Dr(r,_t(Vt(r.from),[s],n))}else if(r===ml)return[s];break}case"Union":return _t(Vt(r),s.types,n);case"Suspend":return[new rs(()=>Ko(r,s.f(),n))];case"Refinement":return Dr(s,_t(Vt(r),Vt(s.from),n));case"TypeLiteral":{switch(r._tag){case"Union":return _t(r.types,[s],n);case"Suspend":return[new rs(()=>Ko(r.f(),s,n))];case"Refinement":return Dr(r,_t(Vt(r.from),[s],n));case"TypeLiteral":return[Ur(r,s,n)];case"Transformation":{const o=r.transformation,i=Ur(r.from,s,n),c=Ur(r.to,ce(s),n);switch(o._tag){case"TypeLiteralTransformation":return[new Nt(i,c,new bc(o.propertySignatureTransformations))];case"ComposeTransformation":return[new Nt(i,c,id)];case"FinalTransformation":return[new Nt(i,c,new od((a,u,h,f)=>De(o.decode(a,u,h,f),d=>({...a,...d})),(a,u,h,f)=>De(o.encode(a,u,h,f),d=>({...a,...d}))))]}}}break}case"Transformation":{if(fb(r)){if(Sc(s.transformation)&&Sc(r.transformation))return[new Nt(Ur(r.from,s.from,n),Ur(r.to,s.to,n),new bc(s.transformation.propertySignatureTransformations.concat(r.transformation.propertySignatureTransformations)))]}else return _t([s],[r],n);break}}throw new Error(Uh(r,s,n))})),ER=l(2,(e,t)=>de(Ko(e.ast,t.ast,[]))),vR=l(e=>dt(e[1]),(e,t)=>el(e,t,kb(e.ast,t.ast))),Jm=Symbol.for("effect/SchemaId/Refine");function Vm(e,t,n){return class extends de(n){static annotations(s){return Vm(this.from,this.filter,pt(this.ast,s))}static[Jm]=e;static from=e;static filter=t;static make=(s,o)=>nl(o)?s:Wu(this)(s)}}const Vf=(e,t,n)=>{if(Jn(e))return e?I():A(new Ce(t,n));if(Ke(e))return A(new Ce(t,n,e));if(e!==void 0){if("_tag"in e)return A(e);const r=new Ce(t,n,e.message);return A(ne(e.path)?new Oe(e.path,n,r):r)}return I()},$R=(e,t,n)=>{if(E_(e))return Vf(e,t,n);if(ne(e)){const r=w_(e,s=>Vf(s,t,n));if(ne(r))return A(r.length===1?r[0]:new ie(t,n,r))}return I()};function zm(e,t){return n=>{function r(o,i,c){return $R(e(o,i,c),c,o)}const s=new ja(n.ast,r,Ir(t));return Vm(n,r,s)}}function el(e,t,n){return class extends de(n){static annotations(s){return el(this.from,this.to,pt(this.ast,s))}static from=e;static to=t}}const qo=l(e=>dt(e[0])&&dt(e[1]),(e,t,n)=>el(e,t,new Nt(e.ast,t.ast,new od(n.decode,n.encode)))),IR=l(e=>dt(e[0])&&dt(e[1]),(e,t,n)=>qo(e,t,{strict:!0,decode:(r,s,o,i)=>ps(n.decode(r,i)),encode:(r,s,o,i)=>ps(n.encode(r,i))})),RR=M_,FR=(e,t)=>n=>n.pipe(zm(r=>r.length>=e,{schemaId:RR,title:`minLength(${e})`,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})),zf=Symbol.for("effect/SchemaId/Pattern"),GF=(e,t)=>n=>{const r=e.source;return n.pipe(zm(s=>(e.lastIndex=0,e.test(s)),{schemaId:zf,[zf]:{regex:e},description:`a string matching the pattern ${r}`,jsonSchema:{pattern:r},...t}))},MR=e=>FR(1,{title:"nonEmptyString",description:"a non empty string",...e}),Wf=e=>e instanceof Error?e.message:String(e),AR=e=>qo(Lm.annotations({description:"a string to be decoded into JSON"}),pR,{strict:!0,decode:(t,n,r)=>Cf({try:()=>JSON.parse(t,e?.reviver),catch:s=>new Ce(r,t,Wf(s))}),encode:(t,n,r)=>Cf({try:()=>JSON.stringify(t,e?.replacer,e?.space),catch:s=>new Ce(r,t,Wf(s))})}).annotations({title:"parseJson",schemaId:H_}),NR=(e,t)=>dt(e)?vR(NR(t),e):AR(e);class YF extends Lm.pipe(MR({identifier:"NonEmptyString"})){}const PR=e=>dt(e)||Yu(e),Wm=e=>wt(e).every(t=>PR(e[t])),tl=e=>"fields"in e?e.fields:tl(e[Jm]),Hm=e=>Wm(e)?pr(e):dt(e)?e:pr(tl(e)),Gm=e=>Wm(e)?e:tl(e),QF=e=>(t,n)=>co({kind:"Class",identifier:e,schema:Hm(t),fields:Gm(t),Base:yI,annotations:n}),uc=(e,t)=>{const n={...e};for(const r of wt(t)){if(r in e)throw new Error(Dh(r));n[r]=t[r]}return n};function nl(e){return Jn(e)?e:e?.disableValidation??!1}const Hf=U("effect/Schema/astCache",()=>new WeakMap),LR=e=>e===void 0?[]:Array.isArray(e)?e:[e],co=({Base:e,annotations:t,disableToString:n,fields:r,identifier:s,kind:o,schema:i})=>{const c=Symbol.for(`effect/Schema/${o}/${s}`),[a,u,h]=LR(t),f=Jf(i),d=f.annotations({identifier:s,...a}),g=f.annotations({[jn]:`${s} (Type side)`,...a}),y=i.annotations({[jn]:`${s} (Constructor)`,...a}),E=i.annotations({[jn]:`${s} (Encoded side)`,...h}),b=i.annotations({[Aa]:s,...h,...a,...u}),w=m=>P(m,c)&&CI(g)(m),R=class extends e{constructor(m={},T=!1){m={...m},m=Km(r,m),nl(T)||(m=Wu(y)(m)),super(m,!0)}static[dr]=ga;static get ast(){let m=Hf.get(this);if(m)return m;const T=hR([i],{decode:()=>(O,S,_)=>O instanceof this||w(O)?ps(O):Om(new Ce(_,O)),encode:()=>(O,S)=>O instanceof this?ps(O):De(UI(g)(O,S),_=>new this(_,!0))},{identifier:s,pretty:O=>S=>`${s}(${O(S)})`,arbitrary:O=>S=>O(S).map(_=>new this(_)),equivalence:z,[_o]:d.ast,...a});return m=IR(E,T,{strict:!0,decode:O=>new this(O,!0),encode:z}).annotations({[_o]:b.ast,...u}).ast,Hf.set(this,m),m}static pipe(){return M(this,arguments)}static annotations(m){return de(this.ast).annotations(m)}static toString(){return`(${String(E)} <-> ${s})`}static make(...m){return new this(...m)}static fields={...r};static identifier=s;static extend(m){return(T,O)=>{const S=Gm(T),_=Hm(T),F=uc(r,S);return co({kind:o,identifier:m,schema:ER(i,_),fields:F,Base:this,annotations:O})}}static transformOrFail(m){return(T,O,S)=>{const _=uc(r,T);return co({kind:o,identifier:m,schema:qo(i,Jf(pr(_)),O),fields:_,Base:this,annotations:S})}}static transformOrFailFrom(m){return(T,O,S)=>{const _=uc(r,T);return co({kind:o,identifier:m,schema:qo(aR(i),pr(_),O),fields:_,Base:this,annotations:S})}}get[c](){return c}};return n!==!0&&Object.defineProperty(R.prototype,"toString",{value(){return`${s}({ ${wt(r).map(m=>`${Lh(m)}: ${tt(this[m])}`).join(", ")} })`},configurable:!0,writable:!0}),R},xR="modulepreload",jR=function(e){return"/"+e},Gf={},UR=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let i=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),a=c?.nonce||c?.getAttribute("nonce");s=i(n.map(u=>{if(u=jR(u),u in Gf)return;Gf[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":xR,h||(d.as="script"),d.crossOrigin="",d.href=u,a&&d.setAttribute("nonce",a),document.head.appendChild(d),h)return new Promise((g,y)=>{d.addEventListener("load",g),d.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return s.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})};Qm();function DR(e,t=!1){const n=e.length;let r=0,s="",o=0,i=16,c=0,a=0,u=0,h=0,f=0;function d(m,T){let O=0,S=0;for(;O<m;){let _=e.charCodeAt(r);if(_>=48&&_<=57)S=S*16+_-48;else if(_>=65&&_<=70)S=S*16+_-65+10;else if(_>=97&&_<=102)S=S*16+_-97+10;else break;r++,O++}return O<m&&(S=-1),S}function g(m){r=m,s="",o=0,i=16,f=0}function y(){let m=r;if(e.charCodeAt(r)===48)r++;else for(r++;r<e.length&&Rn(e.charCodeAt(r));)r++;if(r<e.length&&e.charCodeAt(r)===46)if(r++,r<e.length&&Rn(e.charCodeAt(r)))for(r++;r<e.length&&Rn(e.charCodeAt(r));)r++;else return f=3,e.substring(m,r);let T=r;if(r<e.length&&(e.charCodeAt(r)===69||e.charCodeAt(r)===101))if(r++,(r<e.length&&e.charCodeAt(r)===43||e.charCodeAt(r)===45)&&r++,r<e.length&&Rn(e.charCodeAt(r))){for(r++;r<e.length&&Rn(e.charCodeAt(r));)r++;T=r}else f=3;return e.substring(m,T)}function E(){let m="",T=r;for(;;){if(r>=n){m+=e.substring(T,r),f=2;break}const O=e.charCodeAt(r);if(O===34){m+=e.substring(T,r),r++;break}if(O===92){if(m+=e.substring(T,r),r++,r>=n){f=2;break}switch(e.charCodeAt(r++)){case 34:m+='"';break;case 92:m+="\\";break;case 47:m+="/";break;case 98:m+="\b";break;case 102:m+="\f";break;case 110:m+=`
`;break;case 114:m+="\r";break;case 116:m+="	";break;case 117:const _=d(4);_>=0?m+=String.fromCharCode(_):f=4;break;default:f=5}T=r;continue}if(O>=0&&O<=31)if(Cr(O)){m+=e.substring(T,r),f=2;break}else f=6;r++}return m}function b(){if(s="",f=0,o=r,a=c,h=u,r>=n)return o=n,i=17;let m=e.charCodeAt(r);if(lc(m)){do r++,s+=String.fromCharCode(m),m=e.charCodeAt(r);while(lc(m));return i=15}if(Cr(m))return r++,s+=String.fromCharCode(m),m===13&&e.charCodeAt(r)===10&&(r++,s+=`
`),c++,u=r,i=14;switch(m){case 123:return r++,i=1;case 125:return r++,i=2;case 91:return r++,i=3;case 93:return r++,i=4;case 58:return r++,i=6;case 44:return r++,i=5;case 34:return r++,s=E(),i=10;case 47:const T=r-1;if(e.charCodeAt(r+1)===47){for(r+=2;r<n&&!Cr(e.charCodeAt(r));)r++;return s=e.substring(T,r),i=12}if(e.charCodeAt(r+1)===42){r+=2;const O=n-1;let S=!1;for(;r<O;){const _=e.charCodeAt(r);if(_===42&&e.charCodeAt(r+1)===47){r+=2,S=!0;break}r++,Cr(_)&&(_===13&&e.charCodeAt(r)===10&&r++,c++,u=r)}return S||(r++,f=1),s=e.substring(T,r),i=13}return s+=String.fromCharCode(m),r++,i=16;case 45:if(s+=String.fromCharCode(m),r++,r===n||!Rn(e.charCodeAt(r)))return i=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return s+=y(),i=11;default:for(;r<n&&w(m);)r++,m=e.charCodeAt(r);if(o!==r){switch(s=e.substring(o,r),s){case"true":return i=8;case"false":return i=9;case"null":return i=7}return i=16}return s+=String.fromCharCode(m),r++,i=16}}function w(m){if(lc(m)||Cr(m))return!1;switch(m){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function R(){let m;do m=b();while(m>=12&&m<=15);return m}return{setPosition:g,getPosition:()=>r,scan:t?R:b,getToken:()=>i,getTokenValue:()=>s,getTokenOffset:()=>o,getTokenLength:()=>r-o,getTokenStartLine:()=>a,getTokenStartCharacter:()=>o-h,getTokenError:()=>f}}function lc(e){return e===32||e===9}function Cr(e){return e===10||e===13}function Rn(e){return e>=48&&e<=57}var Yf;(function(e){e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.space=32]="space",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.asterisk=42]="asterisk",e[e.backslash=92]="backslash",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.plus=43]="plus",e[e.slash=47]="slash",e[e.formFeed=12]="formFeed",e[e.tab=9]="tab"})(Yf||(Yf={}));new Array(20).fill(0).map((e,t)=>" ".repeat(t));const Fn=200;new Array(Fn).fill(0).map((e,t)=>`
`+" ".repeat(t)),new Array(Fn).fill(0).map((e,t)=>"\r"+" ".repeat(t)),new Array(Fn).fill(0).map((e,t)=>`\r
`+" ".repeat(t)),new Array(Fn).fill(0).map((e,t)=>`
`+"	".repeat(t)),new Array(Fn).fill(0).map((e,t)=>"\r"+"	".repeat(t)),new Array(Fn).fill(0).map((e,t)=>`\r
`+"	".repeat(t));var Jo;(function(e){e.DEFAULT={allowTrailingComma:!1}})(Jo||(Jo={}));function CR(e,t=[],n=Jo.DEFAULT){let r=null,s=[];const o=[];function i(a){Array.isArray(s)?s.push(a):r!==null&&(s[r]=a)}return BR(e,{onObjectBegin:()=>{const a={};i(a),o.push(s),s=a,r=null},onObjectProperty:a=>{r=a},onObjectEnd:()=>{s=o.pop()},onArrayBegin:()=>{const a=[];i(a),o.push(s),s=a,r=null},onArrayEnd:()=>{s=o.pop()},onLiteralValue:i,onError:(a,u,h)=>{t.push({error:a,offset:u,length:h})}},n),s[0]}function BR(e,t,n=Jo.DEFAULT){const r=DR(e,!1),s=[];let o=0;function i(N){return N?()=>o===0&&N(r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter()):()=>!0}function c(N){return N?W=>o===0&&N(W,r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter()):()=>!0}function a(N){return N?W=>o===0&&N(W,r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter(),()=>s.slice()):()=>!0}function u(N){return N?()=>{o>0?o++:N(r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter(),()=>s.slice())===!1&&(o=1)}:()=>!0}function h(N){return N?()=>{o>0&&o--,o===0&&N(r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter())}:()=>!0}const f=u(t.onObjectBegin),d=a(t.onObjectProperty),g=h(t.onObjectEnd),y=u(t.onArrayBegin),E=h(t.onArrayEnd),b=a(t.onLiteralValue),w=c(t.onSeparator),R=i(t.onComment),m=c(t.onError),T=n&&n.disallowComments,O=n&&n.allowTrailingComma;function S(){for(;;){const N=r.scan();switch(r.getTokenError()){case 4:_(14);break;case 5:_(15);break;case 3:_(13);break;case 1:T||_(11);break;case 2:_(12);break;case 6:_(16);break}switch(N){case 12:case 13:T?_(10):R();break;case 16:_(1);break;case 15:case 14:break;default:return N}}}function _(N,W=[],pe=[]){if(m(N),W.length+pe.length>0){let ee=r.getToken();for(;ee!==17;){if(W.indexOf(ee)!==-1){S();break}else if(pe.indexOf(ee)!==-1)break;ee=S()}}}function F(N){const W=r.getTokenValue();return N?b(W):(d(W),s.push(W)),S(),!0}function J(){switch(r.getToken()){case 11:const N=r.getTokenValue();let W=Number(N);isNaN(W)&&(_(2),W=0),b(W);break;case 7:b(null);break;case 8:b(!0);break;case 9:b(!1);break;default:return!1}return S(),!0}function V(){return r.getToken()!==10?(_(3,[],[2,5]),!1):(F(!1),r.getToken()===6?(w(":"),S(),Te()||_(4,[],[2,5])):_(5,[],[2,5]),s.pop(),!0)}function D(){f(),S();let N=!1;for(;r.getToken()!==2&&r.getToken()!==17;){if(r.getToken()===5){if(N||_(4,[],[]),w(","),S(),r.getToken()===2&&O)break}else N&&_(6,[],[]);V()||_(4,[],[2,5]),N=!0}return g(),r.getToken()!==2?_(7,[2],[]):S(),!0}function Q(){y(),S();let N=!0,W=!1;for(;r.getToken()!==4&&r.getToken()!==17;){if(r.getToken()===5){if(W||_(4,[],[]),w(","),S(),r.getToken()===4&&O)break}else W&&_(6,[],[]);N?(s.push(0),N=!1):s[s.length-1]++,Te()||_(4,[],[4,5]),W=!0}return E(),N||s.pop(),r.getToken()!==4?_(8,[4],[]):S(),!0}function Te(){switch(r.getToken()){case 3:return Q();case 1:return D();case 10:return F(!0);default:return J()}}return S(),r.getToken()===17?n.allowEmptyContent?!0:(_(4,[],[]),!1):Te()?(r.getToken()!==17&&_(9,[],[]),!0):(_(4,[],[]),!1)}var Qf;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(Qf||(Qf={}));var Zf;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(Zf||(Zf={}));const KR=CR;var Xf;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(Xf||(Xf={}));const qR=Vu("fetch text")(e=>Co(()=>fetch(e).then(t=>t.text()))),JR=Vu("parse jsonc")(e=>TI(()=>KR(e)));function ZF(e){return new URLSearchParams(location.search).get(e)}class Ln extends Tm()("MonacoInstanceProvider",{effect:Do(function*(){const{default:t}=yield*Co(()=>UR(()=>import("./index.DJPvpCLQ.js"),[]));t.config({paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@latest/min/vs"}});const n=yield*Co(()=>t.init());return yield*zR(n),n})}){}class VR extends md("TypescriptSettings")(){}const zR=Vu("setup TypeScript options")(function*(e){const t=yield*vI(VR);if(t._tag=="None")return yield*Bo("TypeScript configuration not provided");yield*Bo("setup TypeScript"),e.languages.typescript.typescriptDefaults.setCompilerOptions({...e.languages.typescript.typescriptDefaults.getCompilerOptions(),moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,typeRoots:["node_modules"],strict:!0,skipLibCheck:!0});for(const{dts_url:n,entryName:r,packageName:s}of t.value.packages){const o=yield*qR(n),i=`node_modules/${s}/${r}.d.ts`;e.languages.typescript.typescriptDefaults.addExtraLib(o,i)}});class Vo extends md("EditorModel")(){static typescript=Lf(Vo,Do(function*(){const t=yield*Ln,n=t.editor.createModel("","typescript");yield*Bo("created typescript model",n.uri);let r;const s=async()=>(r||(r=await(await t.languages.typescript.getTypeScriptWorker())(n.uri)),await r.getEmitOutput(n.uri.toString()));return{language:"typescript",model:n,majorCodes:new Set([8]),getCode(){return Co(()=>s()).pipe(Af(o=>FI(o.outputFiles[0].text)))}}})).pipe(xf(Ln.Default));static json=Lf(Vo,Do(function*(){const n=(yield*Ln).editor.createModel("{}","json");return yield*Bo("created json model",n.uri),{language:"json",model:n,majorCodes:new Set([4,8]),getCode(){return JR(n.getValue()).pipe(Af(JSON.stringify))}}})).pipe(xf(Ln.Default))}class WR extends Es()("EditorDefaults",{defaultValue(){return{container:"code-editor",options:{contextmenu:!1,minimap:{enabled:!1},automaticLayout:!0},model:{}}}}){}class XF extends Tm()("EditorProvider",{scoped:Do(function*(){const t=yield*Ln,n=yield*WR,{model:r,majorCodes:s}=yield*Vo;let o;return yield*EI(()=>(console.log("effect editor dispose"),o?.dispose(),Ue)),{bindEditor:()=>{if(o)return console.log("editor is already bound"),o;const a=document.getElementById(n.container);if(!a)throw Error(`HTML container for monaco editor not found, expected '${n.container}'`);return o=t.editor.create(a,{model:r,...n.options}),o.onDidDispose(()=>{console.log("unmounting cleanup"),o=void 0}),o},hasMajorError:()=>{const u=t.editor.getModelMarkers({resource:r.uri}).find(h=>s.has(h.severity.valueOf()));return u?(console.log("editor code error",u),!0):!1}}}),dependencies:[Ln.Default]}){}export{Qn as $,vF as A,xf as B,QF as C,IF as D,XF as E,RF as F,FF as G,OF as H,gF as I,Tt as J,GR as K,LF as L,Ln as M,re as N,p as O,YR as P,zy as Q,QR as R,Tm as S,Ah as T,NR as U,K as V,A as W,he as X,we as Y,nt as Z,ft as _,B as a,dF as a$,G as a0,k as a1,Ku as a2,Y as a3,tT as a4,Ya as a5,vs as a6,Sd as a7,cF as a8,v as a9,ue as aA,Lp as aB,Es as aC,$F as aD,VR as aE,EI as aF,Ue as aG,VF as aH,mR as aI,Lm as aJ,pR as aK,NF as aL,yF as aM,wF as aN,mF as aO,bF as aP,TF as aQ,II as aR,EF as aS,sm as aT,uF as aU,bI as aV,md as aW,hF as aX,pF as aY,fF as aZ,yf as a_,sn as aa,I as ab,_u as ac,lu as ad,Z as ae,fi as af,Kt as ag,d0 as ah,sT as ai,at as aj,Q0 as ak,x as al,Je as am,Yb as an,wi as ao,Yg as ap,Fi as aq,u$ as ar,vu as as,Qg as at,Pp as au,Op as av,Xe as aw,rF as ax,Gb as ay,aF as az,Vo as b,kF as b0,SF as b1,kI as b2,_F as b3,oe as c,l as d,YF as e,pr as f,Do as g,P as h,jF as i,BF as j,zF as k,Bo as l,GF as m,wa as n,KF as o,M as p,vc as q,oF as r,C as s,sF as t,Vu as u,ZF as v,qR as w,Af as x,JR as y,AF as z};
