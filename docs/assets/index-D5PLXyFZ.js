var fs=Object.defineProperty;var ds=(e,t,n)=>t in e?fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var a=(e,t,n)=>ds(e,typeof t!="symbol"?t+"":t,n);import{i as hs,h as Pn,a as ps,b as de,c as ot,d as Rt,e as xt,f as Kt,g as ms,j as ve,k as Y,l as gs,o as fe,m as V,s as Ie,n as De,p as ys,q as bs,r as Bt,t as Ss,u as Ne,v as ws,w as xs,x as Es,y as ks,O as Ts,z as In,A as Et,B as v,C as $n,D as Rn,N as Mt,E as je,F as Ft,G as Kn,H as le,Y as Os,I as te,J as _s,K as kt,L as vs,M as pe,P as Bn,Q as Mn,R as Ns,S as B,T as ae,U as Ce,V as Tt,W as Fn,X as Ot,Z as _,_ as Cn,$ as Un,a0 as Jn,a1 as Dn,a2 as jn,a3 as As,a4 as U,a5 as Ps,a6 as Is,a7 as $s,a8 as Rs,a9 as Ks,aa as Bs,ab as Ms,ac as Fs,ad as Cs,ae as Us,af as Ue,ag as tn,ah as Js,ai as Ds,aj as js,ak as Ls,al as Hs,am as qs,an as dt,ao as Ge,ap as C,aq as X,ar as xe,as as Ze,at as Ws,au as k,av as G,aw as Qe,ax as zs,ay as at,az as Vs,aA as Gs,aB as Qs,aC as Ys,aD as Xs,aE as Ln,aF as Zs,aG as Hn,aH as eo,aI as _t,aJ as qn,aK as to,aL as Wn,aM as Ct,aN as ht,aO as no,aP as Ut,aQ as ro,aR as so,aS as oo,aT as ao,aU as io,aV as zn,aW as Jt,aX as Dt,aY as nn,aZ as co,a_ as rn,a$ as Vn,b0 as lo,b1 as uo,b2 as fo,b3 as sn,b4 as jt,b5 as Gn,b6 as ho,b7 as f,b8 as po,b9 as mo,ba as go,bb as Qn,bc as Ye,bd as yo,be as Lt,bf as bo,bg as So,bh as wo,bi as Yn,bj as xo,bk as Eo,bl as ko,bm as To,bn as Oo,bo as Xn,bp as Ht,bq as st,br as vt,bs as Nt,bt as _o,bu as vo,bv as No,bw as Ao,bx as Po}from"./editor-DyfgHjHZ.js";const Zn=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return Zn(e,t.from)}},_e=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),er=e=>{let t=!1,n;return()=>(t||(n=e(),t=!0),n)},Io=e=>{try{return e.toISOString()}catch{return String(e)}},se=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(n=>se(n,t)).join(",")}]`;if(hs(e))return Io(e);if(Pn(e,"toString")&&ps(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();if(de(e))return JSON.stringify(e);if(ot(e)||e==null||Rt(e)||xt(e))return String(e);if(Kt(e))return String(e)+"n";if(ms(e))return`${e.constructor.name}(${se(Array.from(e),t)})`;try{t&&JSON.stringify(e);const n=`{${_e(e).map(s=>`${de(s)?JSON.stringify(s):String(s)}:${se(e[s],!1)}`).join(",")}}`,r=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${r}(${n})`:n}catch{return"<circular structure>"}},$o=e=>typeof e=="string"?JSON.stringify(e):String(e),tr=e=>Array.isArray(e),on=e=>`[${$o(e)}]`,Ro=e=>tr(e)?e.map(on).join(""):on(e),be=(e,t,n,r)=>{let s=e;return t!==void 0&&(s+=`
details: ${t}`),r&&(s+=`
schema (${r._tag}): ${r}`),s},Ko=e=>be("Unsupported key schema",void 0,void 0,e),Bo=e=>be("Unsupported literal",`literal value: ${se(e)}`),an=e=>be("Duplicate index signature",`${e} index signature`),Mo=be("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),Fo=be("Invalid element","A required element cannot follow an optional element. ts(1257)"),cn=e=>be("Duplicate property signature transformation",`Duplicate key ${se(e)}`),Co=e=>be("Duplicate property signature",`Duplicate key ${se(e)}`),Uo=Symbol.for("effect/annotation/Brand"),Jo=Symbol.for("effect/annotation/SchemaId"),nr=Symbol.for("effect/annotation/Message"),qt=Symbol.for("effect/annotation/MissingMessage"),rr=Symbol.for("effect/annotation/Identifier"),Se=Symbol.for("effect/annotation/Title"),At=Symbol.for("effect/annotation/AutoTitle"),it=Symbol.for("effect/annotation/Description"),sr=Symbol.for("effect/annotation/Examples"),or=Symbol.for("effect/annotation/Default"),ar=Symbol.for("effect/annotation/JSONSchema"),ir=Symbol.for("effect/annotation/Arbitrary"),cr=Symbol.for("effect/annotation/Pretty"),lr=Symbol.for("effect/annotation/Equivalence"),Do=Symbol.for("effect/annotation/Documentation"),ur=Symbol.for("effect/annotation/Concurrency"),fr=Symbol.for("effect/annotation/Batching"),dr=Symbol.for("effect/annotation/ParseIssueTitle"),hr=Symbol.for("effect/annotation/ParseOptions"),pr=Symbol.for("effect/annotation/DecodingFallback"),mr=Symbol.for("effect/annotation/Surrogate"),jo=Symbol.for("effect/annotation/StableFilter"),D=V(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?Ie(e.annotations[t]):De()),Lo=D(Uo),Ho=D(nr),qo=D(qt),gr=D(Se),yr=D(At),ct=D(rr),br=D(it),Wo=D(ur),zo=D(fr),Vo=D(dr),Go=D(hr),Qo=D(pr),Sr=D(mr),Yo=D(jo),Xo=e=>xs(Yo(e),t=>t===!0),wr=Symbol.for("effect/annotation/JSONIdentifier"),Zo=D(wr),ea=e=>fe(Zo(e),()=>ct(e));class xr{constructor(t,n,r,s={}){a(this,"typeParameters");a(this,"decodeUnknown");a(this,"encodeUnknown");a(this,"annotations");a(this,"_tag","Declaration");this.typeParameters=t,this.decodeUnknown=n,this.encodeUnknown=r,this.annotations=s}toString(){return Y(oe(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:R(this.annotations)}}}const Le=e=>t=>t._tag===e;let Pt=class{constructor(t,n={}){a(this,"literal");a(this,"annotations");a(this,"_tag","Literal");this.literal=t,this.annotations=n}toString(){return Y(oe(this),()=>se(this.literal))}toJSON(){return{_tag:this._tag,literal:Kt(this.literal)?String(this.literal):this.literal,annotations:R(this.annotations)}}};const ln=Le("Literal");class ta{constructor(t,n={}){a(this,"symbol");a(this,"annotations");a(this,"_tag","UniqueSymbol");this.symbol=t,this.annotations=n}toString(){return Y(oe(this),()=>se(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:R(this.annotations)}}}class na{constructor(t={}){a(this,"annotations");a(this,"_tag","NeverKeyword");this.annotations=t}toString(){return He(this)}toJSON(){return{_tag:this._tag,annotations:R(this.annotations)}}}const Er=new na({[Se]:"never"});class ra{constructor(t={}){a(this,"annotations");a(this,"_tag","UnknownKeyword");this.annotations=t}toString(){return He(this)}toJSON(){return{_tag:this._tag,annotations:R(this.annotations)}}}const kr=new ra({[Se]:"unknown"});class sa{constructor(t={}){a(this,"annotations");a(this,"_tag","AnyKeyword");this.annotations=t}toString(){return He(this)}toJSON(){return{_tag:this._tag,annotations:R(this.annotations)}}}const oa=new sa({[Se]:"any"});class aa{constructor(t={}){a(this,"annotations");a(this,"_tag","StringKeyword");this.annotations=t}toString(){return He(this)}toJSON(){return{_tag:this._tag,annotations:R(this.annotations)}}}const ia=new aa({[Se]:"string",[it]:"a string"}),ca=Le("StringKeyword");class la{constructor(t={}){a(this,"annotations");a(this,"_tag","NumberKeyword");this.annotations=t}toString(){return He(this)}toJSON(){return{_tag:this._tag,annotations:R(this.annotations)}}}const ua=new la({[Se]:"number",[it]:"a number"}),fa=Le("SymbolKeyword");let Wt=class{constructor(t,n={}){a(this,"type");a(this,"annotations");this.type=t,this.annotations=n}toJSON(){return{type:this.type.toJSON(),annotations:R(this.annotations)}}toString(){return String(this.type)}};class zt extends Wt{constructor(n,r,s={}){super(n,s);a(this,"isOptional");this.isOptional=r}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:R(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const Tr=e=>e.map(t=>t.type);class Or{constructor(t,n,r,s={}){a(this,"elements");a(this,"rest");a(this,"isReadonly");a(this,"annotations");a(this,"_tag","TupleType");this.elements=t,this.rest=n,this.isReadonly=r,this.annotations=s;let o=!1,i=!1;for(const u of t)if(u.isOptional)o=!0;else if(o){i=!0;break}if(i||o&&n.length>1)throw new Error(Fo)}toString(){return Y(oe(this),()=>da(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:R(this.annotations)}}}const da=e=>{const t=e.elements.map(String).join(", ");return ys(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const s=String(n),o=s.includes(" | ")?`(${s})`:s;if(r.length>0){const i=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${o}[], ${i}]`:`readonly [...${o}[], ${i}]`}else return e.elements.length>0?`readonly [${t}, ...${o}[]]`:`ReadonlyArray<${s}>`}})};class M extends zt{constructor(n,r,s,o,i){super(r,s,i);a(this,"name");a(this,"isReadonly");this.name=n,this.isReadonly=o}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:R(this.annotations)}}}const _r=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return _r(e.from)}return!1};class lt{constructor(t,n,r){a(this,"type");a(this,"isReadonly");a(this,"parameter");if(this.type=n,this.isReadonly=r,_r(t))this.parameter=t;else throw new Error(Mo)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class me{constructor(t,n,r={}){a(this,"annotations");a(this,"_tag","TypeLiteral");a(this,"propertySignatures");a(this,"indexSignatures");this.annotations=r;const s={};for(let i=0;i<t.length;i++){const u=t[i].name;if(Object.prototype.hasOwnProperty.call(s,u))throw new Error(Co(u));s[u]=null}const o={string:!1,symbol:!1};for(let i=0;i<n.length;i++){const u=Kr(n[i].parameter);if(ca(u)){if(o.string)throw new Error(an("string"));o.string=!0}else if(fa(u)){if(o.symbol)throw new Error(an("symbol"));o.symbol=!0}}this.propertySignatures=t,this.indexSignatures=n}toString(){return Y(oe(this),()=>ha(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:R(this.annotations)}}}const un=e=>e.map(String).join("; "),ha=e=>{if(e.propertySignatures.length>0){const t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${un(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${un(e.indexSignatures)} }`:"{}"},pa=Es(ks(Ts,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),ma={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},vr=e=>bs(e,t=>Nr(t)?vr(t.types):[t]),ga=e=>{const t=pa(e),n=[],r={},s=[];for(const o of t)switch(o._tag){case"NeverKeyword":break;case"AnyKeyword":return[oa];case"UnknownKeyword":return[kr];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{r[o._tag]||(r[o._tag]=o,n.push(o));break}case"Literal":{const i=typeof o.literal;switch(i){case"string":case"number":case"bigint":case"boolean":{const u=ma[i];!r[u]&&!s.includes(o.literal)&&(s.push(o.literal),n.push(o));break}case"object":{s.includes(o.literal)||(s.push(o.literal),n.push(o));break}}break}case"UniqueSymbol":{!r.SymbolKeyword&&!s.includes(o.symbol)&&(s.push(o.symbol),n.push(o));break}case"TupleType":{r.ObjectKeyword||n.push(o);break}case"TypeLiteral":{o.propertySignatures.length===0&&o.indexSignatures.length===0?r["{}"]||(r["{}"]=o,n.push(o)):r.ObjectKeyword||n.push(o);break}default:n.push(o)}return n};var ie;let ne=(ie=class{constructor(t,n={}){a(this,"types");a(this,"annotations");a(this,"_tag","Union");this.types=t,this.annotations=n}toString(){return Y(oe(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:R(this.annotations)}}},a(ie,"make",(t,n)=>Vt(t)?new ie(t,n):t.length===1?t[0]:Er),a(ie,"unify",(t,n)=>ie.make(ga(vr(t)),n)),ie);const ya=(e,t)=>e.map(t),Vt=e=>e.length>1,Nr=Le("Union"),pt=In(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class Ar{constructor(t,n={}){a(this,"f");a(this,"annotations");a(this,"_tag","Suspend");this.f=t,this.annotations=n,this.f=er(t)}toString(){return oe(this).pipe(fe(()=>Bt(Ss(this.f)(),t=>oe(t))),Y(()=>"<suspended schema>"))}toJSON(){const t=this.f();let n=pt.get(t);return n||(pt.set(t,{_tag:this._tag}),n={_tag:this._tag,ast:t.toJSON(),annotations:R(this.annotations)},pt.set(t,n),n)}}let ba=class{constructor(t,n,r={}){a(this,"from");a(this,"filter");a(this,"annotations");a(this,"_tag","Refinement");this.from=t,this.filter=n,this.annotations=r}toString(){return ct(this).pipe(Y(()=>Ne(Br(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>Pr(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:R(this.annotations)}}};const Pr=Le("Refinement"),mt={};let Sa=class{constructor(t,n,r,s={}){a(this,"from");a(this,"to");a(this,"transformation");a(this,"annotations");a(this,"_tag","Transformation");this.from=t,this.to=n,this.transformation=r,this.annotations=s}toString(){return Y(oe(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:R(this.annotations)}}};class wa{constructor(t,n,r,s){a(this,"from");a(this,"to");a(this,"decode");a(this,"encode");this.from=t,this.to=n,this.decode=r,this.encode=s}}class xa{constructor(t){a(this,"propertySignatureTransformations");a(this,"_tag","TypeLiteralTransformation");this.propertySignatureTransformations=t;const n={},r={};for(const s of t){const o=s.from;if(n[o])throw new Error(cn(o));n[o]=!0;const i=s.to;if(r[i])throw new Error(cn(i));r[i]=!0}}}const Ae=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={...e.annotations,...t},s=Sr(e);return ve(s)&&(r[mr]=Ae(s.value,t)),n.annotations.value=r,Object.create(Object.getPrototypeOf(e),n)},Ea="[\\s\\S]*",ka="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",Ir=(e,t)=>{switch(e._tag){case"Literal":return Et(String(e.literal));case"StringKeyword":return Ea;case"NumberKeyword":return ka;case"TemplateLiteral":return $r(e);case"Union":return e.types.map(n=>Ir(n)).join("|")}},Ta=(e,t,n,r)=>Nr(e)?`(${t})`:t,$r=(e,t,n)=>{let r="";if(e.head!==""){const s=Et(e.head);r+=s}for(const s of e.spans){const o=Ir(s.type);if(r+=Ta(s.type,o),s.literal!==""){const i=Et(s.literal);r+=i}}return r},Oa=e=>new RegExp(`^${$r(e)}$`),fn=(e,t)=>{const n=[],r=[],s=o=>{switch(o._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new lt(o,t,!0));break;case"Literal":if(de(o.literal)||ot(o.literal))n.push(new M(o.literal,t,!1,!0));else throw new Error(Bo(o.literal));break;case"Enums":{for(const[i,u]of o.enums)n.push(new M(u,t,!1,!0));break}case"UniqueSymbol":n.push(new M(o.symbol,t,!1,!0));break;case"Union":o.types.forEach(s);break;default:throw new Error(Ko(o))}};return s(e),{propertySignatures:n,indexSignatures:r}},Rr=e=>t=>{let n;for(const r of e)Object.prototype.hasOwnProperty.call(t.annotations,r)&&(n===void 0&&(n={}),n[r]=t.annotations[r]);return n},_a=Rr([sr,or,ar,ir,cr,lr]),J=e=>{switch(e._tag){case"Declaration":{const t=z(e.typeParameters,J);return t===e.typeParameters?e:new xr(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=z(e.elements,s=>{const o=J(s.type);return o===s.type?s:new zt(o,s.isOptional)}),n=Tr(e.rest),r=z(n,J);return t===e.elements&&r===n?e:new Or(t,r.map(s=>new Wt(s)),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=z(e.propertySignatures,r=>{const s=J(r.type);return s===r.type?r:new M(r.name,s,r.isOptional,r.isReadonly)}),n=z(e.indexSignatures,r=>{const s=J(r.type);return s===r.type?r:new lt(r.parameter,s,r.isReadonly)});return t===e.propertySignatures&&n===e.indexSignatures?e:new me(t,n,e.annotations)}case"Union":{const t=z(e.types,J);return t===e.types?e:ne.make(t,e.annotations)}case"Suspend":return new Ar(()=>J(e.f()),e.annotations);case"Refinement":{const t=J(e.from);return t===e.from?e:new ba(t,e.filter,e.annotations)}case"Transformation":{const t=_a(e);return J(t!==void 0?Ae(e.to,t):e.to)}}return e},Ee=e=>Ne(ea(e),{onNone:()=>{},onSome:t=>({[wr]:t})});function z(e,t){let n=!1;const r=gs(e.length);for(let s=0;s<e.length;s++){const o=e[s],i=t(o);i!==o&&(n=!0),r[s]=i}return n?r:e}const Z=(e,t)=>{switch(e._tag){case"Declaration":{const n=z(e.typeParameters,r=>Z(r));return n===e.typeParameters?e:new xr(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=z(e.elements,o=>{const i=Z(o.type);return i===o.type?o:new zt(i,o.isOptional)}),r=Tr(e.rest),s=z(r,o=>Z(o));return n===e.elements&&s===r?e:new Or(n,s.map(o=>new Wt(o)),e.isReadonly,Ee(e))}case"TypeLiteral":{const n=z(e.propertySignatures,s=>{const o=Z(s.type);return o===s.type?s:new M(s.name,o,s.isOptional,s.isReadonly)}),r=z(e.indexSignatures,s=>{const o=Z(s.type);return o===s.type?s:new lt(s.parameter,o,s.isReadonly)});return n===e.propertySignatures&&r===e.indexSignatures?e:new me(n,r,Ee(e))}case"Union":{const n=z(e.types,r=>Z(r));return n===e.types?e:ne.make(n,Ee(e))}case"Suspend":return new Ar(()=>Z(e.f()),Ee(e));case"Refinement":{const n=Z(e.from),r=Ee(e);return r?Ae(n,r):n}case"Transformation":{const n=Ee(e);return Z(n?Ae(e.from,n):e.from)}}return e},dn=e=>Z(e),R=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},Kr=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Kr(e.from)}},He=e=>Y(oe(e),()=>e._tag);function va(e){return Ne(Lo(e),{onNone:()=>"",onSome:t=>t.map(n=>` & Brand<${se(n)}>`).join("")})}const Br=e=>gr(e).pipe(fe(()=>br(e)),fe(()=>yr(e)),ws(t=>t+va(e))),oe=e=>fe(ct(e),()=>Br(e)),hn=Symbol.for("effect/Brand/Refined"),Na=()=>Object.assign(e=>e,{[hn]:hn,option:e=>Ie(e),either:e=>v(e),is:e=>!0}),pn=Symbol.for("effect/MutableList"),Aa={[pn]:pn,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(t==null)return e=!0,this.return();const n=t.value;return t=t.next,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},toString(){return $n(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(Rn)}},[Mt](){return this.toJSON()},pipe(){return je(this,arguments)}},Pa=e=>({value:e,removed:!1,prev:void 0,next:void 0}),Ia=()=>{const e=Object.create(Aa);return e.head=void 0,e.tail=void 0,e._length=0,e},Mr=e=>Fr(e)===0,Fr=e=>e._length,$a=V(2,(e,t)=>{const n=Pa(t);return e.head===void 0&&(e.head=n),e.tail===void 0||(e.tail.next=n,n.prev=e.tail),e.tail=n,e._length+=1,e}),Ra=e=>{const t=e.head;if(t!==void 0)return Ka(e,t),t.value},Ka=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))},mn=Symbol.for("effect/MutableQueue"),ce=Symbol.for("effect/mutable/MutableQueue/Empty"),Ba={[mn]:mn,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return $n(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(Rn)}},[Mt](){return this.toJSON()},pipe(){return je(this,arguments)}},Ma=e=>{const t=Object.create(Ba);return t.queue=Ia(),t.capacity=e,t},Fa=()=>Ma(void 0),et=e=>Mr(e.queue),Cr=V(2,(e,t)=>{const n=Fr(e.queue);return e.capacity!==void 0&&n===e.capacity?!1:($a(t)(e.queue),!0)}),Ca=V(2,(e,t)=>{const n=t[Symbol.iterator]();let r,s=le(),o=!0;for(;o&&(r=n.next())&&!r.done;)o=Cr(r.value)(e);for(;r!=null&&!r.done;)s=Ft(r.value)(s),r=n.next();return Kn(s)}),Ur=V(2,(e,t)=>Mr(e.queue)?t:Ra(e.queue)),Ua=V(2,(e,t)=>{let n=le(),r=0;for(;r<t;){const s=Ur(ce)(e);if(s===ce)break;n=Ft(s)(n),r+=1}return Kn(n)}),Ja=function(){const e=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends Os{constructor(n){super(n==null?void 0:n.message,n!=null&&n.cause?{cause:n.cause}:void 0),n&&(Object.assign(this,n),Object.defineProperty(this,e,{value:n,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}.BaseEffectError}(),Jr=e=>{const t={BaseEffectError:class extends Ja{constructor(){super(...arguments);a(this,"_tag",e)}}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError},Da=e=>{let t=e[0];for(let n=1;n<e.length;n++)t+=e[n]==="_"?e[++n].toUpperCase():e[n];return t},ja="effect/QueueEnqueue",La=Symbol.for(ja),Ha="effect/QueueDequeue",Dr=Symbol.for(Ha),qa={_In:e=>e},jr={_Out:e=>e},re=Symbol.for("effect/PubSub/AbsentValue"),Lr=(e,t)=>n=>{n.has(e)||n.set(e,new Set),n.get(e).add(t)},Wa=(e,t)=>n=>{if(!n.has(e))return;const r=n.get(e);r.delete(t),r.size===0&&n.delete(e)},za=e=>te(()=>{const t=Ga(e);return ni(t,new li)}),Va=e=>e.shutdown,Ga=e=>new Xa(e!=null&&e.replay?new di(e.replay):void 0),Qa=(e,t,n)=>pe(Bn(),r=>Ya(e,t,e.subscribe(),Fa(),r,Mn(!1),n)),Ya=(e,t,n,r,s,o,i)=>new ei(e,t,n,r,s,o,i,e.replayWindow());class Xa{constructor(t){a(this,"replayBuffer");a(this,"publisherHead",{value:re,subscribers:0,next:null});a(this,"publisherTail",this.publisherHead);a(this,"publisherIndex",0);a(this,"subscribersIndex",0);a(this,"capacity",Number.MAX_SAFE_INTEGER);this.replayBuffer=t}replayWindow(){return this.replayBuffer?new hi(this.replayBuffer):pi}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(t){const n=this.publisherTail.subscribers;return n!==0&&(this.publisherTail.next={value:t,subscribers:n,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(t),!0}publishAll(t){if(this.publisherTail.subscribers!==0)for(const n of t)this.publish(n);else this.replayBuffer&&this.replayBuffer.offerAll(t);return le()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=re,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new Za(this,this.publisherTail,this.publisherIndex,!1)}}class Za{constructor(t,n,r,s){a(this,"self");a(this,"subscriberHead");a(this,"subscriberIndex");a(this,"unsubscribed");this.self=t,this.subscriberHead=n,this.subscriberIndex=r,this.unsubscribed=s}isEmpty(){if(this.unsubscribed)return!0;let t=!0,n=!0;for(;n;)this.subscriberHead===this.self.publisherTail?n=!1:this.subscriberHead.next.value!==re?(t=!1,n=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return t}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(t){if(this.unsubscribed)return t;let n=!0,r=t;for(;n;)if(this.subscriberHead===this.self.publisherTail)n=!1;else{const s=this.subscriberHead.next.value;s!==re&&(r=s,this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=re,this.self.subscribersIndex+=1),n=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(t){const n=[],r=re;let s=0;for(;s!==t;){const o=this.poll(r);o===r?s=t:(n.push(o),s+=1)}return _s(n)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==re&&(this.subscriberHead.subscribers-=1,this.subscriberHead.subscribers===0&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=re,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}var On,_n;class ei extends(_n=Ms,On=Dr,_n){constructor(n,r,s,o,i,u,h,c){super();a(this,"pubsub");a(this,"subscribers");a(this,"subscription");a(this,"pollers");a(this,"shutdownHook");a(this,"shutdownFlag");a(this,"strategy");a(this,"replayWindow");a(this,On,jr);this.pubsub=n,this.subscribers=r,this.subscription=s,this.pollers=o,this.shutdownHook=i,this.shutdownFlag=u,this.strategy=h,this.replayWindow=c}commit(){return this.take}pipe(){return je(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!B(this.shutdownFlag)}get size(){return te(()=>B(this.shutdownFlag)?ae:U(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return B(this.shutdownFlag)?De():Ie(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return te(()=>B(this.shutdownFlag)?ae:U(this.subscription.size()===this.capacity()))}get isEmpty(){return pe(this.size,n=>n===0)}get shutdown(){return Fn(Ot(n=>(Cn(this.shutdownFlag,!0),_(Fs(Gt(this.pollers),r=>Ls(r,n.id()),!1),jn(Ce(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),Jn(Dn(this.shutdownHook,void 0)),Un))))}get isShutdown(){return Ce(()=>B(this.shutdownFlag))}get awaitShutdown(){return Tt(this.shutdownHook)}get take(){return Ot(n=>{if(B(this.shutdownFlag))return ae;if(this.replayWindow.remaining>0){const s=this.replayWindow.take();return U(s)}const r=et(this.pollers)?this.subscription.poll(ce):ce;if(r===ce){const s=Cs(n.id());return _(te(()=>(_(this.pollers,Cr(s)),_(this.subscribers,Lr(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),B(this.shutdownFlag)?ae:Tt(s))),Us(()=>Ce(()=>ci(this.pollers,s))))}else return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),U(r)})}get takeAll(){return te(()=>{if(B(this.shutdownFlag))return ae;const n=et(this.pollers)?oi(this.subscription):le();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0?U(Ue(this.replayWindow.takeAll(),n)):U(n)})}takeUpTo(n){return te(()=>{if(B(this.shutdownFlag))return ae;let r;if(this.replayWindow.remaining>=n){const o=this.replayWindow.takeN(n);return U(o)}else this.replayWindow.remaining>0&&(r=this.replayWindow.takeAll(),n=n-r.length);const s=et(this.pollers)?ai(this.subscription,n):le();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),r?U(Ue(r,s)):U(s)})}takeBetween(n,r){return te(()=>Hr(this,n,r,le()))}}const Hr=(e,t,n,r)=>n<t?U(r):_(e.takeUpTo(n),kt(s=>{const o=t-s.length;return o===1?_(e.take,pe(i=>_(r,Ue(s),tn(i)))):o>1?_(e.take,kt(i=>Hr(e,o-1,n-s.length-1,_(r,Ue(s),tn(i))))):U(_(r,Ue(s)))}));var vn,Nn;Nn=La,vn=Dr;class ti{constructor(t,n,r,s,o,i){a(this,"pubsub");a(this,"subscribers");a(this,"scope");a(this,"shutdownHook");a(this,"shutdownFlag");a(this,"strategy");a(this,Nn,qa);a(this,vn,jr);this.pubsub=t,this.subscribers=n,this.scope=r,this.shutdownHook=s,this.shutdownFlag=o,this.strategy=i}capacity(){return this.pubsub.capacity}get size(){return te(()=>B(this.shutdownFlag)?ae:Ce(()=>this.pubsub.size()))}unsafeSize(){return B(this.shutdownFlag)?De():Ie(this.pubsub.size())}get isFull(){return pe(this.size,t=>t===this.capacity())}get isEmpty(){return pe(this.size,t=>t===0)}get awaitShutdown(){return Tt(this.shutdownHook)}get isShutdown(){return Ce(()=>B(this.shutdownFlag))}get shutdown(){return Fn(Ot(t=>(_(this.shutdownFlag,Cn(!0)),_(this.scope.close(As(t.id())),jn(this.strategy.shutdown),Jn(Dn(this.shutdownHook,void 0)),Un))))}publish(t){return te(()=>B(this.shutdownFlag)?ae:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),U(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,Ps(t),this.shutdownFlag))}isActive(){return!B(this.shutdownFlag)}unsafeOffer(t){return B(this.shutdownFlag)?!1:this.pubsub.publish(t)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0):!1}publishAll(t){return te(()=>{if(B(this.shutdownFlag))return ae;const n=ii(this.pubsub,t);return this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),Is(n)?U(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,n,this.shutdownFlag)})}get subscribe(){const t=$s(Rs([this.scope.fork(Ks),Qa(this.pubsub,this.subscribers,this.strategy)]),n=>n[0].addFinalizer(()=>n[1].shutdown));return pe(Bs(t,(n,r)=>n[0].close(r)),n=>n[1])}offer(t){return this.publish(t)}offerAll(t){return this.publishAll(t)}pipe(){return je(this,arguments)}}const ni=(e,t)=>kt(vs(),n=>pe(Bn(),r=>ri(e,new Map,n,r,Mn(!1),t))),ri=(e,t,n,r,s,o)=>new ti(e,t,n,r,s,o),si=(e,t)=>{js(e,U(t))},qr=(e,t)=>_(e,Ca(t)),Gt=e=>_(e,Ua(Number.POSITIVE_INFINITY)),oi=e=>e.pollUpTo(Number.POSITIVE_INFINITY),ai=(e,t)=>e.pollUpTo(t),ii=(e,t)=>e.publishAll(t),ci=(e,t)=>{qr(e,_(Gt(e),Js(n=>n!==t)))};class li{get shutdown(){return Ds}handleSurplus(t,n,r,s){return U(!1)}unsafeOnPubSubEmptySpace(t,n){}unsafeCompletePollers(t,n,r,s){return ui(this,t,n,r,s)}unsafeCompleteSubscribers(t,n){return fi(this,t,n)}}const ui=(e,t,n,r,s)=>{let o=!0;for(;o&&!r.isEmpty();){const i=_(s,Ur(ce));if(i===ce)_(n,Wa(r,s)),et(s)?o=!1:_(n,Lr(r,s));else{const u=r.poll(ce);u===ce?qr(s,_(Gt(s),Ft(i))):(si(i,u),e.unsafeOnPubSubEmptySpace(t,n))}}},fi=(e,t,n)=>{for(const[r,s]of n)for(const o of s)e.unsafeCompletePollers(t,n,r,o)};class di{constructor(t){a(this,"capacity");a(this,"head",{value:re,next:null});a(this,"tail",this.head);a(this,"size",0);a(this,"index",0);this.capacity=t}slide(){this.index++}offer(t){this.tail.value=t,this.tail.next={value:re,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(t){for(const n of t)this.offer(n)}}class hi{constructor(t){a(this,"buffer");a(this,"head");a(this,"index");a(this,"remaining");this.buffer=t,this.index=t.index,this.remaining=t.size,this.head=t.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(this.remaining===0)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;const t=this.head.value;return this.head=this.head.next,t}takeN(t){if(this.remaining===0)return le();this.index<this.buffer.index&&this.fastForward();const n=Math.min(t,this.remaining),r=new Array(n);for(let s=0;s<n;s++){const o=this.head.value;this.head=this.head.next,r[s]=o}return this.remaining-=n,Ns(r)}takeAll(){return this.takeN(this.remaining)}}const pi={remaining:0,take:()=>{},takeN:()=>le(),takeAll:()=>le()},mi=za,gi=Va;class K{constructor(t,n,r){a(this,"path");a(this,"actual");a(this,"issue");a(this,"_tag","Pointer");this.path=t,this.actual=n,this.issue=r}}class gn{constructor(t,n){a(this,"actual");a(this,"message");a(this,"_tag","Unexpected");this.actual=t,this.message=n}}class Ke{constructor(t,n){a(this,"ast");a(this,"message");a(this,"_tag","Missing");a(this,"actual");this.ast=t,this.message=n}}class P{constructor(t,n,r,s){a(this,"ast");a(this,"actual");a(this,"issues");a(this,"output");a(this,"_tag","Composite");this.ast=t,this.actual=n,this.issues=r,this.output=s}}class gt{constructor(t,n,r,s){a(this,"ast");a(this,"actual");a(this,"kind");a(this,"issue");a(this,"_tag","Refinement");this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class yt{constructor(t,n,r,s){a(this,"ast");a(this,"actual");a(this,"kind");a(this,"issue");a(this,"_tag","Transformation");this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class ke{constructor(t,n,r){a(this,"ast");a(this,"actual");a(this,"message");a(this,"_tag","Type");this.ast=t,this.actual=n,this.message=r}}class yn{constructor(t,n,r){a(this,"ast");a(this,"actual");a(this,"message");a(this,"_tag","Forbidden");this.ast=t,this.actual=n,this.message=r}}const bn=Symbol.for("effect/Schema/ParseErrorTypeId");var An;class yi extends Jr("ParseError"){constructor(){super(...arguments);a(this,An,bn)}get message(){return this.toString()}toString(){return nt.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[(An=bn,Mt)](){return this.toJSON()}}const Wr=e=>new yi({issue:e}),j=Zs,ge=V(2,(e,t)=>j(e)?Hn(e,{onLeft:k,onRight:t}):X(e,t)),ee=V(2,(e,t)=>j(e)?eo(e,t):_t(e,t)),bt=V(2,(e,t)=>j(e)?qn(e,t):to(e,t)),zr=V(2,(e,t)=>j(e)?Hn(e,{onLeft:t,onRight:v}):Wn(e,t)),Vr=(e,t)=>t===void 0||ot(t)?e:e===void 0?t:{...e,...t},Gr=(e,t,n)=>{const r=W(e);return(s,o)=>r(s,Vr(n,o))},bi=(e,t,n)=>{const r=Gr(e,t,n);return(s,o)=>Hs(r(s,o),Wr)},Si=(e,t)=>bi(J(e.ast),!0,t),wi=(e,t)=>Gr(J(e.ast),!0,t),xi=In(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),W=(e,t)=>{const n=xi,r=n.get(e);if(r)return r;const s=Ei(e),o=Go(e),i=ve(o)?(c,l)=>s(c,Vr(l,o.value)):s,u=Qo(e),h=ve(u)?(c,l)=>tt(zr(i(c,l),u.value),e,c,l):i;return n.set(e,h),h},St=e=>Ct(Wo(e)),wt=e=>Ct(zo(e)),Ei=(e,t)=>{switch(e._tag){case"Refinement":{const n=W(e.from);return(r,s)=>{s=s??mt;const o=(s==null?void 0:s.errors)==="all",i=ge(zr(n(r,s),u=>{const h=new gt(e,r,"From",u);return o&&Xo(e)&&Xr(u)?Ne(e.filter(r,s,e),{onNone:()=>k(h),onSome:c=>k(new P(e,r,[h,new gt(e,r,"Predicate",c)]))}):k(h)}),u=>Ne(e.filter(u,s,e),{onNone:()=>v(u),onSome:h=>k(new gt(e,r,"Predicate",h))}));return tt(i,e,r,s)}}case"Transformation":{const n=Oi(e.transformation),r=W(e.from),s=W(e.to);return(o,i)=>tt(ge(bt(r(o,i),u=>new yt(e,o,"Encoded",u)),u=>ge(bt(n(u,i??mt,e,o),h=>new yt(e,o,"Transformation",h)),h=>bt(s(h,i),c=>new yt(e,o,"Type",c)))),e,o,i)}case"Declaration":{const n=e.decodeUnknown(...e.typeParameters);return(r,s)=>tt(n(r,s??mt,e),e,r,s)}case"Literal":return H(e,n=>n===e.literal);case"UniqueSymbol":return H(e,n=>n===e.symbol);case"UndefinedKeyword":return H(e,so);case"NeverKeyword":return H(e,ro);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return v;case"StringKeyword":return H(e,de);case"NumberKeyword":return H(e,ot);case"BooleanKeyword":return H(e,Rt);case"BigIntKeyword":return H(e,Kt);case"SymbolKeyword":return H(e,xt);case"ObjectKeyword":return H(e,Ut);case"Enums":return H(e,n=>e.enums.some(([r,s])=>s===n));case"TemplateLiteral":{const n=Oa(e);return H(e,r=>de(r)&&n.test(r))}case"TupleType":{const n=e.elements.map(c=>W(c.type)),r=e.rest.map(c=>W(c.type));let s=e.elements.filter(c=>!c.isOptional);e.rest.length>0&&(s=s.concat(e.rest.slice(1)));const o=s.length,i=e.elements.length>0?e.elements.map((c,l)=>l).join(" | "):"never",u=St(e),h=wt(e);return(c,l)=>{if(!zs(c))return k(new ke(e,c));const d=(l==null?void 0:l.errors)==="all",S=[];let p=0;const T=[],q=c.length;for(let b=q;b<=o-1;b++){const w=new K(b,c,new Ke(s[b-q]));if(d){S.push([p++,w]);continue}else return k(new P(e,c,w,T))}if(e.rest.length===0)for(let b=e.elements.length;b<=q-1;b++){const w=new K(b,c,new gn(c[b],`is unexpected, expected: ${i}`));if(d){S.push([p++,w]);continue}else return k(new P(e,c,w,T))}let g=0,m;for(;g<n.length;g++)if(q<g+1){if(e.elements[g].isOptional)continue}else{const b=n[g],w=b(c[g],l);if(j(w)){if(G(w)){const E=new K(g,c,w.left);if(d){S.push([p++,E]);continue}else return k(new P(e,c,E,Q(T)))}T.push([p++,w.right])}else{const E=p++,y=g;m||(m=[]),m.push(({es:x,output:O})=>X(xe(w),$=>{if(G($)){const A=new K(y,c,$.left);return d?(x.push([E,A]),C):k(new P(e,c,A,Q(O)))}return O.push([E,$.right]),C}))}}if(at(r)){const[b,...w]=r;for(;g<q-w.length;g++){const E=b(c[g],l);if(j(E))if(G(E)){const y=new K(g,c,E.left);if(d){S.push([p++,y]);continue}else return k(new P(e,c,y,Q(T)))}else T.push([p++,E.right]);else{const y=p++,x=g;m||(m=[]),m.push(({es:O,output:$})=>X(xe(E),A=>{if(G(A)){const N=new K(x,c,A.left);return d?(O.push([y,N]),C):k(new P(e,c,N,Q($)))}else return $.push([y,A.right]),C}))}}for(let E=0;E<w.length;E++)if(g+=E,!(q<g+1)){const y=w[E](c[g],l);if(j(y)){if(G(y)){const x=new K(g,c,y.left);if(d){S.push([p++,x]);continue}else return k(new P(e,c,x,Q(T)))}T.push([p++,y.right])}else{const x=p++,O=g;m||(m=[]),m.push(({es:$,output:A})=>X(xe(y),N=>{if(G(N)){const L=new K(O,c,N.left);return d?($.push([x,L]),C):k(new P(e,c,L,Q(A)))}return A.push([x,N.right]),C}))}}}const I=({es:b,output:w})=>ht(b)?k(new P(e,c,Q(b),Q(w))):v(Q(w));if(m&&m.length>0){const b=m;return Ge(()=>{const w={es:Qe(S),output:Qe(T)};return X(Ze(b,E=>E(w),{concurrency:u,batching:h,discard:!0}),()=>I(w))})}return I({output:T,es:S})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return H(e,no);const n=[],r={},s=[];for(const l of e.propertySignatures)n.push([W(l.type),l]),r[l.name]=null,s.push(l.name);const o=e.indexSignatures.map(l=>[W(l.parameter),W(l.type),l.parameter]),i=ne.make(e.indexSignatures.map(l=>l.parameter).concat(s.map(l=>xt(l)?new ta(l):new Pt(l)))),u=W(i),h=St(e),c=wt(e);return(l,d)=>{if(!Ws(l))return k(new ke(e,l));const S=(d==null?void 0:d.errors)==="all",p=[];let T=0;const q=(d==null?void 0:d.onExcessProperty)==="error",g=(d==null?void 0:d.onExcessProperty)==="preserve",m={};let I;if(q||g){I=_e(l);for(const y of I){const x=u(y,d);if(j(x)&&G(x))if(q){const O=new K(y,l,new gn(l[y],`is unexpected, expected: ${String(i)}`));if(S){p.push([T++,O]);continue}else return k(new P(e,l,O,m))}else m[y]=l[y]}}let b;const w=(d==null?void 0:d.exact)===!0;for(let y=0;y<n.length;y++){const x=n[y][1],O=x.name,$=Object.prototype.hasOwnProperty.call(l,O);if(!$){if(x.isOptional)continue;if(w){const L=new K(O,l,new Ke(x));if(S){p.push([T++,L]);continue}else return k(new P(e,l,L,m))}}const A=n[y][0],N=A(l[O],d);if(j(N)){if(G(N)){const L=new K(O,l,$?N.left:new Ke(x));if(S){p.push([T++,L]);continue}else return k(new P(e,l,L,m))}m[O]=N.right}else{const L=T++,ue=O;b||(b=[]),b.push(({es:we,output:Ve})=>X(xe(N),$e=>{if(G($e)){const Re=new K(ue,l,$?$e.left:new Ke(x));return S?(we.push([L,Re]),C):k(new P(e,l,Re,Ve))}return Ve[ue]=$e.right,C}))}}for(let y=0;y<o.length;y++){const x=o[y],O=x[0],$=x[1],A=Zn(l,x[2]);for(const N of A){const L=O(N,d);if(j(L)&&dt(L)){const ue=$(l[N],d);if(j(ue))if(G(ue)){const we=new K(N,l,ue.left);if(S){p.push([T++,we]);continue}else return k(new P(e,l,we,m))}else Object.prototype.hasOwnProperty.call(r,N)||(m[N]=ue.right);else{const we=T++,Ve=N;b||(b=[]),b.push(({es:$e,output:Re})=>X(xe(ue),ft=>{if(G(ft)){const en=new K(Ve,l,ft.left);return S?($e.push([we,en]),C):k(new P(e,l,en,Re))}else return Object.prototype.hasOwnProperty.call(r,N)||(Re[N]=ft.right),C}))}}}}const E=({es:y,output:x})=>{if(ht(y))return k(new P(e,l,Q(y),x));if((d==null?void 0:d.propertyOrder)==="original"){const O=I||_e(l);for(const A of s)O.indexOf(A)===-1&&O.push(A);const $={};for(const A of O)Object.prototype.hasOwnProperty.call(x,A)&&($[A]=x[A]);return v($)}return v(x)};if(b&&b.length>0){const y=b;return Ge(()=>{const x={es:Qe(p),output:Object.assign({},m)};return X(Ze(y,O=>O(x),{concurrency:h,batching:c,discard:!0}),()=>E(x))})}return E({es:p,output:m})}}case"Union":{const n=ki(e.types),r=_e(n.keys),s=r.length,o=e.types.length,i=new Map;for(let c=0;c<o;c++)i.set(e.types[c],W(e.types[c]));const u=St(e)??1,h=wt(e);return(c,l)=>{const d=[];let S=0,p=[];if(s>0)if(qs(c))for(let g=0;g<s;g++){const m=r[g],I=n.keys[m].buckets;if(Object.prototype.hasOwnProperty.call(c,m)){const b=String(c[m]);if(Object.prototype.hasOwnProperty.call(I,b))p=p.concat(I[b]);else{const{candidates:w,literals:E}=n.keys[m],y=ne.make(E),x=w.length===o?new me([new M(m,y,!1,!0)],[]):ne.make(w);d.push([S++,new P(x,c,new K(m,c,new ke(y,c[m])))])}}else{const{candidates:b,literals:w}=n.keys[m],E=new M(m,ne.make(w),!1,!0),y=b.length===o?new me([E],[]):ne.make(b);d.push([S++,new P(y,c,new K(m,c,new Ke(E)))])}}else{const g=n.candidates.length===o?e:ne.make(n.candidates);d.push([S++,new ke(g,c)])}n.otherwise.length>0&&(p=p.concat(n.otherwise));let T;for(let g=0;g<p.length;g++){const m=p[g],I=i.get(m)(c,l);if(j(I)&&(!T||T.length===0)){if(dt(I))return I;d.push([S++,I.left])}else{const b=S++;T||(T=[]),T.push(w=>Ge(()=>"finalResult"in w?C:X(xe(I),E=>(dt(E)?w.finalResult=E:w.es.push([b,E.left]),C))))}}const q=g=>ht(g)?g.length===1&&g[0][1]._tag==="Type"?k(g[0][1]):k(new P(e,c,Q(g))):k(new ke(e,c));if(T&&T.length>0){const g=T;return Ge(()=>{const m={es:Qe(d)};return X(Ze(g,I=>I(m),{concurrency:u,batching:h,discard:!0}),()=>"finalResult"in m?m.finalResult:q(m.es))})}return q(d)}}case"Suspend":{const n=er(()=>W(Ae(e.f(),e.annotations)));return(r,s)=>n()(r,s)}}},H=(e,t)=>n=>t(n)?v(n):k(new ke(e,n)),Fe=(e,t)=>{switch(e._tag){case"Declaration":{const n=Sr(e);if(ve(n))return Fe(n.value);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const s=e.propertySignatures[r],o=dn(s.type);ln(o)&&!s.isOptional&&n.push([s.name,o])}return n}case"TupleType":{const n=[];for(let r=0;r<e.elements.length;r++){const s=e.elements[r],o=dn(s.type);ln(o)&&!s.isOptional&&n.push([r,o])}return n}case"Refinement":return Fe(e.from);case"Suspend":return Fe(e.f());case"Transformation":return Fe(e.from)}return[]},ki=(e,t)=>{const n={},r=[],s=[];for(let o=0;o<e.length;o++){const i=e[o],u=Fe(i);if(u.length>0){s.push(i);for(let h=0;h<u.length;h++){const[c,l]=u[h],d=String(l.literal);n[c]=n[c]||{buckets:{},literals:[],candidates:[]};const S=n[c].buckets;if(Object.prototype.hasOwnProperty.call(S,d)){if(h<u.length-1)continue;S[d].push(i),n[c].literals.push(l),n[c].candidates.push(i)}else{S[d]=[i],n[c].literals.push(l),n[c].candidates.push(i);break}}}else r.push(i)}return{keys:n,otherwise:r,candidates:s}},tt=(e,t,n,r)=>{if((r==null?void 0:r.isEffectAllowed)===!0||j(e))return e;const s=new oo,o=Vs(e,{scheduler:s});s.flush();const i=o.unsafePoll();if(i){if(Gs(i))return v(i.value);const u=i.cause;return Qs(u)?k(u.error):k(new yn(t,n,Ys(u)))}return k(new yn(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},Ti=([e],[t])=>e>t?1:e<t?-1:0;function Q(e){return e.sort(Ti).map(t=>t[1])}const Oi=(e,t)=>{switch(e._tag){case"FinalTransformation":return e.decode;case"ComposeTransformation":return v;case"TypeLiteralTransformation":return n=>{let r=v(n);for(const s of e.propertySignatureTransformations){const[o,i]=[s.from,s.to],u=s.decode;r=ee(r,c=>{const l=u(Object.prototype.hasOwnProperty.call(c,o)?Ie(c[o]):De());return delete c[o],ve(l)&&(c[i]=l.value),c})}return r}}},F=(e,t=[])=>({value:e,forest:t}),nt={formatIssue:e=>ee(Te(e),_i),formatIssueSync:e=>{const t=nt.formatIssue(e);return j(t)?Xs(t):Ln(t)},formatError:e=>nt.formatIssue(e.issue),formatErrorSync:e=>nt.formatIssueSync(e.issue)},_i=e=>e.value+Qr(`
`,e.forest),Qr=(e,t)=>{let n="";const r=t.length;let s;for(let o=0;o<r;o++){s=t[o];const i=o===r-1;n+=e+(i?"└":"├")+"─ "+s.value,n+=Qr(e+(r>1&&!i?"│  ":"   "),s.forest)}return n},vi=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},Ni=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},Yr=e=>"ast"in e?Ie(e.ast):De(),It=v(void 0),Ai=e=>Yr(e).pipe(Bt(Ho),Ne({onNone:()=>It,onSome:t=>{const n=t(e);return de(n)?v({message:n,override:!1}):ao(n)?_t(n,r=>({message:r,override:!1})):de(n.message)?v({message:n.message,override:n.override}):_t(n.message,r=>({message:r,override:n.override}))}})),Qt=e=>t=>t._tag===e,Xr=Qt("Composite"),Sn=Qt("Refinement"),wn=Qt("Transformation"),Je=e=>ge(Ai(e),t=>t!==void 0?!t.override&&(Xr(e)||Sn(e)&&e.kind==="From"||wn(e)&&e.kind!=="Transformation")?wn(e)||Sn(e)?Je(e.issue):It:v(t.message):It),Zr=e=>Yr(e).pipe(Bt(Vo),io(t=>t(e)),Ct);function Pi(e){return br(e).pipe(fe(()=>gr(e)),fe(()=>yr(e)),fe(()=>ct(e)),Y(()=>`{ ${e.from} | filter }`))}function Ii(e){return e.message!==void 0?e.message:`Expected ${Pr(e.ast)?Pi(e.ast):String(e.ast)}, actual ${se(e.actual)}`}const $i=e=>ee(Je(e),t=>t??Zr(e)??Ii(e)),Xe=e=>Zr(e)??String(e.ast),Ri=e=>e.message??"is forbidden",Ki=e=>e.message??"is unexpected",Bi=e=>{const t=qo(e.ast);if(ve(t)){const n=t.value();return de(n)?v(n):n}return v(e.message??"is missing")},Te=e=>{switch(e._tag){case"Type":return ee($i(e),F);case"Forbidden":return v(F(Xe(e),[F(Ri(e))]));case"Unexpected":return v(F(Ki(e)));case"Missing":return ee(Bi(e),F);case"Transformation":return ge(Je(e),t=>t!==void 0?v(F(t)):ee(Te(e.issue),n=>F(Xe(e),[F(vi(e.kind),[n])])));case"Refinement":return ge(Je(e),t=>t!==void 0?v(F(t)):ee(Te(e.issue),n=>F(Xe(e),[F(Ni(e.kind),[n])])));case"Pointer":return ee(Te(e.issue),t=>F(Ro(e.path),[t]));case"Composite":return ge(Je(e),t=>{if(t!==void 0)return v(F(t));const n=Xe(e);return tr(e.issues)?ee(Ze(e.issues,Te),r=>F(n,r)):ee(Te(e.issues),r=>F(n,[r]))})}},Mi=V(e=>Ut(e[0]),(e,...t)=>{const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}),Fi=V(e=>Ut(e[0]),(e,...t)=>{const n={...e};for(const r of t)delete n[r];return n}),xn=Symbol.for("effect/Schema");function he(e){var t,n,r;return n=xn,t=xn,r=class{constructor(){a(this,n,En)}static annotations(o){return he(qe(this.ast,o))}static pipe(){return je(this,arguments)}static toString(){return String(e)}},a(r,"ast",e),a(r,"Type"),a(r,"Encoded"),a(r,"Context"),a(r,t,En),r}const En={_A:e=>e,_I:e=>e,_R:e=>e},kn={schemaId:Jo,message:nr,missingMessage:qt,identifier:rr,title:Se,description:it,examples:sr,default:or,documentation:Do,jsonSchema:ar,arbitrary:ir,pretty:cr,equivalence:lr,concurrency:ur,batching:fr,parseIssueTitle:dr,parseOptions:hr,decodingFallback:pr},Ci=e=>{if(!e)return{};const t={...e};for(const n in kn)if(n in e){const r=kn[n];t[r]=e[n],delete t[n]}return t},qe=(e,t)=>Ae(e,Ci(t)),Ui=(e,t)=>{const n=wi(e,t);return(r,s)=>qn(n(r,s),Wr)};function Ji(e){return Vt(e)?ne.make(ya(e,t=>new Pt(t))):new Pt(e[0])}function es(e,t=Ji(e)){var n;return n=class extends he(t){static annotations(s){return es(this.literals,qe(this.ast,s))}},a(n,"literals",[...e]),n}function Pe(...e){return at(e)?es(e):ts}class ts extends he(Er){}class Di extends he(kr){}class Yt extends he(ia){}class ji extends he(ua){}const Li=e=>ne.make(e.map(t=>t.ast));function ns(e,t=Li(e)){var n;return n=class extends he(t){static annotations(s){return ns(this.members,qe(this.ast,s))}},a(n,"members",[...e]),n}function Hi(...e){return Vt(e)?ns(e):at(e)?e[0]:ts}const qi=Symbol.for("effect/PropertySignature"),rs=e=>Pn(e,qi),Wi=Rr([qt]),zi=(e,t)=>{const n=_e(e),r=[];if(n.length>0){const o=[],i=[],u=[];for(let h=0;h<n.length;h++){const c=n[h],l=e[c];if(rs(l)){const d=l.ast;switch(d._tag){case"PropertySignatureDeclaration":{const S=d.type,p=d.isOptional,T=d.annotations;o.push(new M(c,S,p,!0,Wi(d))),i.push(new M(c,J(S),p,!0,T)),r.push(new M(c,S,p,!0,T));break}case"PropertySignatureTransformation":{const S=d.from.fromKey??c;o.push(new M(S,d.from.type,d.from.isOptional,!0,d.from.annotations)),i.push(new M(c,d.to.type,d.to.isOptional,!0,d.to.annotations)),u.push(new wa(S,c,d.decode,d.encode));break}}}else o.push(new M(c,l.ast,!1,!0)),i.push(new M(c,J(l.ast),!1,!0)),r.push(new M(c,l.ast,!1,!0))}if(at(u)){const h=[],c=[];for(const l of t){const{indexSignatures:d,propertySignatures:S}=fn(l.key.ast,l.value.ast);S.forEach(p=>{o.push(p),i.push(new M(p.name,J(p.type),p.isOptional,p.isReadonly,p.annotations))}),d.forEach(p=>{h.push(p),c.push(new lt(p.parameter,J(p.type),p.isReadonly))})}return new Sa(new me(o,h,{[At]:"Struct (Encoded side)"}),new me(i,c,{[At]:"Struct (Type side)"}),new xa(u))}}const s=[];for(const o of t){const{indexSignatures:i,propertySignatures:u}=fn(o.key.ast,o.value.ast);u.forEach(h=>r.push(h)),i.forEach(h=>s.push(h))}return new me(r,s)},Vi=(e,t)=>{const n=_e(e);for(const r of n){const s=e[r];if(t[r]===void 0&&rs(s)){const o=s.ast,i=o._tag==="PropertySignatureDeclaration"?o.defaultValue:o.to.defaultValue;i!==void 0&&(t[r]=i())}}return t};function Xt(e,t,n=zi(e,t)){var r;return r=class extends he(n){static annotations(o){return Xt(this.fields,this.records,qe(this.ast,o))}static pick(...o){return ye(Mi(e,...o))}static omit(...o){return ye(Fi(e,...o))}},a(r,"fields",{...e}),a(r,"records",[...t]),a(r,"make",(o,i)=>{const u=Vi(e,{...o});return Qi(i)?u:Si(r)(u)}),r}function ye(e,...t){return Xt(e,t)}function ss(e,t,n){var r;return r=class extends Xt({},[{key:e,value:t}],n){static annotations(o){return ss(e,t,qe(this.ast,o))}},a(r,"key",e),a(r,"value",t),r}const Gi=e=>ss(e.key,e.value);function Qi(e){return Rt(e)?e:(e==null?void 0:e.disableValidation)??!1}const Yi=Na();class ut extends zn()("BotStateProvider",{defaultValue:()=>Yi({name:"nameless",status:"idle",token:"",isAutoReload:!1,isReachable:!1,currentCode:"",events:[]})}){}const Xi="0.6.2",rt="@effect-ak/tg-bot-client",Tn="mjs",Be="https://cdn.jsdelivr.net/npm",Me=`${rt}@${Xi}/dist`,Zi=[{entryName:"index",packageName:rt,dts_url:`${Be}/${Me}/index.d.ts`,js_url:`${Be}/${Me}/index.${Tn}`},{entryName:"bot",packageName:rt,dts_url:`${Be}/${Me}/bot.d.ts`,js_url:`${Be}/${Me}/bot-bundle.${Tn}`},{entryName:"config-BFdBOrJI",packageName:rt,dts_url:`${Be}/${Me}/config-BFdBOrJI.d.ts`}];class os extends Jt()("TgBotEditorProvider",{scoped:Dt(function*(t){const n=yield*nn,r=yield*rn,s=yield*fo(()=>sn("/bots/empty.ts")),o=yield*ut;r.model.setValue(s),o.currentCode=s;const i=async u=>{console.log("setting code");const h=await sn(`/bots/${u}`);r.model.setValue(h),o.currentCode=s};return yield*jt(u=>(console.log("editor finalizer",u),C)),{getJsCode:r.getCode,bindEditor:n.bindEditor,changeExample:i}}),dependencies:[nn.Default.pipe(co(rn.typescript),Vn(lo(uo,{packages:Zi})))]}){}const ec=Gn("create pub sub")(function*(){const e=yield*mi();return yield*jt(()=>gi(e)),e});class We extends Jt()("PlaygroundBusProvider",{scoped:ec()}){}function as(e){return!(e.type=="new-active-tab"||e.type=="from-worker"&&e.data.newBotState)}const tc=ye({type:Pe("error-encounter"),error:Yt}),nc=ye({type:Pe("bot-code-changed"),new_code:Yt}),rc=ye({type:Pe("bot-is-connected")}),sc=ye({type:Pe("new-active-tab"),tabName:Pe("run","code")}),is=ye({type:Pe("from-worker"),data:Gi({key:Yt,value:Di}),message_id:ji});Hi(tc,nc,is,rc,sc);class cs extends Jt()("BotWorkerProvider",{scoped:Dt(function*(t){yield*ho("worker up");const n=new Worker(new URL(""+new URL("web-worker-C4B132UW.js",import.meta.url).href,import.meta.url),{type:"module"}),r=yield*ut;return yield*jt(s=>(n.terminate(),console.log("terminating worker",s),C)),n.addEventListener("message",s=>{console.log("message from worker",s.data);const o=Ui(is)(s.data);if(o._tag!="Right"||!as(o.right)){console.log("ignoring web worker event",s);return}r.events.push(o.right)}),{runBot(){n.postMessage({command:"run-bot",code:r.currentCode,token:r.token})}}}),dependencies:[We.Default]}){}const ls=f.createContext(null),oc=po(os.Default,We.Default,cs.Default).pipe(Vn(mo)),ac=go(oc),ic=async()=>{const e=await ac.runtimeEffect.pipe(Qn),t=Ye(e.context,os),n=Ye(e.context,We),r=Ye(e.context,ut);return{botWorker:Ye(e.context,cs),eventBus:n,botState:r,editor:t,subscribe(o){console.log("subscribing...");const i=Dt(function*(){const h=yield*yo(),c=yield*_(n.subscribe,Lt(bo,h)),l=yield*_(c.take,Yn(o),wo,So(h));return{subscription:c,fiber:l,close:()=>_(Eo(h,ko),xo).then(S=>console.log("cleaning up scope",S))}}),{close:u}=Ln(i);return()=>{console.log("closing scope..."),u()}}}};class cc extends To.PureComponent{constructor(t){super(t),this.$=f.createRef(),this._=f.createRef()}render(){return f.createElement("span",{ref:this.$},f.createElement("a",{...this.props,ref:this._},this.props.children))}componentDidMount(){this.paint()}getSnapshotBeforeUpdate(){return this.reset(),null}componentDidUpdate(){this.paint()}componentWillUnmount(){this.reset()}paint(){const t=this.$.current.appendChild(document.createElement("span"));Oo(async()=>{const{render:n}=await import("./buttons.esm-DK2fWHEW.js");return{render:n}},[],import.meta.url).then(({render:n})=>{this._.current!=null&&n(t.appendChild(this._.current),function(r){try{t.parentNode.replaceChild(r,t)}catch{}})})}reset(){this.$.current.replaceChild(this._.current,this.$.current.lastChild)}}function lc(){return f.createElement("footer",{className:"bg-gray-100 text-gray-700 py-4 no-print mt-20"},f.createElement("div",{className:"container mx-auto flex flex-col items-center justify-center gap-3"},f.createElement("span",null,"© 2025 Created by Aleksandr Kondaurov"),f.createElement("div",{className:"flex gap-2 justify-center"},f.createElement("a",{target:"_blank",href:"https://www.linkedin.com/in/alexander-kondaurov/",rel:"noopener noreferrer",className:"fa-brands fa-lg fa-linkedin text-blue-500"}),f.createElement("a",{target:"_blank",href:"https://github.com/effect-ak/effect-ak.github.io",rel:"noopener noreferrer",className:"fa-brands fa-lg fa-github"}))))}var Oe=class extends Jr("TgBotClientError"){},uc=e=>typeof e=="object"&&e!=null&&"file_content"in e&&e.file_content instanceof Uint8Array&&"file_name"in e&&typeof e.file_name=="string",fc=e=>typeof e=="object"&&e!=null&&"ok"in e&&typeof e.ok=="boolean",dc="https://api.telegram.org",us=class extends zn()("TgBotApiBaseUrl",{defaultValue:()=>dc}){},Zt=class extends Xn("TgBotApiToken")(){},hc=e=>{let t=Object.entries(e);if(t.length==0)return;let n=new FormData;for(let[r,s]of t)s&&(typeof s!="object"?n.append(r,`${s}`):uc(s)?n.append(r,new Blob([s.file_content]),s.file_name):n.append(r,JSON.stringify(s)));return n},$t=(e,t)=>Ht(function*(){let n=yield*st(Zt),r=yield*st(us),s=yield*vt({try:()=>fetch(`${r}/bot${n}/${Da(e)}`,{body:hc(t)??null,method:"POST"}),catch:i=>new Oe({cause:{_tag:"ClientInternalError",cause:i}})}),o=yield*vt({try:()=>s.json(),catch:()=>new Oe({cause:{_tag:"NotJsonResponse",response:s}})});return fc(o)?s.ok?o.result:yield*Nt(new Oe({cause:{_tag:"NotOkResponse",...o.error_code?{errorCode:o.error_code}:void 0,...o.description?{details:o.description}:void 0}})):yield*Nt(new Oe({cause:{_tag:"UnexpectedResponse",response:o}}))}),pc=({fileId:e,type:t})=>mc(e).pipe(_o(({content:n,file_name:r})=>new File([n],r,{...t?{type:t}:void 0}))),mc=e=>Ht(function*(){let t=(yield*$t("get_file",{file_id:e})).file_path;if(!t||t.length==0)return yield*Nt(new Oe({cause:{_tag:"UnableToGetFile",cause:"File path not defined"}}));let n=t.replaceAll("/","-"),r=yield*st(us),s=yield*st(Zt),o=`${r}/file/bot${s}/${t}`;return{content:yield*vt({try:()=>fetch(o).then(i=>i.arrayBuffer()),catch:i=>new Oe({cause:{_tag:"UnableToGetFile",cause:i}})}),file_name:n}});(class extends Xn("ClientFileService")(){});Ht(function*(){return{getFile:pc}});const gc=Gn("setup bot token")(function*(e){console.log("setup bot token");const t=yield*ut,n=yield*We,r=yield*_(Ao({me:$t("get_me",{}),webhook:$t("get_webhook_info",{})},{concurrency:"unbounded"}),Wn(s=>n.offer({type:"error-encounter",error:s.toString()}).pipe(Yn(C))),vo(No("1 second")));return r?r.webhook.url?(n.unsafeOffer({type:"error-encounter",error:"Cannot work with webhooks, delete it first"}),!1):(t.name=r.me.username??r.me.first_name,t.isReachable=!0,t.token=e,n.unsafeOffer({type:"bot-is-connected"}),!0):!1},(e,t)=>e.pipe(Lt(Zt,t)));function yc(){const e=ze(),[t,n]=f.useState(e.botState);return{botState:t,setToken:async r=>{const s=await gc(r).pipe(Lt(We,e.eventBus),Qn);n({...e.botState}),s&&e.botWorker.runBot()}}}function ze(){const e=f.useContext(ls);if(!e)throw Error("Playground context is undefined");return e}function bc(e){return f.createElement("button",{type:"button",className:"px-3 py-1 border rounded hover:bg-gray-200 active:bg-gray-300",onClick:()=>e.click()},f.createElement("i",{className:`fas fa-${e.icon}`}))}function Sc(){const{setToken:e,botState:t}=yc(),[n,r]=f.useState(!1);if(t.token&&t.name){const o=`tg://resolve?domain=${t.name}`;return f.createElement(f.Fragment,null,f.createElement("span",{className:"text-green-700"},"Connected:"),f.createElement("a",{className:"hover:text-blue-700",href:o},"@",t.name))}const s=async()=>{const o=prompt("Enter your Telegram bot token (from BotFather) to connect the bot");o&&(r(!0),await e(o),r(!1))};return f.createElement("div",{className:"flex gap-2"},!n&&f.createElement("span",{className:"text-lg text-red-600"},"Not connected"),n&&f.createElement("span",{className:"text-lg"},"Connecting... ",f.createElement("i",{className:"fas fa-cog fa-spin"})),!n&&f.createElement(bc,{icon:"plug",click:s}))}function wc(){const e=ze(),[t,n]=f.useState(e.botState.events);return f.useEffect(()=>{e.editor.getJsCode().then(s=>{e.botState.currentCode=s,e.botState.isReachable&&e.botWorker.runBot()});const r=e.subscribe(s=>{as(s)&&(n(o=>[...o,s]),e.botState.events.push(s))});return()=>{console.log("leaving run tab"),r()}},[e]),f.createElement("div",{id:"run",className:"flex flex-col h-full"},f.createElement("div",{className:"flex mb-2 text-sm gap-2"},f.createElement(Sc,null)),f.createElement("div",{className:"flex flex-1 flex-col items-start justify-start overflow-y-auto hide-scrollbar border border-gray-400 bg-indigo-50"},t.map((r,s)=>f.createElement("div",{key:s,className:"w-full px-4 py-2 text-sm whitespace-pre-wrap text-black border-b-black border-b border-dotted"},JSON.stringify(r)))))}function xc(){const e=ze();return f.useEffect(()=>{const t=e.editor.bindEditor();return t==null||t.layout({height:500,width:10}),()=>{t==null||t.dispose()}},[e]),f.createElement("div",{id:"code-editor",className:"border border-gray-400"})}function Ec(){const{eventBus:e}=ze(),[t,n]=f.useState("code"),r=["code","run"];function s(o){n(o),e.unsafeOffer({type:"new-active-tab",tabName:o})}return f.createElement("div",{className:"flex gap-2.5 h-full"},f.createElement("div",{className:"w-20"},r.map(o=>f.createElement("button",{key:o,className:`transition block mb-2 px-4 py-2 rounded ${t===o?"bg-gray-200":"hover:bg-gray-200"}`,onClick:()=>s(o)},o))),f.createElement("div",{className:"flex flex-1 flex-col w-full h-[600px]"},t==="code"&&f.createElement(xc,null),t==="run"&&f.createElement(wc,null)))}function kc(){const[e,t]=f.useState("empty.ts"),n=ze(),r=s=>{const o=s.target.value;t(o),n.editor.changeExample(o)};return f.createElement("div",{className:"flex items-start gap-2.5 mb-4"},f.createElement("label",{className:"flex items-center gap-2"},"Select example",f.createElement("select",{className:"px-2 py-1 border border-gray-300 rounded bg-white",value:e,onChange:r},f.createElement("option",{value:"empty.ts"},"Simple Bot"),f.createElement("option",{value:"command.ts"},"Command Bot"),f.createElement("option",{value:"file.ts"},"File Bot"))))}function Tc(){return f.createElement(cc,{href:"https://github.com/effect-ak/tg-bot-client","data-color-scheme":"no-preference: light; light: light; dark: dark;","data-icon":"octicon-star","data-size":"large","data-show-count":"true","aria-label":"Star effect-ak/tg-bot-client on GitHub"},"Star")}function Oc(){return f.createElement(f.Fragment,null,f.createElement("div",{className:"flex mb-6 gap-2"},f.createElement("span",{className:"text-xl font-bold text-start text-gray-800"},"Build and test Telegram bots in your browser"),f.createElement(Tc,null)),f.createElement(kc,null),f.createElement(Ec,null),f.createElement(lc,null))}function _c(e){const t=document.getElementById("playground");if(!t){console.warn("root div container");return}Po.createRoot(t).render(f.createElement(f.StrictMode,null,f.createElement(ls,{value:e},f.createElement(Oc,null))))}async function vc(){const e=await ic();_c(e)}vc();
